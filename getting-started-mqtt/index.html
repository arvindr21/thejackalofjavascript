<!DOCTYPE html>
<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="alexaVerifyID" content="tHZTfJpU56tqERN4vjth74jHqBM"/>
<link rel="profile" href="http://gmpg.org/xfn/11">
<link rel="pingback" href="/xmlrpc.php">
<!-- <link href='http://fonts.googleapis.com/css?family=Exo+2' rel='stylesheet' type='text/css'> -->
<link rel="shortcut icon" href="/wp-content/uploads/2014/02/favicon.ico" type="image/x-icon">
<meta name="keywords" content="Javascript, HTML5, CSS3, ES6, Ecmascript, Hybrid Apps, Mobile Web Development, Desktop Apps, Apps, Arvind R, Arvind Ravulavaru, The Jackal of Javascript">
<link rel="icon" href="/wp-content/uploads/2014/02/favicon.ico" type="image/x-icon">
<!-- <link href='http://fonts.googleapis.com/css?family=Open+Sans:400italic,400,600' rel='stylesheet' type='text/css'> -->
<link rel="stylesheet" type="text/css" href="/wp-content/cache/wpfc-minified/61cc3c87f2aa625d55d3026ecc452e96/1511014149index.css" media="all"/>
<!-- Performance scores of this site is tuned by WP Performance Score Booster plugin v1.5 - http://wordpress.org/plugins/wp-performance-score-booster -->
<!-- Jetpack Site Verification Tags -->
<meta name="google-site-verification" content="1QBi99oBZzn4xisTyRUgPd4BXjQ-6Tu09iK6V_bviIY" />
<meta name="msvalidate.01" content="33E048D3C4E943B6450230EA909E12C6" />
<meta name="p:domain_verify" content="662a829c1b5ccc13015f1cc5d00ec7e4" />
<!-- This site is optimized with the Yoast SEO plugin v3.1 - https://yoast.com/wordpress/plugins/seo/ -->
<title>Getting started with MQTT | The Jackal of Javascript</title>
<meta name="description" content="In this post, we will take a look at a communication protocol named Message Queue Telemetry Transport or MQTT. MQTT is a lightweight, secure, battery friend"/>
<meta name="robots" content="noodp"/>
<link rel="canonical" href="/getting-started-mqtt/" />
<link rel="publisher" href="https://plus.google.com/ArvindRavulavaru"/>
<meta property="og:locale" content="en_US" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Getting started with MQTT | The Jackal of Javascript" />
<meta property="og:description" content="In this post, we will take a look at a communication protocol named Message Queue Telemetry Transport or MQTT. MQTT is a lightweight, secure, battery friend" />
<meta property="og:url" content="/getting-started-mqtt/" />
<meta property="og:site_name" content="The Jackal of Javascript" />
<meta property="article:publisher" content="https://www.facebook.com/arvindravulavaru" />
<meta property="article:section" content="Javascript" />
<meta property="article:published_time" content="2014-10-22T20:14:53+05:30" />
<meta property="article:modified_time" content="2014-10-23T15:37:41+05:30" />
<meta property="og:updated_time" content="2014-10-23T15:37:41+05:30" />
<meta property="og:image" content="/wp-content/uploads/2014/10/mqtt_arch-451x270.png" />
<meta property="og:image" content="/wp-content/uploads/2014/10/Screen-Shot-2014-10-22-at-7.54.29-pm-451x125.png" />
<meta property="og:image" content="/wp-content/uploads/2014/10/Screen-Shot-2014-10-22-at-7.55.07-pm-451x50.png" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:description" content="In this post, we will take a look at a communication protocol named Message Queue Telemetry Transport or MQTT. MQTT is a lightweight, secure, battery friend" />
<meta name="twitter:title" content="Getting started with MQTT | The Jackal of Javascript" />
<meta name="twitter:site" content="@arvindr21" />
<meta name="twitter:image" content="/wp-content/uploads/2014/10/mqtt_arch-451x270.png" />
<meta name="twitter:creator" content="@arvindr21" />
<!-- / Yoast SEO plugin. -->
<script type="text/javascript">
window._wpemojiSettings = {"baseUrl":"http:\/\/s.w.org\/images\/core\/emoji\/72x72\/","ext":".png","source":{"concatemoji":"\/wp-includes\/js\/wp-emoji-release.min.js"}};
!function(a,b,c){function d(a){var c=b.createElement("canvas"),d=c.getContext&&c.getContext("2d");return d&&d.fillText?(d.textBaseline="top",d.font="600 32px Arial","flag"===a?(d.fillText(String.fromCharCode(55356,56812,55356,56807),0,0),c.toDataURL().length>3e3):(d.fillText(String.fromCharCode(55357,56835),0,0),0!==d.getImageData(16,16,1,1).data[0])):!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g;c.supports={simple:d("simple"),flag:d("flag")},c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.simple&&c.supports.flag||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
</script>
<style type="text/css">
img.wp-smiley,
img.emoji {
display: inline !important;
border: none !important;
box-shadow: none !important;
height: 1em !important;
width: 1em !important;
margin: 0 .07em !important;
vertical-align: -0.1em !important;
background: none !important;
padding: 0 !important;
}
</style>
<!-- <link rel='stylesheet' id='savrix-style.css-css'  href='/wp-content/plugins/savrix-android-market/savrix-style-only-play.css' type='text/css' media='all' /> -->
<!-- <link rel='stylesheet' id='validate-engine-css-css'  href='/wp-content/plugins/wysija-newsletters/css/validationEngine.jquery.css' type='text/css' media='all' /> -->
<!-- <link rel='stylesheet' id='crayon-css'  href='/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css' type='text/css' media='all' /> -->
<!-- <link rel='stylesheet' id='crayon-theme-arduino-ide-css'  href='/wp-content/plugins/crayon-syntax-highlighter/themes/arduino-ide/arduino-ide.css' type='text/css' media='all' /> -->
<!-- <link rel='stylesheet' id='crayon-font-droid-sans-mono-css'  href='/wp-content/plugins/crayon-syntax-highlighter/fonts/droid-sans-mono.css' type='text/css' media='all' /> -->
<!-- <link rel='stylesheet' id='orgseries-default-css-css'  href='/wp-content/plugins/organize-series/orgSeries.css' type='text/css' media='all' /> -->
<!-- <link rel='stylesheet' id='responsive-lightbox-prettyphoto-css'  href='/wp-content/plugins/responsive-lightbox/assets/prettyphoto/css/prettyPhoto.css' type='text/css' media='all' /> -->
<link rel="stylesheet" type="text/css" href="/wp-content/cache/wpfc-minified/9f9f3b5f286a1b327e6bb0fdb1185c24/1511014149index.css" media="all"/>
<link rel='stylesheet' id='font-awesome-css'  href='//netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.css' type='text/css' media='screen' />
<!-- <link rel='stylesheet' id='ssbaFont-css'  href='//fonts.googleapis.com/css?family=Indie+Flower&#038;ver=4.2.16' type='text/css' media='all' /> -->
<!-- <link rel='stylesheet' id='wpfront-notification-bar-css'  href='/wp-content/plugins/wpfront-notification-bar/css/wpfront-notification-bar.css' type='text/css' media='all' /> -->
<!-- <link rel='stylesheet' id='sorbet-style-css'  href='/wp-content/themes/sorbet/style.css' type='text/css' media='all' /> -->
<!-- <link rel='stylesheet' id='sorbet-source-sans-pro-css'  href='http://fonts.googleapis.com/css?family=Source+Sans+Pro%3A300%2C400%2C700%2C300italic%2C400italic%2C700italic&#038;subset=latin%2Clatin-ext&#038;ver=4.2.16' type='text/css' media='all' /> -->
<!-- <link rel='stylesheet' id='sorbet-pt-serif-css'  href='http://fonts.googleapis.com/css?family=PT+Serif%3A400%2C700%2C400italic%2C700italic&#038;subset=latin%2Clatin-ext&#038;ver=4.2.16' type='text/css' media='all' /> -->
<!-- <link rel='stylesheet' id='sorbet-genericons-css'  href='/wp-content/themes/sorbet/genericons/genericons.css' type='text/css' media='all' /> -->
<!-- <link rel='stylesheet' id='easy_table_style-css'  href='/wp-content/plugins/easy-table/themes/default/style.css' type='text/css' media='all' /> -->
<!-- <link rel='stylesheet' id='upprev-css-css'  href='/wp-content/plugins/upprev/styles/upprev.css' type='text/css' media='all' /> -->
<!-- <link rel='stylesheet' id='jetpack_css-css'  href='/wp-content/plugins/jetpack/css/jetpack.css' type='text/css' media='all' /> -->
<link rel="stylesheet" type="text/css" href="/wp-content/cache/wpfc-minified/3af13bcd925b3eaa358c8ad5070bb07b/1511014148index.css" media="all"/>
<!-- This site uses the Google Analytics by Yoast plugin v5.4.6 - Universal enabled - https://yoast.com/wordpress/plugins/google-analytics/ -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','__gaTracker');
__gaTracker('create', 'UA-47881846-1', 'auto');
__gaTracker('set', 'forceSSL', true);
__gaTracker('require', 'displayfeatures');
__gaTracker('send','pageview');
</script>
<!-- / Google Analytics by Yoast -->
<script type="text/javascript">
var iworks_upprev = { animation: 'flyout', position: 'right', offset_percent: 75, offset_element: '#comments', css_width: 360, css_side: 5, compare: 'simple', url_new_window: 0, ga_track_views: 1, ga_track_clicks: 1, ga_opt_noninteraction: 1, title: 'Getting started with MQTT' };
</script>
<script src='/wp-content/cache/wpfc-minified/1f21a7a8ca343ebb57ffeb4ab24afbd9/1511014152index.js' type="text/javascript"></script>
<!-- <script type='text/javascript' src='/wp-includes/js/jquery/jquery.js'></script> -->
<!-- <script type='text/javascript' src='/wp-includes/js/jquery/jquery-migrate.min.js'></script> -->
<!-- <script type='text/javascript' src='/wp-content/plugins/jetpack/modules/related-posts/related-posts.js'></script> -->
<script type='text/javascript'>
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script src='/wp-content/cache/wpfc-minified/052c748258385b6c23fc6642e73a4285/1511014152index.js' type="text/javascript"></script>
<!-- <script type='text/javascript' src='/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js'></script> -->
<!-- <script type='text/javascript' src='/wp-content/plugins/responsive-lightbox/assets/prettyphoto/js/jquery.prettyPhoto.js'></script> -->
<script type='text/javascript'>
/* <![CDATA[ */
var rlArgs = {"script":"prettyphoto","selector":"lightbox","customEvents":"","activeGalleries":"1","animationSpeed":"normal","slideshow":"0","slideshowDelay":"5000","slideshowAutoplay":"0","opacity":"0.75","showTitle":"1","allowResize":"1","allowExpand":"1","width":"1080","height":"720","separator":"\/","theme":"pp_default","horizontalPadding":"20","hideFlash":"0","wmode":"opaque","videoAutoplay":"0","modal":"0","deeplinking":"0","overlayGallery":"1","keyboardShortcuts":"1","social":"0"};
/* ]]> */
</script>
<script src='/wp-content/cache/wpfc-minified/d57c91500961bea5aea0e849cf08f7e7/1511014151index.js' type="text/javascript"></script>
<!-- <script type='text/javascript' src='/wp-content/plugins/responsive-lightbox/js/front.js'></script> -->
<!-- <script type='text/javascript' src='/wp-content/plugins/wpfront-notification-bar/jquery-plugins/jquery.c.js'></script> -->
<!-- <script type='text/javascript' src='/wp-content/plugins/wpfront-notification-bar/js/wpfront-notification-bar.js'></script> -->
<!-- <script type='text/javascript' src='/wp-content/plugins/upprev/scripts/upprev.js'></script> -->
<script type='text/javascript' src='//cdnjs.cloudflare.com/ajax/libs/jquery-easing/1.3/jquery.easing.min.js'></script>
<meta name="generator" content="WordPress 4.2.16" />
<style>
.scroll-back-to-top-wrapper {
position: fixed;
opacity: 0;
visibility: hidden;
overflow: hidden;
text-align: center;
z-index: 99999999;
background-color: #777777;
color: #eeeeee;
width: 50px;
height: 48px;
line-height: 48px;
right: 30px;
bottom: 30px;
padding-top: 2px;
border-top-left-radius: 10px;
border-top-right-radius: 10px;
border-bottom-right-radius: 10px;
border-bottom-left-radius: 10px;
-webkit-transition: all 0.5s ease-in-out;
-moz-transition: all 0.5s ease-in-out;
-ms-transition: all 0.5s ease-in-out;
-o-transition: all 0.5s ease-in-out;
transition: all 0.5s ease-in-out;
}
.scroll-back-to-top-wrapper:hover {
background-color: #888888;
color: #eeeeee;
}
.scroll-back-to-top-wrapper.show {
visibility:visible;
cursor:pointer;
opacity: 1.0;
}
.scroll-back-to-top-wrapper i.fa {
line-height: inherit;
}
.scroll-back-to-top-wrapper .fa-lg {
vertical-align: 0;
}
</style><style type="text/css">	.ssba {
}
.ssba img
{
width: 35px !important;
padding: 6px;
border:  0;
box-shadow: none !important;
display: inline !important;
vertical-align: middle;
}
.ssba, .ssba a
{
text-decoration:none;
border:0;
background: none;
font-family: Indie Flower;
font-size: 	20px;
}.ssba_sharecount:after, .ssba_sharecount:before {
right: 100%;
border: solid transparent;
content: " ";
height: 0;
width: 0;
position: absolute;
pointer-events: none;
}
.ssba_sharecount:after {
border-color: rgba(224, 221, 221, 0);
border-right-color: #f5f5f5;
border-width: 5px;
top: 50%;
margin-top: -5px;
}
.ssba_sharecount:before {
border-color: rgba(85, 94, 88, 0);
border-right-color: #e0dddd;
border-width: 6px;
top: 50%;
margin-top: -6px;
}
.ssba_sharecount {
font: 11px Arial, Helvetica, sans-serif;
padding: 5px;
-khtml-border-radius: 6px;
-o-border-radius: 6px;
-webkit-border-radius: 6px;
-moz-border-radius: 6px;
border-radius: 6px;
position: relative;
border: 1px solid #e0dddd;color: #555e58;
background: #ffffff;
}
.ssba_sharecount:after {
border-right-color: #ffffff;
}</style><style id="popup-maker-themes"  type="text/css">/* Popup Theme 2995: Default Theme */
.popmake-overlay.theme-2995, .popmake-overlay.theme-default-theme { background-color: rgba( 255, 255, 255, 1 ) } 
.popmake.theme-2995, .popmake.theme-default-theme { padding: 18px; border-radius: 0px; border: 1px none #000000; box-shadow: 1px 1px 3px 0px rgba( 2, 2, 2, 0.23 ); background-color: rgba( 249, 249, 249, 1 ) } 
.popmake.theme-2995 .popmake-title, .popmake.theme-default-theme .popmake-title { color: #000000; text-align: left; text-shadow: 0px 0px 0px rgba( 2, 2, 2, 0.23 ); font-family: inherit; font-weight: inherit; font-size: 32px; font-style: normal; line-height: 36px } 
.popmake.theme-2995 .popmake-content, .popmake.theme-default-theme .popmake-content { color: #8c8c8c; font-family: inherit; font-weight: inherit; font-style: normal } 
.popmake.theme-2995 > .popmake-close, .popmake.theme-default-theme > .popmake-close { height: 20px; width: 20px; left: auto; right: 0px; bottom: auto; top: 0px; padding: 8px; color: #ffffff; font-family: inherit; font-weight: inherit; font-size: 12px; font-style: normal; line-height: 14px; border: 1px none #ffffff; border-radius: 0px; box-shadow: 0px 0px 0px 0px rgba( 2, 2, 2, 0.23 ); text-shadow: 0px 0px 0px rgba( 0, 0, 0, 0.23 ); background-color: rgba( 0, 183, 205, 1 ) } 
</style>
<link rel='dns-prefetch' href='//i0.wp.com'>
<link rel='dns-prefetch' href='//i1.wp.com'>
<link rel='dns-prefetch' href='//i2.wp.com'>
<link rel='dns-prefetch' href='//widgets.wp.com'>
<link rel='dns-prefetch' href='//s0.wp.com'>
<link rel='dns-prefetch' href='//0.gravatar.com'>
<link rel='dns-prefetch' href='//1.gravatar.com'>
<link rel='dns-prefetch' href='//2.gravatar.com'>
<style type="text/css">
#upprev_box{bottom:5px;width:360px;right:5px;display:block;right:-415px;display:block;}
</style>
</head>
<body class="single single-post postid-2330 single-format-standard right-sidebar">
<div id="page" class="hfeed site">
<header id="masthead" class="site-header" role="banner">
<div class="site-header-wrapper">
<div class="site-branding">
<h1 class="site-title"><a href="/" rel="home">The Jackal of Javascript</a></h1>
<h2 class="site-description">Knowing is different &amp; Doing is different</h2>
</div>
<div class="toggles">
<div id="menu-toggle" class="toggle active" title="Menu"><span class="screen-reader-text">Menu</span></div>
<div id="search-toggle" class="toggle" title="Search"><span class="screen-reader-text">Search</span></div>
</div>
</div>
</header><!-- #masthead -->
<div id="menu-toggle-nav" class="panel">
<nav id="site-navigation" class="main-navigation" role="navigation">
<a class="skip-link screen-reader-text" href="#content">Skip to content</a>
<div class="menu-main-container"><ul id="menu-main" class="menu"><li id="menu-item-2579" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-2579"><a href="/">Home</a></li>
<li id="menu-item-2595" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-2595"><a href="/portfolio/">About  me</a></li>
<li id="menu-item-2580" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2580"><a href="/history-of-the-web/">History of the Web</a></li>
<li id="menu-item-2726" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2726"><a href="/javascript-101/">Javascript 101</a></li>
<li id="menu-item-2581" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2581"><a href="/contact-request/">Request</a></li>
</ul></div>		</nav><!-- #site-navigation -->
</div>
<div id="search-toggle-nav" class="panel">
<div class="search-wrapper">
<form role="search" method="get" class="search-form" action="/">
<label>
<span class="screen-reader-text">Search for:</span>
<input type="search" class="search-field" placeholder="Search &hellip;" value="" name="s">
</label>
<input type="submit" class="search-submit" value="Search">
</form>
</div>
</div>
<div id="content" class="site-content">
<div id="primary" class="content-area">
<main id="main" class="site-main" role="main">
<article id="post-2330" class="post-2330 post type-post status-publish format-standard hentry category-javascript category-mqtt category-node category-setup category-tutorial">
<header class="entry-header">
<h1 class="entry-title">Getting started with MQTT</h1>	</header><!-- .entry-header -->
<div class="entry-content">
<!-- Simple Share Buttons Adder (6.1.5) simplesharebuttons.com --><div class="ssba ssba-wrap"><div style="text-align:left"><a href="http://twitter.com/share?url=/getting-started-mqtt/&amp;text=Getting+started+with+MQTT+From+The+Jackal+of+Javascript+by+%40arvindr21" onclick="__gaTracker('send', 'event', 'outbound-article', 'http://twitter.com/share?url=/getting-started-mqtt/&amp;text=Getting+started+with+MQTT+From+The+Jackal+of+Javascript+by+%40arvindr21', '');" data-site="" class="ssba_twitter_share"   target="_blank"  rel="nofollow"><img src="http://i0.wp.com/thejackalofjavascript.com/wp-content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="http://i2.wp.com/thejackalofjavascript.com/wp-content/plugins/simple-share-buttons-adder/buttons/somacro/twitter.png?w=646" title="Twitter" class="ssba ssba-img" alt="Tweet about this on Twitter" data-recalc-dims="1" /><noscript><img src="http://i2.wp.com/thejackalofjavascript.com/wp-content/plugins/simple-share-buttons-adder/buttons/somacro/twitter.png?w=646" title="Twitter" class="ssba ssba-img" alt="Tweet about this on Twitter" data-recalc-dims="1" /></noscript></a><a href="http://www.linkedin.com/shareArticle?mini=true&amp;url=/getting-started-mqtt/" onclick="__gaTracker('send', 'event', 'outbound-article', 'http://www.linkedin.com/shareArticle?mini=true&amp;url=/getting-started-mqtt/', '');" data-site="linkedin" class="ssba_linkedin_share ssba_share_link"   target="_blank"  rel="nofollow"><img src="http://i0.wp.com/thejackalofjavascript.com/wp-content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="http://i1.wp.com/thejackalofjavascript.com/wp-content/plugins/simple-share-buttons-adder/buttons/somacro/linkedin.png?w=646" title="LinkedIn" class="ssba ssba-img" alt="Share on LinkedIn" data-recalc-dims="1" /><noscript><img src="http://i1.wp.com/thejackalofjavascript.com/wp-content/plugins/simple-share-buttons-adder/buttons/somacro/linkedin.png?w=646" title="LinkedIn" class="ssba ssba-img" alt="Share on LinkedIn" data-recalc-dims="1" /></noscript></a><span class="ssba_sharecount">3</span><a href="https://plus.google.com/share?url=/getting-started-mqtt/" onclick="__gaTracker('send', 'event', 'outbound-article', 'https://plus.google.com/share?url=/getting-started-mqtt/', '');" data-site="" class="ssba_google_share"   target="_blank"  rel="nofollow"><img src="http://i0.wp.com/thejackalofjavascript.com/wp-content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="http://i2.wp.com/thejackalofjavascript.com/wp-content/plugins/simple-share-buttons-adder/buttons/somacro/google.png?w=646" title="Google+" class="ssba ssba-img" alt="Share on Google+" data-recalc-dims="1" /><noscript><img src="http://i2.wp.com/thejackalofjavascript.com/wp-content/plugins/simple-share-buttons-adder/buttons/somacro/google.png?w=646" title="Google+" class="ssba ssba-img" alt="Share on Google+" data-recalc-dims="1" /></noscript></a><span class="ssba_sharecount">0</span><a href="http://reddit.com/submit?url=/getting-started-mqtt/&amp;title=Getting started with MQTT" onclick="__gaTracker('send', 'event', 'outbound-article', 'http://reddit.com/submit?url=/getting-started-mqtt/&amp;title=Getting started with MQTT', '');" data-site="reddit" class="ssba_reddit_share"   target="_blank"  rel="nofollow"><img src="http://i0.wp.com/thejackalofjavascript.com/wp-content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="http://i0.wp.com/thejackalofjavascript.com/wp-content/plugins/simple-share-buttons-adder/buttons/somacro/reddit.png?w=646" title="Reddit" class="ssba ssba-img" alt="Share on Reddit" data-recalc-dims="1" /><noscript><img src="http://i0.wp.com/thejackalofjavascript.com/wp-content/plugins/simple-share-buttons-adder/buttons/somacro/reddit.png?w=646" title="Reddit" class="ssba ssba-img" alt="Share on Reddit" data-recalc-dims="1" /></noscript></a><span class="ssba_sharecount">0</span><a href="https://bufferapp.com/add?url=/getting-started-mqtt/&amp;text=From The Jackal of Javascript Getting started with MQTT" onclick="__gaTracker('send', 'event', 'outbound-article', 'https://bufferapp.com/add?url=/getting-started-mqtt/&amp;text=From The Jackal of Javascript Getting started with MQTT', '');" data-site="buffer" class="ssba_buffer_share"   target="_blank"  rel="nofollow"><img src="http://i0.wp.com/thejackalofjavascript.com/wp-content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="http://i1.wp.com/thejackalofjavascript.com/wp-content/plugins/simple-share-buttons-adder/buttons/somacro/buffer.png?w=646" title="Buffer" class="ssba ssba-img" alt="Buffer this page" data-recalc-dims="1" /><noscript><img src="http://i1.wp.com/thejackalofjavascript.com/wp-content/plugins/simple-share-buttons-adder/buttons/somacro/buffer.png?w=646" title="Buffer" class="ssba ssba-img" alt="Buffer this page" data-recalc-dims="1" /></noscript></a><a href="https://flattr.com/submit/auto?user_id=arvindr21&amp;title=Getting started with MQTT&amp;url=https://flattr.com/profile/arvindr21" onclick="__gaTracker('send', 'event', 'outbound-article', 'https://flattr.com/submit/auto?user_id=arvindr21&amp;title=Getting started with MQTT&amp;url=https://flattr.com/profile/arvindr21', '');" data-site="flattr" class="ssba_flattr_share"   target="_blank"  rel="nofollow"><img src="http://i0.wp.com/thejackalofjavascript.com/wp-content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="http://i0.wp.com/thejackalofjavascript.com/wp-content/plugins/simple-share-buttons-adder/buttons/somacro/flattr.png?w=646" title="Flattr" class="ssba ssba-img" alt="Flattr the author" data-recalc-dims="1" /><noscript><img src="http://i0.wp.com/thejackalofjavascript.com/wp-content/plugins/simple-share-buttons-adder/buttons/somacro/flattr.png?w=646" title="Flattr" class="ssba ssba-img" alt="Flattr the author" data-recalc-dims="1" /></noscript></a><a data-site="email" class="ssba_email_share" href="/cdn-cgi/l/email-protection#ccf3bfb9aea6a9afb8f18ba9b8b8a5a2abecbfb8adbeb8a9a8ecbba5b8a4ec819d9898eaada1bcf7aea3a8b5f18abea3a1ec98a4a9ec86adafa7ada0eca3aaec86adbaadbfafbea5bcb8e9fefca4b8b8bcf6e3e3b8a4a9a6adafa7ada0a3aaa6adbaadbfafbea5bcb8e2afa3a1e3aba9b8b8a5a2abe1bfb8adbeb8a9a8e1a1bdb8b8e3"><img src="http://i0.wp.com/thejackalofjavascript.com/wp-content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="http://i0.wp.com/thejackalofjavascript.com/wp-content/plugins/simple-share-buttons-adder/buttons/somacro/email.png?w=646" title="Email" class="ssba ssba-img" alt="Email this to someone" data-recalc-dims="1" /><noscript><img src="http://i0.wp.com/thejackalofjavascript.com/wp-content/plugins/simple-share-buttons-adder/buttons/somacro/email.png?w=646" title="Email" class="ssba ssba-img" alt="Email this to someone" data-recalc-dims="1" /></noscript></a><a data-site="print" class="ssba_print ssba_share_link" href="#" onclick="window.print()"><img src="http://i0.wp.com/thejackalofjavascript.com/wp-content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="http://i0.wp.com/thejackalofjavascript.com/wp-content/plugins/simple-share-buttons-adder/buttons/somacro/print.png?w=646" title="Print" class="ssba ssba-img" alt="Print this page" data-recalc-dims="1" /><noscript><img src="http://i0.wp.com/thejackalofjavascript.com/wp-content/plugins/simple-share-buttons-adder/buttons/somacro/print.png?w=646" title="Print" class="ssba ssba-img" alt="Print this page" data-recalc-dims="1" /></noscript></a></div></div><p>In this post, we will take a look at a communication protocol named Message Queue Telemetry Transport a.k.a. MQTT. MQTT is a lightweight, secure, battery friendly and a machine-to-machine (M2M)/&#8221;Internet of Things&#8221; connectivity protocol.</p>
<p>Andy Stanford-Clark and Arlen Nipper from Cirrus Link Solutions authored the first version of the protocol in 1999.</p>
<h2>What is MQTT?</h2>
<blockquote><p><b>MQTT</b> (formerly Message Queue Telemetry Transport) is a publish-subscribe based &#8220;light weight&#8221; messaging protocol for use on top of the TCP/IP protocol. It is designed for connections with remote locations where a &#8220;small code footprint&#8221; is required and/or network bandwidth is limited. The Publish-Subscribe messaging pattern requires a message broker. The broker is responsible for distributing messages to interested clients based on the topic of a message.</p>
<p>The specification does not specify the meaning of &#8220;small code foot print&#8221; or the meaning of &#8220;limited network bandwidth&#8221;. Thus, the protocol&#8217;s availability for use depends on the context. In 2013 IBM submitted MQTT v3.1 to the OASIS specification body with a charter that ensured only minor changes to the specification could be accepted. MQTT-SN is a variation of the main protocol aimed at embedded devices on non-TCP/IP networks, such as ZigBee.</p>
<p>Historically, the &#8216;MQ&#8217; in &#8216;MQTT&#8217; came from IBM&#8217;s MQ message queuing product line. However, queuing per se is not required to be supported as a standard feature in all situations.</p></blockquote>
<h4>Real world applications</h4>
<blockquote><p>Facebook Messenger : Facebook has used aspects of MQTT in Facebook Messenger. However, it is unclear how much of MQTT is used or for what; Moreover it is to be noted that this is a phone application not a sensor application.</p></blockquote>
<p><span id="more-2330"></span></p>
<h2>Understanding OSI Model</h2>
<p>To gain a better understanding of where MQTT fits, you need to have an understanding of the OSI model. If you already know about it, you can skip the below video.</p>
<p style="text-align: center;">
<!-- iframe plugin v.4.2 wordpress.org/plugins/iframe/ -->
<iframe width="640" height="360" src="//www.youtube.com/embed/sVDwG2RdJho?rel=0" frameborder="0" 0="allowfullscreen" scrolling="yes" class="iframe-class"></iframe>
</p>
<p>MQTT is in the same layer as HTTP, Layer 7.</p>
<h2>Why MQTT?</h2>
<ol>
<li>It is a publish/subscribe protocol</li>
<li>It has Multiple Quality of Service levels (QOS)</li>
<li>It has at-least-once and exactly-once semantics</li>
<li>It has a low overhead (2 bytes at minimum)</li>
<li>It supports offline messaging</li>
<li>It retains messages, like a key/value store</li>
</ol>
<p class="p1"><a href="https://github.com/mcollina" onclick="__gaTracker('send', 'event', 'outbound-article', 'https://github.com/mcollina', 'Matteo Collina');" title="Matteo Collina"  target="_blank">Matteo Collina</a>, the author of <a href="http://www.mosca.io/" onclick="__gaTracker('send', 'event', 'outbound-article', 'http://www.mosca.io/', 'Mosca');" title="Mosca"  target="_blank">Mosca</a>, gave a nice talk on what MQTT is and how it works well with Node.</p>
<p style="text-align: center;">
<!-- iframe plugin v.4.2 wordpress.org/plugins/iframe/ -->
<iframe width="640" height="360" src="//www.youtube.com/embed/WE7GVIFRV7Q?rel=0" frameborder="0" 0="allowfullscreen" scrolling="yes" class="iframe-class"></iframe>
</p>
<p>You can find a copy of his presentation on MQTT and Node.js <a href="http://mcollina.github.io/mqtt_and_nodejs" onclick="__gaTracker('send', 'event', 'outbound-article', 'http://mcollina.github.io/mqtt_and_nodejs', 'here');" title="Mqtt and Node.js"  target="_blank">here</a>.</p>
<h2>Where will MQTT fit in?</h2>
<p>Imagine the below environment</p>
<p><a href="http://i2.wp.com/thejackalofjavascript.com/wp-content/uploads/2014/10/mqtt_arch.png" data-rel="lightbox-0" title=""><img class="size-medium wp-image-2344 aligncenter" src="http://i0.wp.com/thejackalofjavascript.com/wp-content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="http://i2.wp.com/thejackalofjavascript.com/wp-content/uploads/2014/10/mqtt_arch.png?resize=451%2C270" alt="mqtt_arch" data-recalc-dims="1" /><noscript><img class="size-medium wp-image-2344 aligncenter" src="http://i2.wp.com/thejackalofjavascript.com/wp-content/uploads/2014/10/mqtt_arch.png?resize=451%2C270" alt="mqtt_arch" data-recalc-dims="1" /></noscript></a></p>
<p>where the status/sensor readings of a single machine/device needs to be transmitted to another machine/device, and a real time dashboard and a tablet or a wearable. Hooking up and maintaining data across so many devices may be tricky. This is where MQTT fits in well.</p>
<h2>Hands on</h2>
<p>Now that we have a fair understanding of MQTT, we will try out a simple example. We will be implementing a server/broker which will take in data and distribute it to all its clients using <a href="http://www.mosca.io/" onclick="__gaTracker('send', 'event', 'outbound-article', 'http://www.mosca.io', 'Mosca');" title="Mosca"  target="_blank">Mosca</a>. And then we will implement a MQTT client using <a href="https://github.com/adamvr/MQTT.js" onclick="__gaTracker('send', 'event', 'download', 'https://github.com/adamvr/MQTT.js');" title="mqtt.js"  target="_blank">MQTT.js</a> that publishes and subscribes to topics via the broker.</p>
<p>Create a new folder named <em>mqttApp</em>. We will create 2 new folders inside it named <em>server</em> and <em>client.</em></p>
<p>Open a new terminal/prompt inside the <em>server</em> folder. Create a new Node.js project by running</p>
<p style="text-align: center;">
<span id="crayon-5a10fd4ff332e431142476" class="crayon-syntax crayon-syntax-inline  crayon-theme-arduino-ide crayon-theme-arduino-ide-inline crayon-font-droid-sans-mono" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-e">npm </span><span class="crayon-v">init</span></span></span></p>
<p>Fill it up as applicable. Next, we will install Mosca as a dependency and save it. Run</p>
<p style="text-align: center;">
<span id="crayon-5a10fd4ff3342833324487" class="crayon-syntax crayon-syntax-inline  crayon-theme-arduino-ide crayon-theme-arduino-ide-inline crayon-font-droid-sans-mono" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-e">npm </span><span class="crayon-e">install </span><span class="crayon-v">mosca</span><span class="crayon-h"> </span><span class="crayon-o">--</span><span class="crayon-v">save</span></span></span></p>
<p>Create another file named <em>server.js </em>inside the <em>server</em> folder. Update it as below</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div id="crayon-5a10fd4ff3349302777693" class="crayon-syntax crayon-theme-arduino-ide crayon-font-droid-sans-mono crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">server/server.js</span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">JavaScript</span></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
var mosca = require('mosca')
var settings = {
port: 1883
};
//here we start mosca
var server = new mosca.Server(settings);
server.on('ready', setup);
// fired when the mqtt server is ready
function setup() {
console.log('Mosca server is up and running')
}
// fired whena  client is connected
server.on('clientConnected', function(client) {
console.log('client connected', client.id);
});
// fired when a message is received
server.on('published', function(packet, client) {
console.log('Published : ', packet.payload);
});
// fired when a client subscribes to a topic
server.on('subscribed', function(topic, client) {
console.log('subscribed : ', topic);
});
// fired when a client subscribes to a topic
server.on('unsubscribed', function(topic, client) {
console.log('unsubscribed : ', topic);
});
// fired when a client is disconnecting
server.on('clientDisconnecting', function(client) {
console.log('clientDisconnecting : ', client.id);
});
// fired when a client is disconnected
server.on('clientDisconnected', function(client) {
console.log('clientDisconnected : ', client.id);
});</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums" data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a10fd4ff3349302777693-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10fd4ff3349302777693-2">2</div><div class="crayon-num" data-line="crayon-5a10fd4ff3349302777693-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10fd4ff3349302777693-4">4</div><div class="crayon-num" data-line="crayon-5a10fd4ff3349302777693-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10fd4ff3349302777693-6">6</div><div class="crayon-num" data-line="crayon-5a10fd4ff3349302777693-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10fd4ff3349302777693-8">8</div><div class="crayon-num" data-line="crayon-5a10fd4ff3349302777693-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10fd4ff3349302777693-10">10</div><div class="crayon-num" data-line="crayon-5a10fd4ff3349302777693-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10fd4ff3349302777693-12">12</div><div class="crayon-num" data-line="crayon-5a10fd4ff3349302777693-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10fd4ff3349302777693-14">14</div><div class="crayon-num" data-line="crayon-5a10fd4ff3349302777693-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10fd4ff3349302777693-16">16</div><div class="crayon-num" data-line="crayon-5a10fd4ff3349302777693-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10fd4ff3349302777693-18">18</div><div class="crayon-num" data-line="crayon-5a10fd4ff3349302777693-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10fd4ff3349302777693-20">20</div><div class="crayon-num" data-line="crayon-5a10fd4ff3349302777693-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10fd4ff3349302777693-22">22</div><div class="crayon-num" data-line="crayon-5a10fd4ff3349302777693-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10fd4ff3349302777693-24">24</div><div class="crayon-num" data-line="crayon-5a10fd4ff3349302777693-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10fd4ff3349302777693-26">26</div><div class="crayon-num" data-line="crayon-5a10fd4ff3349302777693-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10fd4ff3349302777693-28">28</div><div class="crayon-num" data-line="crayon-5a10fd4ff3349302777693-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10fd4ff3349302777693-30">30</div><div class="crayon-num" data-line="crayon-5a10fd4ff3349302777693-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10fd4ff3349302777693-32">32</div><div class="crayon-num" data-line="crayon-5a10fd4ff3349302777693-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10fd4ff3349302777693-34">34</div><div class="crayon-num" data-line="crayon-5a10fd4ff3349302777693-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10fd4ff3349302777693-36">36</div><div class="crayon-num" data-line="crayon-5a10fd4ff3349302777693-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10fd4ff3349302777693-38">38</div><div class="crayon-num" data-line="crayon-5a10fd4ff3349302777693-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10fd4ff3349302777693-40">40</div><div class="crayon-num" data-line="crayon-5a10fd4ff3349302777693-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10fd4ff3349302777693-42">42</div><div class="crayon-num" data-line="crayon-5a10fd4ff3349302777693-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10fd4ff3349302777693-44">44</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a10fd4ff3349302777693-1"><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">mosca</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">require</span><span class="crayon-sy">(</span><span class="crayon-s">'mosca'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10fd4ff3349302777693-2">&nbsp;</div><div class="crayon-line" id="crayon-5a10fd4ff3349302777693-3"><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">settings</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10fd4ff3349302777693-4"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">port</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">1883</span></div><div class="crayon-line" id="crayon-5a10fd4ff3349302777693-5"><span class="crayon-sy">}</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10fd4ff3349302777693-6">&nbsp;</div><div class="crayon-line" id="crayon-5a10fd4ff3349302777693-7"><span class="crayon-c">//here we start mosca</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10fd4ff3349302777693-8"><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">server</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">new</span><span class="crayon-h"> </span><span class="crayon-v">mosca</span><span class="crayon-sy">.</span><span class="crayon-e">Server</span><span class="crayon-sy">(</span><span class="crayon-v">settings</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a10fd4ff3349302777693-9"><span class="crayon-v">server</span><span class="crayon-sy">.</span><span class="crayon-e">on</span><span class="crayon-sy">(</span><span class="crayon-s">'ready'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">setup</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10fd4ff3349302777693-10">&nbsp;</div><div class="crayon-line" id="crayon-5a10fd4ff3349302777693-11"><span class="crayon-c">// fired when the mqtt server is ready</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10fd4ff3349302777693-12"><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-e">setup</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a10fd4ff3349302777693-13"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">console</span><span class="crayon-sy">.</span><span class="crayon-e">log</span><span class="crayon-sy">(</span><span class="crayon-s">'Mosca server is up and running'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10fd4ff3349302777693-14"><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5a10fd4ff3349302777693-15">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a10fd4ff3349302777693-16"><span class="crayon-c">// fired whena&nbsp;&nbsp;client is connected</span></div><div class="crayon-line" id="crayon-5a10fd4ff3349302777693-17"><span class="crayon-v">server</span><span class="crayon-sy">.</span><span class="crayon-e">on</span><span class="crayon-sy">(</span><span class="crayon-s">'clientConnected'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-v">client</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10fd4ff3349302777693-18"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">console</span><span class="crayon-sy">.</span><span class="crayon-e">log</span><span class="crayon-sy">(</span><span class="crayon-s">'client connected'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">client</span><span class="crayon-sy">.</span><span class="crayon-v">id</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a10fd4ff3349302777693-19"><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10fd4ff3349302777693-20">&nbsp;</div><div class="crayon-line" id="crayon-5a10fd4ff3349302777693-21"><span class="crayon-c">// fired when a message is received</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10fd4ff3349302777693-22"><span class="crayon-v">server</span><span class="crayon-sy">.</span><span class="crayon-e">on</span><span class="crayon-sy">(</span><span class="crayon-s">'published'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-v">packet</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">client</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a10fd4ff3349302777693-23"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">console</span><span class="crayon-sy">.</span><span class="crayon-e">log</span><span class="crayon-sy">(</span><span class="crayon-s">'Published : '</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">packet</span><span class="crayon-sy">.</span><span class="crayon-v">payload</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10fd4ff3349302777693-24"><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a10fd4ff3349302777693-25">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a10fd4ff3349302777693-26"><span class="crayon-c">// fired when a client subscribes to a topic</span></div><div class="crayon-line" id="crayon-5a10fd4ff3349302777693-27"><span class="crayon-v">server</span><span class="crayon-sy">.</span><span class="crayon-e">on</span><span class="crayon-sy">(</span><span class="crayon-s">'subscribed'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-v">topic</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">client</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10fd4ff3349302777693-28"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">console</span><span class="crayon-sy">.</span><span class="crayon-e">log</span><span class="crayon-sy">(</span><span class="crayon-s">'subscribed : '</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">topic</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a10fd4ff3349302777693-29"><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10fd4ff3349302777693-30">&nbsp;</div><div class="crayon-line" id="crayon-5a10fd4ff3349302777693-31"><span class="crayon-c">// fired when a client subscribes to a topic</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10fd4ff3349302777693-32"><span class="crayon-v">server</span><span class="crayon-sy">.</span><span class="crayon-e">on</span><span class="crayon-sy">(</span><span class="crayon-s">'unsubscribed'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-v">topic</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">client</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a10fd4ff3349302777693-33"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">console</span><span class="crayon-sy">.</span><span class="crayon-e">log</span><span class="crayon-sy">(</span><span class="crayon-s">'unsubscribed : '</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">topic</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10fd4ff3349302777693-34"><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a10fd4ff3349302777693-35">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a10fd4ff3349302777693-36"><span class="crayon-c">// fired when a client is disconnecting</span></div><div class="crayon-line" id="crayon-5a10fd4ff3349302777693-37"><span class="crayon-v">server</span><span class="crayon-sy">.</span><span class="crayon-e">on</span><span class="crayon-sy">(</span><span class="crayon-s">'clientDisconnecting'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-v">client</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10fd4ff3349302777693-38"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">console</span><span class="crayon-sy">.</span><span class="crayon-e">log</span><span class="crayon-sy">(</span><span class="crayon-s">'clientDisconnecting : '</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">client</span><span class="crayon-sy">.</span><span class="crayon-v">id</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a10fd4ff3349302777693-39"><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10fd4ff3349302777693-40">&nbsp;</div><div class="crayon-line" id="crayon-5a10fd4ff3349302777693-41"><span class="crayon-c">// fired when a client is disconnected</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10fd4ff3349302777693-42"><span class="crayon-v">server</span><span class="crayon-sy">.</span><span class="crayon-e">on</span><span class="crayon-sy">(</span><span class="crayon-s">'clientDisconnected'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-v">client</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a10fd4ff3349302777693-43"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">console</span><span class="crayon-sy">.</span><span class="crayon-e">log</span><span class="crayon-sy">(</span><span class="crayon-s">'clientDisconnected : '</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">client</span><span class="crayon-sy">.</span><span class="crayon-v">id</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10fd4ff3349302777693-44"><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0095 seconds] -->
<p>A simple MQTT broker. Things to notice</p>
<p><strong>Line 1</strong> : Include Mosca</p>
<p><strong>Line 3</strong> : Configure the server</p>
<p><strong>Line 8</strong> : Start the server</p>
<p><strong>Line 12</strong> : The call back when the server is started</p>
<p><strong>Line 17</strong> : <em>clientConnected</em> : when a client is connected; the client is passed as a parameter.</p>
<p><strong>Line 22</strong> : <em>published</em> : when a new message is published; the packet and the client are passed as parameters.</p>
<p><strong>Line 27</strong> : <em>subscribed</em> : when a client is subscribed to a topic; the topic and the client are passed as parameters.</p>
<p><strong>Line 32</strong> : <em>unsubscribed</em> : when a client is unsubscribed to a topic; the topic and the client are passed as parameters.</p>
<p><strong>Line 37</strong> : <em>clientDisconnecting</em> : when a client is being disconnected; the client is passed as a parameter.</p>
<p><strong>Line 42</strong> : <em>clientDisconnected</em> : when a client is disconnected; the client is passed as a parameter.</p>
<p>Simple pub/sub API.</p>
<p>If you want to enable the offline mode, we need to store the data into one of the Key value pair storages. Out of the box Mosca supports most of the popular key value pair datastores. Below is a quick example how you can use it with MongoDB.</p>
<p>Updated <em>server.js</em>.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div id="crayon-5a10fd4ff3354251276278" class="crayon-syntax crayon-theme-arduino-ide crayon-font-droid-sans-mono crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">server/server.js</span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">JavaScript</span></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
var mosca = require('mosca')
var pubsubsettings = {
type: 'mongo',
url: 'mongodb://localhost:27017/mqtt',
pubsubCollection: 'myCollections',
mongo: {}
};
var settings = {
port: 1883,
backend: pubsubsettings
};
//here we start mosca
var server = new mosca.Server(settings);
server.on('ready', setup);
// fired when the mqtt server is ready
function setup() {
console.log('Mosca server is up and running')
}
// fired whena  client is connected
server.on('clientConnected', function(client) {
console.log('client connected', client.id);
});
// fired when a message is received
server.on('published', function(packet, client) {
console.log('Published : ', packet.payload);
});
// fired when a client subscribes to a topic
server.on('subscribed', function(topic, client) {
console.log('subscribed : ', topic);
});
// fired when a client subscribes to a topic
server.on('unsubscribed', function(topic, client) {
console.log('unsubscribed : ', topic);
});
// fired when a client is disconnecting
server.on('clientDisconnecting', function(client) {
console.log('clientDisconnecting : ', client.id);
});
// fired when a client is disconnected
server.on('clientDisconnected', function(client) {
console.log('clientDisconnected : ', client.id);
});</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums" data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a10fd4ff3354251276278-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10fd4ff3354251276278-2">2</div><div class="crayon-num" data-line="crayon-5a10fd4ff3354251276278-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10fd4ff3354251276278-4">4</div><div class="crayon-num" data-line="crayon-5a10fd4ff3354251276278-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10fd4ff3354251276278-6">6</div><div class="crayon-num" data-line="crayon-5a10fd4ff3354251276278-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10fd4ff3354251276278-8">8</div><div class="crayon-num" data-line="crayon-5a10fd4ff3354251276278-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10fd4ff3354251276278-10">10</div><div class="crayon-num" data-line="crayon-5a10fd4ff3354251276278-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10fd4ff3354251276278-12">12</div><div class="crayon-num" data-line="crayon-5a10fd4ff3354251276278-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10fd4ff3354251276278-14">14</div><div class="crayon-num" data-line="crayon-5a10fd4ff3354251276278-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10fd4ff3354251276278-16">16</div><div class="crayon-num" data-line="crayon-5a10fd4ff3354251276278-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10fd4ff3354251276278-18">18</div><div class="crayon-num" data-line="crayon-5a10fd4ff3354251276278-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10fd4ff3354251276278-20">20</div><div class="crayon-num" data-line="crayon-5a10fd4ff3354251276278-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10fd4ff3354251276278-22">22</div><div class="crayon-num" data-line="crayon-5a10fd4ff3354251276278-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10fd4ff3354251276278-24">24</div><div class="crayon-num" data-line="crayon-5a10fd4ff3354251276278-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10fd4ff3354251276278-26">26</div><div class="crayon-num" data-line="crayon-5a10fd4ff3354251276278-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10fd4ff3354251276278-28">28</div><div class="crayon-num" data-line="crayon-5a10fd4ff3354251276278-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10fd4ff3354251276278-30">30</div><div class="crayon-num" data-line="crayon-5a10fd4ff3354251276278-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10fd4ff3354251276278-32">32</div><div class="crayon-num" data-line="crayon-5a10fd4ff3354251276278-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10fd4ff3354251276278-34">34</div><div class="crayon-num" data-line="crayon-5a10fd4ff3354251276278-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10fd4ff3354251276278-36">36</div><div class="crayon-num" data-line="crayon-5a10fd4ff3354251276278-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10fd4ff3354251276278-38">38</div><div class="crayon-num" data-line="crayon-5a10fd4ff3354251276278-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10fd4ff3354251276278-40">40</div><div class="crayon-num" data-line="crayon-5a10fd4ff3354251276278-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10fd4ff3354251276278-42">42</div><div class="crayon-num" data-line="crayon-5a10fd4ff3354251276278-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10fd4ff3354251276278-44">44</div><div class="crayon-num" data-line="crayon-5a10fd4ff3354251276278-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10fd4ff3354251276278-46">46</div><div class="crayon-num" data-line="crayon-5a10fd4ff3354251276278-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10fd4ff3354251276278-48">48</div><div class="crayon-num" data-line="crayon-5a10fd4ff3354251276278-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10fd4ff3354251276278-50">50</div><div class="crayon-num" data-line="crayon-5a10fd4ff3354251276278-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10fd4ff3354251276278-52">52</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a10fd4ff3354251276278-1"><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">mosca</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">require</span><span class="crayon-sy">(</span><span class="crayon-s">'mosca'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10fd4ff3354251276278-2">&nbsp;</div><div class="crayon-line" id="crayon-5a10fd4ff3354251276278-3"><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">pubsubsettings</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10fd4ff3354251276278-4"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">type</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">'mongo'</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5a10fd4ff3354251276278-5"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">url</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">'mongodb://localhost:27017/mqtt'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10fd4ff3354251276278-6"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">pubsubCollection</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">'myCollections'</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5a10fd4ff3354251276278-7"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">mongo</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10fd4ff3354251276278-8"><span class="crayon-sy">}</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a10fd4ff3354251276278-9">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a10fd4ff3354251276278-10"><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">settings</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a10fd4ff3354251276278-11"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">port</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">1883</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10fd4ff3354251276278-12"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">backend</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">pubsubsettings</span></div><div class="crayon-line" id="crayon-5a10fd4ff3354251276278-13"><span class="crayon-sy">}</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10fd4ff3354251276278-14">&nbsp;</div><div class="crayon-line" id="crayon-5a10fd4ff3354251276278-15"><span class="crayon-c">//here we start mosca</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10fd4ff3354251276278-16"><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">server</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">new</span><span class="crayon-h"> </span><span class="crayon-v">mosca</span><span class="crayon-sy">.</span><span class="crayon-e">Server</span><span class="crayon-sy">(</span><span class="crayon-v">settings</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a10fd4ff3354251276278-17"><span class="crayon-v">server</span><span class="crayon-sy">.</span><span class="crayon-e">on</span><span class="crayon-sy">(</span><span class="crayon-s">'ready'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">setup</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10fd4ff3354251276278-18">&nbsp;</div><div class="crayon-line" id="crayon-5a10fd4ff3354251276278-19"><span class="crayon-c">// fired when the mqtt server is ready</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10fd4ff3354251276278-20"><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-e">setup</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a10fd4ff3354251276278-21"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">console</span><span class="crayon-sy">.</span><span class="crayon-e">log</span><span class="crayon-sy">(</span><span class="crayon-s">'Mosca server is up and running'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10fd4ff3354251276278-22"><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5a10fd4ff3354251276278-23">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a10fd4ff3354251276278-24"><span class="crayon-c">// fired whena&nbsp;&nbsp;client is connected</span></div><div class="crayon-line" id="crayon-5a10fd4ff3354251276278-25"><span class="crayon-v">server</span><span class="crayon-sy">.</span><span class="crayon-e">on</span><span class="crayon-sy">(</span><span class="crayon-s">'clientConnected'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-v">client</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10fd4ff3354251276278-26"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">console</span><span class="crayon-sy">.</span><span class="crayon-e">log</span><span class="crayon-sy">(</span><span class="crayon-s">'client connected'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">client</span><span class="crayon-sy">.</span><span class="crayon-v">id</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a10fd4ff3354251276278-27"><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10fd4ff3354251276278-28">&nbsp;</div><div class="crayon-line" id="crayon-5a10fd4ff3354251276278-29"><span class="crayon-c">// fired when a message is received</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10fd4ff3354251276278-30"><span class="crayon-v">server</span><span class="crayon-sy">.</span><span class="crayon-e">on</span><span class="crayon-sy">(</span><span class="crayon-s">'published'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-v">packet</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">client</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a10fd4ff3354251276278-31"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">console</span><span class="crayon-sy">.</span><span class="crayon-e">log</span><span class="crayon-sy">(</span><span class="crayon-s">'Published : '</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">packet</span><span class="crayon-sy">.</span><span class="crayon-v">payload</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10fd4ff3354251276278-32"><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a10fd4ff3354251276278-33">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a10fd4ff3354251276278-34"><span class="crayon-c">// fired when a client subscribes to a topic</span></div><div class="crayon-line" id="crayon-5a10fd4ff3354251276278-35"><span class="crayon-v">server</span><span class="crayon-sy">.</span><span class="crayon-e">on</span><span class="crayon-sy">(</span><span class="crayon-s">'subscribed'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-v">topic</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">client</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10fd4ff3354251276278-36"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">console</span><span class="crayon-sy">.</span><span class="crayon-e">log</span><span class="crayon-sy">(</span><span class="crayon-s">'subscribed : '</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">topic</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a10fd4ff3354251276278-37"><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10fd4ff3354251276278-38">&nbsp;</div><div class="crayon-line" id="crayon-5a10fd4ff3354251276278-39"><span class="crayon-c">// fired when a client subscribes to a topic</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10fd4ff3354251276278-40"><span class="crayon-v">server</span><span class="crayon-sy">.</span><span class="crayon-e">on</span><span class="crayon-sy">(</span><span class="crayon-s">'unsubscribed'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-v">topic</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">client</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a10fd4ff3354251276278-41"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">console</span><span class="crayon-sy">.</span><span class="crayon-e">log</span><span class="crayon-sy">(</span><span class="crayon-s">'unsubscribed : '</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">topic</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10fd4ff3354251276278-42"><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a10fd4ff3354251276278-43">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a10fd4ff3354251276278-44"><span class="crayon-c">// fired when a client is disconnecting</span></div><div class="crayon-line" id="crayon-5a10fd4ff3354251276278-45"><span class="crayon-v">server</span><span class="crayon-sy">.</span><span class="crayon-e">on</span><span class="crayon-sy">(</span><span class="crayon-s">'clientDisconnecting'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-v">client</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10fd4ff3354251276278-46"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">console</span><span class="crayon-sy">.</span><span class="crayon-e">log</span><span class="crayon-sy">(</span><span class="crayon-s">'clientDisconnecting : '</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">client</span><span class="crayon-sy">.</span><span class="crayon-v">id</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a10fd4ff3354251276278-47"><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10fd4ff3354251276278-48">&nbsp;</div><div class="crayon-line" id="crayon-5a10fd4ff3354251276278-49"><span class="crayon-c">// fired when a client is disconnected</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10fd4ff3354251276278-50"><span class="crayon-v">server</span><span class="crayon-sy">.</span><span class="crayon-e">on</span><span class="crayon-sy">(</span><span class="crayon-s">'clientDisconnected'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-v">client</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a10fd4ff3354251276278-51"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">console</span><span class="crayon-sy">.</span><span class="crayon-e">log</span><span class="crayon-sy">(</span><span class="crayon-s">'clientDisconnected : '</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">client</span><span class="crayon-sy">.</span><span class="crayon-v">id</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10fd4ff3354251276278-52"><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0095 seconds] -->
<p>The only thing that changed is line 3. We have added the MongoDB settings here. (<em>You can use a service like Mongo Lab to store the data on the cloud.</em>) And then we include these settings on line 12.</p>
<p>Before we start the server, we need to start the MongoDB instance. If you are new to MongoDB, take a look at <a title="MongoDB" href="/mapreduce-in-mongodb/#mongodb" target="_blank">this</a>.</p>
<p>Once MongoDB is started, we will start the server by running</p>
<p style="text-align: center;">
<span id="crayon-5a10fd4ff335f646026830" class="crayon-syntax crayon-syntax-inline  crayon-theme-arduino-ide crayon-theme-arduino-ide-inline crayon-font-droid-sans-mono" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-e">node </span><span class="crayon-v">server</span><span class="crayon-sy">.</span><span class="crayon-v">js</span></span></span></p>
<p>If MongoDB is started and running, you should see the success message. Else you will see a stack of error.</p>
<p>This is a simple broken server with offline capabilities. Before we go further, we will update our server to work as a real time broker. Update <em>server.js </em> as below</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div id="crayon-5a10fd4ff3367866948665" class="crayon-syntax crayon-theme-arduino-ide crayon-font-droid-sans-mono crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">server/server.js</span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">JavaScript</span></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
var mosca = require('mosca')
var settings = {
port: 1883,
persistence: mosca.persistence.Memory
};
var server = new mosca.Server(settings, function() {
console.log('Mosca server is up and running')
});
server.published = function(packet, client, cb) {
if (packet.topic.indexOf('echo') === 0) {
return cb();
}
var newPacket = {
topic: 'echo/' + packet.topic,
payload: packet.payload,
retain: packet.retain,
qos: packet.qos
};
console.log('newPacket', newPacket);
server.publish(newPacket, cb);
}</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums" data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a10fd4ff3367866948665-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10fd4ff3367866948665-2">2</div><div class="crayon-num" data-line="crayon-5a10fd4ff3367866948665-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10fd4ff3367866948665-4">4</div><div class="crayon-num" data-line="crayon-5a10fd4ff3367866948665-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10fd4ff3367866948665-6">6</div><div class="crayon-num" data-line="crayon-5a10fd4ff3367866948665-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10fd4ff3367866948665-8">8</div><div class="crayon-num" data-line="crayon-5a10fd4ff3367866948665-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10fd4ff3367866948665-10">10</div><div class="crayon-num" data-line="crayon-5a10fd4ff3367866948665-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10fd4ff3367866948665-12">12</div><div class="crayon-num" data-line="crayon-5a10fd4ff3367866948665-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10fd4ff3367866948665-14">14</div><div class="crayon-num" data-line="crayon-5a10fd4ff3367866948665-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10fd4ff3367866948665-16">16</div><div class="crayon-num" data-line="crayon-5a10fd4ff3367866948665-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10fd4ff3367866948665-18">18</div><div class="crayon-num" data-line="crayon-5a10fd4ff3367866948665-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10fd4ff3367866948665-20">20</div><div class="crayon-num" data-line="crayon-5a10fd4ff3367866948665-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10fd4ff3367866948665-22">22</div><div class="crayon-num" data-line="crayon-5a10fd4ff3367866948665-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10fd4ff3367866948665-24">24</div><div class="crayon-num" data-line="crayon-5a10fd4ff3367866948665-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10fd4ff3367866948665-26">26</div><div class="crayon-num" data-line="crayon-5a10fd4ff3367866948665-27">27</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a10fd4ff3367866948665-1"><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">mosca</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">require</span><span class="crayon-sy">(</span><span class="crayon-s">'mosca'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10fd4ff3367866948665-2">&nbsp;</div><div class="crayon-line" id="crayon-5a10fd4ff3367866948665-3"><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">settings</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10fd4ff3367866948665-4"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">port</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">1883</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5a10fd4ff3367866948665-5"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">persistence</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">mosca</span><span class="crayon-sy">.</span><span class="crayon-v">persistence</span><span class="crayon-sy">.</span><span class="crayon-i">Memory</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10fd4ff3367866948665-6"><span class="crayon-sy">}</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a10fd4ff3367866948665-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a10fd4ff3367866948665-8"><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">server</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">new</span><span class="crayon-h"> </span><span class="crayon-v">mosca</span><span class="crayon-sy">.</span><span class="crayon-e">Server</span><span class="crayon-sy">(</span><span class="crayon-v">settings</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a10fd4ff3367866948665-9"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">console</span><span class="crayon-sy">.</span><span class="crayon-e">log</span><span class="crayon-sy">(</span><span class="crayon-s">'Mosca server is up and running'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10fd4ff3367866948665-10"><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a10fd4ff3367866948665-11">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a10fd4ff3367866948665-12"><span class="crayon-v">server</span><span class="crayon-sy">.</span><span class="crayon-v">published</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-v">packet</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">client</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cb</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a10fd4ff3367866948665-13"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">packet</span><span class="crayon-sy">.</span><span class="crayon-v">topic</span><span class="crayon-sy">.</span><span class="crayon-e">indexOf</span><span class="crayon-sy">(</span><span class="crayon-s">'echo'</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">===</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10fd4ff3367866948665-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">cb</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a10fd4ff3367866948665-15"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10fd4ff3367866948665-16">&nbsp;</div><div class="crayon-line" id="crayon-5a10fd4ff3367866948665-17"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">newPacket</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10fd4ff3367866948665-18"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">topic</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">'echo/'</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">packet</span><span class="crayon-sy">.</span><span class="crayon-v">topic</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5a10fd4ff3367866948665-19"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">payload</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">packet</span><span class="crayon-sy">.</span><span class="crayon-v">payload</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10fd4ff3367866948665-20"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">retain</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">packet</span><span class="crayon-sy">.</span><span class="crayon-v">retain</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5a10fd4ff3367866948665-21"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">qos</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">packet</span><span class="crayon-sy">.</span><span class="crayon-i">qos</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10fd4ff3367866948665-22"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a10fd4ff3367866948665-23">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a10fd4ff3367866948665-24"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">console</span><span class="crayon-sy">.</span><span class="crayon-e">log</span><span class="crayon-sy">(</span><span class="crayon-s">'newPacket'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">newPacket</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a10fd4ff3367866948665-25"><span class="crayon-h">&nbsp;&nbsp;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10fd4ff3367866948665-26"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">server</span><span class="crayon-sy">.</span><span class="crayon-e">publish</span><span class="crayon-sy">(</span><span class="crayon-v">newPacket</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cb</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a10fd4ff3367866948665-27"><span class="crayon-sy">}</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0061 seconds] -->
<p>Here we hook a callback to the server published event and then build a new packet on every message received and then send the new packet to the client.</p>
<p>Now, we will build a MQTT client that can pub/sub to topics. Open a new terminal/prompt inside the <em>client</em> folder.</p>
<p>Our client will be another Node.js application. In this example, both are running on the same machine. But in real time, the client application will be deployed on an actual device like a Pi or a Arduino. And the server would be on the cloud.</p>
<p>Now, run</p>
<p style="text-align: center;">
<span id="crayon-5a10fd4ff336f481645106" class="crayon-syntax crayon-syntax-inline  crayon-theme-arduino-ide crayon-theme-arduino-ide-inline crayon-font-droid-sans-mono" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-e">npm </span><span class="crayon-v">init</span></span></span></p>
<p>Fill it up as applicable. MQTT.js would be a dependency here. Run</p>
<p style="text-align: center;">
<span id="crayon-5a10fd4ff3376809905910" class="crayon-syntax crayon-syntax-inline  crayon-theme-arduino-ide crayon-theme-arduino-ide-inline crayon-font-droid-sans-mono" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-e">npm </span><span class="crayon-e">install </span><span class="crayon-v">mqtt</span><span class="crayon-h"> </span><span class="crayon-o">--</span><span class="crayon-v">save</span></span></span></p>
<p>Create a new file named <em>client1.js </em>inside the client folder. We will emulate 2 clients on our local machine to see how things work. Update <em>client1.js</em> as below</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div id="crayon-5a10fd4ff337c821352779" class="crayon-syntax crayon-theme-arduino-ide crayon-font-droid-sans-mono crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">client/client1.js</span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">JavaScript</span></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
var mqtt = require('mqtt')
client = mqtt.createClient(1883, 'localhost');
client.subscribe('presence');
console.log('Client publishing.. ');
client.publish('presence', 'Client 1 is alive.. Test Ping! ' + Date());
client.end();</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums" data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a10fd4ff337c821352779-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10fd4ff337c821352779-2">2</div><div class="crayon-num" data-line="crayon-5a10fd4ff337c821352779-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10fd4ff337c821352779-4">4</div><div class="crayon-num" data-line="crayon-5a10fd4ff337c821352779-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10fd4ff337c821352779-6">6</div><div class="crayon-num" data-line="crayon-5a10fd4ff337c821352779-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10fd4ff337c821352779-8">8</div><div class="crayon-num" data-line="crayon-5a10fd4ff337c821352779-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10fd4ff337c821352779-10">10</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a10fd4ff337c821352779-1"><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">mqtt</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">require</span><span class="crayon-sy">(</span><span class="crayon-s">'mqtt'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10fd4ff337c821352779-2">&nbsp;</div><div class="crayon-line" id="crayon-5a10fd4ff337c821352779-3"><span class="crayon-v">client</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">mqtt</span><span class="crayon-sy">.</span><span class="crayon-e">createClient</span><span class="crayon-sy">(</span><span class="crayon-cn">1883</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'localhost'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10fd4ff337c821352779-4">&nbsp;</div><div class="crayon-line" id="crayon-5a10fd4ff337c821352779-5"><span class="crayon-v">client</span><span class="crayon-sy">.</span><span class="crayon-e">subscribe</span><span class="crayon-sy">(</span><span class="crayon-s">'presence'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10fd4ff337c821352779-6">&nbsp;</div><div class="crayon-line" id="crayon-5a10fd4ff337c821352779-7"><span class="crayon-v">console</span><span class="crayon-sy">.</span><span class="crayon-e">log</span><span class="crayon-sy">(</span><span class="crayon-s">'Client publishing.. '</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10fd4ff337c821352779-8"><span class="crayon-v">client</span><span class="crayon-sy">.</span><span class="crayon-e">publish</span><span class="crayon-sy">(</span><span class="crayon-s">'presence'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'Client 1 is alive.. Test Ping! '</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-r">Date</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a10fd4ff337c821352779-9">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a10fd4ff337c821352779-10"><span class="crayon-v">client</span><span class="crayon-sy">.</span><span class="crayon-st">end</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0027 seconds] -->
<p>Things to notice</p>
<p><strong>Line 1</strong> : We require MQTT</p>
<p><strong>Line 3</strong> : We connect to the server</p>
<p><strong>Line 5</strong> : We subscribe to a topic named &#8220;presence&#8221;</p>
<p><strong>Line 8</strong> : We publish a message to &#8220;presence&#8221;</p>
<p><strong>Line 10</strong> : We close the close the client</p>
<p>We will create another client that will listen for changes in the &#8220;presence&#8221; topic. Create a new file inside <em>client</em> folder and name it as <em>client2.js.</em> Update it as below</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div id="crayon-5a10fd4ff3383041012789" class="crayon-syntax crayon-theme-arduino-ide crayon-font-droid-sans-mono crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">client/client2.js</span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">JavaScript</span></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
var mqtt = require('mqtt')
client = mqtt.createClient(1883, 'localhost');
client.subscribe('presence');
client.on('message', function(topic, message) {
console.log(message);
});
console.log('Client started...');</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums" data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a10fd4ff3383041012789-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10fd4ff3383041012789-2">2</div><div class="crayon-num" data-line="crayon-5a10fd4ff3383041012789-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10fd4ff3383041012789-4">4</div><div class="crayon-num" data-line="crayon-5a10fd4ff3383041012789-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10fd4ff3383041012789-6">6</div><div class="crayon-num" data-line="crayon-5a10fd4ff3383041012789-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10fd4ff3383041012789-8">8</div><div class="crayon-num" data-line="crayon-5a10fd4ff3383041012789-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10fd4ff3383041012789-10">10</div><div class="crayon-num" data-line="crayon-5a10fd4ff3383041012789-11">11</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a10fd4ff3383041012789-1"><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">mqtt</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">require</span><span class="crayon-sy">(</span><span class="crayon-s">'mqtt'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10fd4ff3383041012789-2">&nbsp;</div><div class="crayon-line" id="crayon-5a10fd4ff3383041012789-3"><span class="crayon-v">client</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">mqtt</span><span class="crayon-sy">.</span><span class="crayon-e">createClient</span><span class="crayon-sy">(</span><span class="crayon-cn">1883</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'localhost'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10fd4ff3383041012789-4">&nbsp;</div><div class="crayon-line" id="crayon-5a10fd4ff3383041012789-5"><span class="crayon-v">client</span><span class="crayon-sy">.</span><span class="crayon-e">subscribe</span><span class="crayon-sy">(</span><span class="crayon-s">'presence'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10fd4ff3383041012789-6">&nbsp;</div><div class="crayon-line" id="crayon-5a10fd4ff3383041012789-7"><span class="crayon-v">client</span><span class="crayon-sy">.</span><span class="crayon-e">on</span><span class="crayon-sy">(</span><span class="crayon-s">'message'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-v">topic</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">message</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10fd4ff3383041012789-8"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">console</span><span class="crayon-sy">.</span><span class="crayon-e">log</span><span class="crayon-sy">(</span><span class="crayon-v">message</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a10fd4ff3383041012789-9"><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10fd4ff3383041012789-10">&nbsp;</div><div class="crayon-line" id="crayon-5a10fd4ff3383041012789-11"><span class="crayon-v">console</span><span class="crayon-sy">.</span><span class="crayon-e">log</span><span class="crayon-sy">(</span><span class="crayon-s">'Client started...'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0022 seconds] -->
<p>Same as <em>client1.js</em> except this client only listens to changes.</p>
<p>To test this, We will first start the server. Run</p>
<p style="text-align: center;">
<span id="crayon-5a10fd4ff338b828325685" class="crayon-syntax crayon-syntax-inline  crayon-theme-arduino-ide crayon-theme-arduino-ide-inline crayon-font-droid-sans-mono" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-e">node </span><span class="crayon-v">server</span><span class="crayon-sy">.</span><span class="crayon-v">js</span></span></span></p>
<p>And you should see the server started log. Next, client 2, Run</p>
<p style="text-align: center;">
<span id="crayon-5a10fd4ff3391889302110" class="crayon-syntax crayon-syntax-inline  crayon-theme-arduino-ide crayon-theme-arduino-ide-inline crayon-font-droid-sans-mono" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-e">node </span><span class="crayon-v">client2</span><span class="crayon-sy">.</span><span class="crayon-v">js</span></span></span></p>
<p>You should see the client started log. And finally client 1, Run</p>
<p style="text-align: center;">
<span id="crayon-5a10fd4ff3397731952125" class="crayon-syntax crayon-syntax-inline  crayon-theme-arduino-ide crayon-theme-arduino-ide-inline crayon-font-droid-sans-mono" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-e">node </span><span class="crayon-v">client1</span><span class="crayon-sy">.</span><span class="crayon-v">js</span></span></span></p>
<p>And the server console should reflect</p>
<p><a href="http://i2.wp.com/thejackalofjavascript.com/wp-content/uploads/2014/10/Screen-Shot-2014-10-22-at-7.54.29-pm.png" data-rel="lightbox-1" title=""><img class="size-medium wp-image-2345 aligncenter" src="http://i0.wp.com/thejackalofjavascript.com/wp-content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="http://i2.wp.com/thejackalofjavascript.com/wp-content/uploads/2014/10/Screen-Shot-2014-10-22-at-7.54.29-pm.png?resize=451%2C125" alt="Screen Shot 2014-10-22 at 7.54.29 pm" data-recalc-dims="1" /><noscript><img class="size-medium wp-image-2345 aligncenter" src="http://i2.wp.com/thejackalofjavascript.com/wp-content/uploads/2014/10/Screen-Shot-2014-10-22-at-7.54.29-pm.png?resize=451%2C125" alt="Screen Shot 2014-10-22 at 7.54.29 pm" data-recalc-dims="1" /></noscript></a>The last packet is our presence topic. And the client2 console should look like</p>
<p><a href="http://i2.wp.com/thejackalofjavascript.com/wp-content/uploads/2014/10/Screen-Shot-2014-10-22-at-7.55.07-pm.png" data-rel="lightbox-2" title=""><img class="size-medium wp-image-2346 aligncenter" src="http://i0.wp.com/thejackalofjavascript.com/wp-content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="http://i2.wp.com/thejackalofjavascript.com/wp-content/uploads/2014/10/Screen-Shot-2014-10-22-at-7.55.07-pm.png?resize=451%2C50" alt="Screen Shot 2014-10-22 at 7.55.07 pm" data-recalc-dims="1" /><noscript><img class="size-medium wp-image-2346 aligncenter" src="http://i2.wp.com/thejackalofjavascript.com/wp-content/uploads/2014/10/Screen-Shot-2014-10-22-at-7.55.07-pm.png?resize=451%2C50" alt="Screen Shot 2014-10-22 at 7.55.07 pm" data-recalc-dims="1" /></noscript></a>Simple and easy communication with MQTT protocol!</p>
<p>You can find the complete code in the example <a href="https://github.com/arvindr21/mqttApp.git" onclick="__gaTracker('send', 'event', 'outbound-article', 'https://github.com/arvindr21/mqttApp.git', 'here');" title="Code"  target="_blank">here</a>.</p>
<p>Also do checkout this awesome video by Matteo Collina where he Live Codes a Robot and control it from the web &#8211; LXJS 2014</p>
<p style="text-align: center;">
<!-- iframe plugin v.4.2 wordpress.org/plugins/iframe/ -->
<iframe width="640" height="360" src="//www.youtube.com/embed/BxJ-27Nnakc?rel=0" frameborder="0" 0="allowfullscreen" scrolling="yes" class="iframe-class"></iframe>
</p>
<p>Hope this post gave you an ideas as how to implement MQTT in Node.js</p>
<h4 style="text-align: center;">Special thanks to Matteo Collina for reviewing this article</h4>
<hr />
<p>Thanks for reading! Do comment.<br />
@arvindr21</p>
<!-- Simple Share Buttons Adder (6.1.5) simplesharebuttons.com --><div class="ssba ssba-wrap"><div style="text-align:left"><a href="http://twitter.com/share?url=/getting-started-mqtt/&amp;text=Getting+started+with+MQTT+From+The+Jackal+of+Javascript+by+%40arvindr21" onclick="__gaTracker('send', 'event', 'outbound-article', 'http://twitter.com/share?url=/getting-started-mqtt/&amp;text=Getting+started+with+MQTT+From+The+Jackal+of+Javascript+by+%40arvindr21', '');" data-site="" class="ssba_twitter_share"   target="_blank"  rel="nofollow"><img src="http://i0.wp.com/thejackalofjavascript.com/wp-content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="http://i2.wp.com/thejackalofjavascript.com/wp-content/plugins/simple-share-buttons-adder/buttons/somacro/twitter.png?w=646" title="Twitter" class="ssba ssba-img" alt="Tweet about this on Twitter" data-recalc-dims="1" /><noscript><img src="http://i2.wp.com/thejackalofjavascript.com/wp-content/plugins/simple-share-buttons-adder/buttons/somacro/twitter.png?w=646" title="Twitter" class="ssba ssba-img" alt="Tweet about this on Twitter" data-recalc-dims="1" /></noscript></a><a href="http://www.linkedin.com/shareArticle?mini=true&amp;url=/getting-started-mqtt/" onclick="__gaTracker('send', 'event', 'outbound-article', 'http://www.linkedin.com/shareArticle?mini=true&amp;url=/getting-started-mqtt/', '');" data-site="linkedin" class="ssba_linkedin_share ssba_share_link"   target="_blank"  rel="nofollow"><img src="http://i0.wp.com/thejackalofjavascript.com/wp-content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="http://i1.wp.com/thejackalofjavascript.com/wp-content/plugins/simple-share-buttons-adder/buttons/somacro/linkedin.png?w=646" title="LinkedIn" class="ssba ssba-img" alt="Share on LinkedIn" data-recalc-dims="1" /><noscript><img src="http://i1.wp.com/thejackalofjavascript.com/wp-content/plugins/simple-share-buttons-adder/buttons/somacro/linkedin.png?w=646" title="LinkedIn" class="ssba ssba-img" alt="Share on LinkedIn" data-recalc-dims="1" /></noscript></a><span class="ssba_sharecount">3</span><a href="https://plus.google.com/share?url=/getting-started-mqtt/" onclick="__gaTracker('send', 'event', 'outbound-article', 'https://plus.google.com/share?url=/getting-started-mqtt/', '');" data-site="" class="ssba_google_share"   target="_blank"  rel="nofollow"><img src="http://i0.wp.com/thejackalofjavascript.com/wp-content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="http://i2.wp.com/thejackalofjavascript.com/wp-content/plugins/simple-share-buttons-adder/buttons/somacro/google.png?w=646" title="Google+" class="ssba ssba-img" alt="Share on Google+" data-recalc-dims="1" /><noscript><img src="http://i2.wp.com/thejackalofjavascript.com/wp-content/plugins/simple-share-buttons-adder/buttons/somacro/google.png?w=646" title="Google+" class="ssba ssba-img" alt="Share on Google+" data-recalc-dims="1" /></noscript></a><span class="ssba_sharecount">0</span><a href="http://reddit.com/submit?url=/getting-started-mqtt/&amp;title=Getting started with MQTT" onclick="__gaTracker('send', 'event', 'outbound-article', 'http://reddit.com/submit?url=/getting-started-mqtt/&amp;title=Getting started with MQTT', '');" data-site="reddit" class="ssba_reddit_share"   target="_blank"  rel="nofollow"><img src="http://i0.wp.com/thejackalofjavascript.com/wp-content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="http://i0.wp.com/thejackalofjavascript.com/wp-content/plugins/simple-share-buttons-adder/buttons/somacro/reddit.png?w=646" title="Reddit" class="ssba ssba-img" alt="Share on Reddit" data-recalc-dims="1" /><noscript><img src="http://i0.wp.com/thejackalofjavascript.com/wp-content/plugins/simple-share-buttons-adder/buttons/somacro/reddit.png?w=646" title="Reddit" class="ssba ssba-img" alt="Share on Reddit" data-recalc-dims="1" /></noscript></a><span class="ssba_sharecount">0</span><a href="https://bufferapp.com/add?url=/getting-started-mqtt/&amp;text=From The Jackal of Javascript Getting started with MQTT" onclick="__gaTracker('send', 'event', 'outbound-article', 'https://bufferapp.com/add?url=/getting-started-mqtt/&amp;text=From The Jackal of Javascript Getting started with MQTT', '');" data-site="buffer" class="ssba_buffer_share"   target="_blank"  rel="nofollow"><img src="http://i0.wp.com/thejackalofjavascript.com/wp-content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="http://i1.wp.com/thejackalofjavascript.com/wp-content/plugins/simple-share-buttons-adder/buttons/somacro/buffer.png?w=646" title="Buffer" class="ssba ssba-img" alt="Buffer this page" data-recalc-dims="1" /><noscript><img src="http://i1.wp.com/thejackalofjavascript.com/wp-content/plugins/simple-share-buttons-adder/buttons/somacro/buffer.png?w=646" title="Buffer" class="ssba ssba-img" alt="Buffer this page" data-recalc-dims="1" /></noscript></a><a href="https://flattr.com/submit/auto?user_id=arvindr21&amp;title=Getting started with MQTT&amp;url=https://flattr.com/profile/arvindr21" onclick="__gaTracker('send', 'event', 'outbound-article', 'https://flattr.com/submit/auto?user_id=arvindr21&amp;title=Getting started with MQTT&amp;url=https://flattr.com/profile/arvindr21', '');" data-site="flattr" class="ssba_flattr_share"   target="_blank"  rel="nofollow"><img src="http://i0.wp.com/thejackalofjavascript.com/wp-content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="http://i0.wp.com/thejackalofjavascript.com/wp-content/plugins/simple-share-buttons-adder/buttons/somacro/flattr.png?w=646" title="Flattr" class="ssba ssba-img" alt="Flattr the author" data-recalc-dims="1" /><noscript><img src="http://i0.wp.com/thejackalofjavascript.com/wp-content/plugins/simple-share-buttons-adder/buttons/somacro/flattr.png?w=646" title="Flattr" class="ssba ssba-img" alt="Flattr the author" data-recalc-dims="1" /></noscript></a><a data-site="email" class="ssba_email_share" href="/cdn-cgi/l/email-protection#b18ec2c4d3dbd4d2c58cf6d4c5c5d8dfd691c2c5d0c3c5d4d591c6d8c5d991fce0e5e597d0dcc18ad3ded5c88cf7c3dedc91e5d9d491fbd0d2dad0dd91ded791fbd0c7d0c2d2c3d8c1c5948381d9c5c5c18b9e9ec5d9d4dbd0d2dad0ddded7dbd0c7d0c2d2c3d8c1c59fd2dedc9ed6d4c5c5d8dfd69cc2c5d0c3c5d4d59cdcc0c5c59e"><img src="http://i0.wp.com/thejackalofjavascript.com/wp-content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="http://i0.wp.com/thejackalofjavascript.com/wp-content/plugins/simple-share-buttons-adder/buttons/somacro/email.png?w=646" title="Email" class="ssba ssba-img" alt="Email this to someone" data-recalc-dims="1" /><noscript><img src="http://i0.wp.com/thejackalofjavascript.com/wp-content/plugins/simple-share-buttons-adder/buttons/somacro/email.png?w=646" title="Email" class="ssba ssba-img" alt="Email this to someone" data-recalc-dims="1" /></noscript></a><a data-site="print" class="ssba_print ssba_share_link" href="#" onclick="window.print()"><img src="http://i0.wp.com/thejackalofjavascript.com/wp-content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="http://i0.wp.com/thejackalofjavascript.com/wp-content/plugins/simple-share-buttons-adder/buttons/somacro/print.png?w=646" title="Print" class="ssba ssba-img" alt="Print this page" data-recalc-dims="1" /><noscript><img src="http://i0.wp.com/thejackalofjavascript.com/wp-content/plugins/simple-share-buttons-adder/buttons/somacro/print.png?w=646" title="Print" class="ssba ssba-img" alt="Print this page" data-recalc-dims="1" /></noscript></a></div></div><div class='sharedaddy sd-block sd-like jetpack-likes-widget-wrapper jetpack-likes-widget-unloaded' id='like-post-wrapper-70838519-2330-5a10fd50b19d6' data-src='//widgets.wp.com/likes/#blog_id=70838519&amp;post_id=2330&amp;origin=thejackalofjavascript.com&amp;obj_id=70838519-2330-5a10fd50b19d6' data-name='like-post-frame-70838519-2330-5a10fd50b19d6'><h3 class='sd-title'>Like this:</h3><div class='likes-widget-placeholder post-likes-widget-placeholder' style='height:55px'><span class='button'><span>Like</span></span> <span class="loading">Loading...</span></div><span class='sd-text-color'></span><a class='sd-link-color'></a></div>
<div id='jp-relatedposts' class='jp-relatedposts' >
<h3 class="jp-relatedposts-headline"><em>Related</em></h3>
</div>
<div class="entry-content">
</div><!-- .entry-content -->
<footer class="entry-meta">
<span class="post-date"><a href="/getting-started-mqtt/" title="8:14 pm" rel="bookmark"><time class="entry-date" datetime="2014-10-22T20:14:53+00:00">October 22, 2014</time></a></span><span class="byline"><span class="author vcard"><a class="url fn n" href="/author/arvind-ravulavaru/" title="View all posts by Arvind Ravulavaru" rel="author">Arvind Ravulavaru</a></span></span>					</footer><!-- .entry-meta -->
</article><!-- #post-## -->
<nav class="navigation post-navigation" role="navigation">
<h1 class="screen-reader-text">Post navigation</h1>
<div class="nav-links">
<div class="nav-previous"><a href="/rpi-pir-sensor-node-iot-intruder-alert/" rel="prev"><span class="meta-nav screen-reader-text">&larr;</span></a></div><div class="nav-next"><a href="/ionic-creator-beta/" rel="next"><span class="meta-nav screen-reader-text">&rarr;</span></a></div>		</div><!-- .nav-links -->
</nav><!-- .navigation -->
<div id="disqus_thread">
<div id="dsq-content">
<ul id="dsq-comments">
<li class="comment even thread-even depth-1" id="dsq-comment-3313">
<div id="dsq-comment-header-3313" class="dsq-comment-header">
<cite id="dsq-cite-3313">
<span id="dsq-author-user-3313">Sunil Gudivada</span>
</cite>
</div>
<div id="dsq-comment-body-3313" class="dsq-comment-body">
<div id="dsq-comment-message-3313" class="dsq-comment-message"><p>i want to work this code in the browser. what shoud i do ?</p>
</div>
</div>
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="dsq-comment-3165">
<div id="dsq-comment-header-3165" class="dsq-comment-header">
<cite id="dsq-cite-3165">
<span id="dsq-author-user-3165">Clemens</span>
</cite>
</div>
<div id="dsq-comment-body-3165" class="dsq-comment-body">
<div id="dsq-comment-message-3165" class="dsq-comment-message"><p>Hi, thank you so much for this awesome tutorial!</p>
<p>When i log the client&#8217;s message to the console, I always get a buffer format instead of an ordinary string. Do i have to use the mqtt.js parser here?</p>
<p>Thanks in advance for any advice on this issue!</p>
</div>
</div>
<ul class="children">
<li class="comment even depth-2" id="dsq-comment-3166">
<div id="dsq-comment-header-3166" class="dsq-comment-header">
<cite id="dsq-cite-3166">
<span id="dsq-author-user-3166">Clemens</span>
</cite>
</div>
<div id="dsq-comment-body-3166" class="dsq-comment-body">
<div id="dsq-comment-message-3166" class="dsq-comment-message"><p>I found that I had messed up with the .toString() function, sorry for that post. Thanks anyway!</p>
</div>
</div>
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="dsq-comment-3161">
<div id="dsq-comment-header-3161" class="dsq-comment-header">
<cite id="dsq-cite-3161">
<span id="dsq-author-user-3161">Iosu R</span>
</cite>
</div>
<div id="dsq-comment-body-3161" class="dsq-comment-body">
<div id="dsq-comment-message-3161" class="dsq-comment-message"><p>Client.js line 3<br />
createClient is deprecated, use connect instead</p>
</div>
</div>
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="dsq-comment-3127">
<div id="dsq-comment-header-3127" class="dsq-comment-header">
<cite id="dsq-cite-3127">
<span id="dsq-author-user-3127">Behram Buhariwala</span>
</cite>
</div>
<div id="dsq-comment-body-3127" class="dsq-comment-body">
<div id="dsq-comment-message-3127" class="dsq-comment-message"><p>Sir, I have followed the steps as per the tutorial. When i run the file client2.js and the client1.js it detects a change to the &#8220;presence&#8221; topic. As per the tutorial, the message to be displayed on client2.js after runing client1.js should be &#8220;Client 1 is alive.. Test Ping&#8230;&#8230;&#8230;..&#8221;. But i get data in a buffer format i.e. . Please help me rectify the same.</p>
</div>
</div>
<ul class="children">
<li class="comment odd alt depth-2" id="dsq-comment-3317">
<div id="dsq-comment-header-3317" class="dsq-comment-header">
<cite id="dsq-cite-3317">
<span id="dsq-author-user-3317">Agrim</span>
</cite>
</div>
<div id="dsq-comment-body-3317" class="dsq-comment-body">
<div id="dsq-comment-message-3317" class="dsq-comment-message"><p>The message is in buffer format as per MQTT spec. call toString() on it.</p>
</div>
</div>
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="dsq-comment-2954">
<div id="dsq-comment-header-2954" class="dsq-comment-header">
<cite id="dsq-cite-2954">
<span id="dsq-author-user-2954">java_an</span>
</cite>
</div>
<div id="dsq-comment-body-2954" class="dsq-comment-body">
<div id="dsq-comment-message-2954" class="dsq-comment-message"><p>mqtt works on sub and pub concept see for more details</p>
<p><a href="http://www.javaproficiency.com/2015/09/how-to-install-mosquitto-mqtt-on-ubuntu.html" onclick="__gaTracker('send', 'event', 'outbound-comment', 'http://www.javaproficiency.com/2015/09/how-to-install-mosquitto-mqtt-on-ubuntu.html', 'http://www.javaproficiency.com/2015/09/how-to-install-mosquitto-mqtt-on-ubuntu.html');" rel="nofollow">http://www.javaproficiency.com/2015/09/how-to-install-mosquitto-mqtt-on-ubuntu.html</a></p>
</div>
</div>
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="dsq-comment-2382">
<div id="dsq-comment-header-2382" class="dsq-comment-header">
<cite id="dsq-cite-2382">
<span id="dsq-author-user-2382">Niral</span>
</cite>
</div>
<div id="dsq-comment-body-2382" class="dsq-comment-body">
<div id="dsq-comment-message-2382" class="dsq-comment-message"><p>How to publish message from another javascript file other than server.js?</p>
</div>
</div>
<ul class="children">
<li class="comment even depth-2" id="dsq-comment-2383">
<div id="dsq-comment-header-2383" class="dsq-comment-header">
<cite id="dsq-cite-2383">
/                <span id="dsq-author-user-2383">Arvind Ravulavaru</span>
</cite>
</div>
<div id="dsq-comment-body-2383" class="dsq-comment-body">
<div id="dsq-comment-message-2383" class="dsq-comment-message"><p>Can you elaborate your question please? </p>
</div>
</div>
<ul class="children">
<li class="comment odd alt depth-3" id="dsq-comment-2385">
<div id="dsq-comment-header-2385" class="dsq-comment-header">
<cite id="dsq-cite-2385">
<span id="dsq-author-user-2385">Niral</span>
</cite>
</div>
<div id="dsq-comment-body-2385" class="dsq-comment-body">
<div id="dsq-comment-message-2385" class="dsq-comment-message"><p>As you can see you&#8217;re doing Server.publish() in server.js to publish messages to client. How can I use publish method in other javascript file rather than server.js as object server is not in scope of other file. I don&#8217;t know much of Javascript as I am Electronics guy.</p>
</div>
</div>
<ul class="children">
<li class="comment even depth-4" id="dsq-comment-2390">
<div id="dsq-comment-header-2390" class="dsq-comment-header">
<cite id="dsq-cite-2390">
/                <span id="dsq-author-user-2390">Arvind Ravulavaru</span>
</cite>
</div>
<div id="dsq-comment-body-2390" class="dsq-comment-body">
<div id="dsq-comment-message-2390" class="dsq-comment-message"><p>So, if I understood the requirement correctly, when the client reaches out to the server, you want to run a processing logic from some other file and return the packet.</p>
<p>For that you can use Node&#8217;s <code>require()</code> and <code>module.exports</code>. </p>
<p>You can create a file named <code>myLogic.js</code> at the same level as <code>server.js</code>. The contents of <code>myLogic.js</code> would be </p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div id="crayon-5a10fd50007af692587368" class="crayon-syntax crayon-theme-arduino-ide crayon-font-droid-sans-mono crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
var processPacket = function(packet){
// some processing logic
return data; // the final output
};
module.exports. processPacket = processPacket;
</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums" data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a10fd50007af692587368-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10fd50007af692587368-2">2</div><div class="crayon-num" data-line="crayon-5a10fd50007af692587368-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10fd50007af692587368-4">4</div><div class="crayon-num" data-line="crayon-5a10fd50007af692587368-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10fd50007af692587368-6">6</div><div class="crayon-num" data-line="crayon-5a10fd50007af692587368-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10fd50007af692587368-8">8</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a10fd50007af692587368-1">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a10fd50007af692587368-2"><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">processPacket</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-v">packet</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a10fd50007af692587368-3"><span class="crayon-c">// some processing logic</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10fd50007af692587368-4"><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// the final output</span></div><div class="crayon-line" id="crayon-5a10fd50007af692587368-5"><span class="crayon-sy">}</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10fd50007af692587368-6">&nbsp;</div><div class="crayon-line" id="crayon-5a10fd50007af692587368-7"><span class="crayon-v">module</span><span class="crayon-sy">.</span><span class="crayon-v">exports</span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-v">processPacket</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">processPacket</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10fd50007af692587368-8">&nbsp;</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0012 seconds] -->
<p></p>
<p>And now your <code>server.js</code> would be </p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div id="crayon-5a10fd50007ba077086864" class="crayon-syntax crayon-theme-arduino-ide crayon-font-droid-sans-mono crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
var mosca = require('mosca');
var myLogic = require('./myLogic.js');
var settings = {
port: 1883,
persistence: mosca.persistence.Memory
};
var server = new mosca.Server(settings, function() {
console.log('Mosca server is up and running')
});
server.published = function(packet, client, cb) {
if (packet.topic.indexOf('echo') === 0) {
return cb();
}
var data = myLogic. processPacket(packet);
var newPacket = {
topic: 'echo/' + packet.topic,
payload:  data, // You can send the newly processed data back
retain: packet.retain,
qos: packet.qos
};
console.log('newPacket', newPacket);
server.publish(newPacket, cb);
}
</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums" data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a10fd50007ba077086864-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10fd50007ba077086864-2">2</div><div class="crayon-num" data-line="crayon-5a10fd50007ba077086864-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10fd50007ba077086864-4">4</div><div class="crayon-num" data-line="crayon-5a10fd50007ba077086864-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10fd50007ba077086864-6">6</div><div class="crayon-num" data-line="crayon-5a10fd50007ba077086864-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10fd50007ba077086864-8">8</div><div class="crayon-num" data-line="crayon-5a10fd50007ba077086864-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10fd50007ba077086864-10">10</div><div class="crayon-num" data-line="crayon-5a10fd50007ba077086864-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10fd50007ba077086864-12">12</div><div class="crayon-num" data-line="crayon-5a10fd50007ba077086864-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10fd50007ba077086864-14">14</div><div class="crayon-num" data-line="crayon-5a10fd50007ba077086864-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10fd50007ba077086864-16">16</div><div class="crayon-num" data-line="crayon-5a10fd50007ba077086864-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10fd50007ba077086864-18">18</div><div class="crayon-num" data-line="crayon-5a10fd50007ba077086864-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10fd50007ba077086864-20">20</div><div class="crayon-num" data-line="crayon-5a10fd50007ba077086864-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10fd50007ba077086864-22">22</div><div class="crayon-num" data-line="crayon-5a10fd50007ba077086864-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10fd50007ba077086864-24">24</div><div class="crayon-num" data-line="crayon-5a10fd50007ba077086864-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10fd50007ba077086864-26">26</div><div class="crayon-num" data-line="crayon-5a10fd50007ba077086864-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10fd50007ba077086864-28">28</div><div class="crayon-num" data-line="crayon-5a10fd50007ba077086864-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10fd50007ba077086864-30">30</div><div class="crayon-num" data-line="crayon-5a10fd50007ba077086864-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10fd50007ba077086864-32">32</div><div class="crayon-num" data-line="crayon-5a10fd50007ba077086864-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10fd50007ba077086864-34">34</div><div class="crayon-num" data-line="crayon-5a10fd50007ba077086864-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10fd50007ba077086864-36">36</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a10fd50007ba077086864-1">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a10fd50007ba077086864-2">&nbsp;</div><div class="crayon-line" id="crayon-5a10fd50007ba077086864-3"><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">mosca</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">require</span><span class="crayon-sy">(</span><span class="crayon-s">'mosca'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10fd50007ba077086864-4">&nbsp;</div><div class="crayon-line" id="crayon-5a10fd50007ba077086864-5"><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">myLogic</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">require</span><span class="crayon-sy">(</span><span class="crayon-s">'./myLogic.js'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10fd50007ba077086864-6">&nbsp;</div><div class="crayon-line" id="crayon-5a10fd50007ba077086864-7"><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">settings</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10fd50007ba077086864-8"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">port</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">1883</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5a10fd50007ba077086864-9"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">persistence</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">mosca</span><span class="crayon-sy">.</span><span class="crayon-v">persistence</span><span class="crayon-sy">.</span><span class="crayon-i">Memory</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10fd50007ba077086864-10"><span class="crayon-sy">}</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a10fd50007ba077086864-11">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a10fd50007ba077086864-12"><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">server</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">new</span><span class="crayon-h"> </span><span class="crayon-v">mosca</span><span class="crayon-sy">.</span><span class="crayon-e">Server</span><span class="crayon-sy">(</span><span class="crayon-v">settings</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a10fd50007ba077086864-13"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">console</span><span class="crayon-sy">.</span><span class="crayon-e">log</span><span class="crayon-sy">(</span><span class="crayon-s">'Mosca server is up and running'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10fd50007ba077086864-14"><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a10fd50007ba077086864-15">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a10fd50007ba077086864-16"><span class="crayon-v">server</span><span class="crayon-sy">.</span><span class="crayon-v">published</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-v">packet</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">client</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cb</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a10fd50007ba077086864-17"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">packet</span><span class="crayon-sy">.</span><span class="crayon-v">topic</span><span class="crayon-sy">.</span><span class="crayon-e">indexOf</span><span class="crayon-sy">(</span><span class="crayon-s">'echo'</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">===</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10fd50007ba077086864-18"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">cb</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a10fd50007ba077086864-19"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10fd50007ba077086864-20">&nbsp;</div><div class="crayon-line" id="crayon-5a10fd50007ba077086864-21"><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">myLogic</span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-e">processPacket</span><span class="crayon-sy">(</span><span class="crayon-v">packet</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10fd50007ba077086864-22">&nbsp;</div><div class="crayon-line" id="crayon-5a10fd50007ba077086864-23"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">newPacket</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10fd50007ba077086864-24"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">topic</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">'echo/'</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">packet</span><span class="crayon-sy">.</span><span class="crayon-v">topic</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5a10fd50007ba077086864-25"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">payload</span><span class="crayon-o">:</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">data</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-c">// You can send the newly processed data back</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10fd50007ba077086864-26"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">retain</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">packet</span><span class="crayon-sy">.</span><span class="crayon-v">retain</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5a10fd50007ba077086864-27"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">qos</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">packet</span><span class="crayon-sy">.</span><span class="crayon-i">qos</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10fd50007ba077086864-28"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a10fd50007ba077086864-29">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a10fd50007ba077086864-30"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">console</span><span class="crayon-sy">.</span><span class="crayon-e">log</span><span class="crayon-sy">(</span><span class="crayon-s">'newPacket'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">newPacket</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a10fd50007ba077086864-31">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a10fd50007ba077086864-32"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">server</span><span class="crayon-sy">.</span><span class="crayon-e">publish</span><span class="crayon-sy">(</span><span class="crayon-v">newPacket</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cb</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a10fd50007ba077086864-33">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a10fd50007ba077086864-34"><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5a10fd50007ba077086864-35">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a10fd50007ba077086864-36">&nbsp;</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0058 seconds] -->
<p></p>
<p>If my understanding is correct, above would be a solutions, else please share your requirement. </p>
<p>You can know more about Nodejs design patterns from here : <a href="/node-js-design-patterns/" rel="nofollow">/node-js-design-patterns/</a></p>
<p>Thanks.</p>
</div>
</div>
<ul class="children">
<li class="comment odd alt depth-5" id="dsq-comment-2394">
<div id="dsq-comment-header-2394" class="dsq-comment-header">
<cite id="dsq-cite-2394">
<span id="dsq-author-user-2394">Niral</span>
</cite>
</div>
<div id="dsq-comment-body-2394" class="dsq-comment-body">
<div id="dsq-comment-message-2394" class="dsq-comment-message"><p>Thanks for the replay..</p>
<p>Above code snippet and that post is really informative.</p>
<p>Let me tell you exact scenario in my project. I am using express in my project for routing.</p>
<p>in my app.js I am doing..</p>
<p>var data = require(&#8216;./routes/data.js&#8217;);</p>
<p>app.get(&#8216;/data/:a/:b&#8217;, data.data);</p>
<p>in data.js (which is in routes directory) I have..</p>
<p>exports.data = function (req, res) {<br />
var data = {<br />
&#8220;Data&#8221;: {<br />
&#8220;a&#8221;: req.params.a,<br />
&#8220;b&#8221;: req.params.b<br />
}<br />
};</p>
<p>    res.send(data);<br />
};</p>
<p>What I&#8217;m trying to do is to publish same data to MQTT client after sending json response to HTTP client (res.send(data);).</p>
</div>
</div>
</li><!-- #comment-## -->
<li class="comment even depth-5" id="dsq-comment-2406">
<div id="dsq-comment-header-2406" class="dsq-comment-header">
<cite id="dsq-cite-2406">
/                <span id="dsq-author-user-2406">Arvind Ravulavaru</span>
</cite>
</div>
<div id="dsq-comment-body-2406" class="dsq-comment-body">
<div id="dsq-comment-message-2406" class="dsq-comment-message"><p>If the request is coming to express, how will mosca know the client? Express understands its own clients and mosca its. You cannot send a response to a mosca client from a request to Express (As far as I know, I could be totally wrong!) You can raise an issue here  : <a href="https://github.com/mcollina/mosca" onclick="__gaTracker('send', 'event', 'outbound-comment', 'https://github.com/mcollina/mosca', 'https://github.com/mcollina/mosca');" rel="nofollow">https://github.com/mcollina/mosca</a> and check with Matteo. </p>
<p>Do let me know how it works out!</p>
</div>
</div>
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="dsq-comment-2255">
<div id="dsq-comment-header-2255" class="dsq-comment-header">
<cite id="dsq-cite-2255">
<span id="dsq-author-user-2255">Pedro Jimenez</span>
</cite>
</div>
<div id="dsq-comment-body-2255" class="dsq-comment-body">
<div id="dsq-comment-message-2255" class="dsq-comment-message"><p>Hi, nice tutorial. I hope this code help, I just wrote some code to complement the clients, the new client has the capability to re-subscribe to the topics when the client reconnect to the mqtt server. <a href="https://github.com/pedrojimenezp/mqtt-client-server" onclick="__gaTracker('send', 'event', 'outbound-comment', 'https://github.com/pedrojimenezp/mqtt-client-server', 'https://github.com/pedrojimenezp/mqtt-client-server');" rel="nofollow">https://github.com/pedrojimenezp/mqtt-client-server</a></p>
</div>
</div>
<ul class="children">
<li class="comment even depth-2" id="dsq-comment-2256">
<div id="dsq-comment-header-2256" class="dsq-comment-header">
<cite id="dsq-cite-2256">
/                <span id="dsq-author-user-2256">Arvind Ravulavaru</span>
</cite>
</div>
<div id="dsq-comment-body-2256" class="dsq-comment-body">
<div id="dsq-comment-message-2256" class="dsq-comment-message"><p>Hello Pedro, Thanks!. And Thanks for sharing the code. </p>
</div>
</div>
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul>
</div>
</div>
<script src="/cdn-cgi/scripts/0e574bed/cloudflare-static/email-decode.min.js"></script><script type="text/javascript">
var disqus_url = '/getting-started-mqtt/';
var disqus_identifier = '2330 /?p=2330';
var disqus_container_id = 'disqus_thread';
var disqus_shortname = 'thejackalofjavascriptcom';
var disqus_title = "Getting started with MQTT";
var disqus_config_custom = window.disqus_config;
var disqus_config = function () {
/*
All currently supported events:
onReady: fires when everything is ready,
onNewComment: fires when a new comment is posted,
onIdentify: fires when user is authenticated
*/
this.language = '';
this.callbacks.onReady.push(function () {
// sync comments in the background so we don't block the page
var script = document.createElement('script');
script.async = true;
script.src = '?cf_action=sync_comments&post_id=2330';
var firstScript = document.getElementsByTagName('script')[0];
firstScript.parentNode.insertBefore(script, firstScript);
});
if (disqus_config_custom) {
disqus_config_custom.call(this);
}
};
(function() {
var dsq = document.createElement('script'); dsq.type = 'text/javascript';
dsq.async = true;
dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>
</main><!-- #main -->
</div><!-- #primary -->
<div id="secondary" class="widget-area" role="complementary">
<aside id="search-2" class="widget widget_search"><form role="search" method="get" class="search-form" action="/">
<label>
<span class="screen-reader-text">Search for:</span>
<input type="search" class="search-field" placeholder="Search &hellip;" value="" name="s">
</label>
<input type="submit" class="search-submit" value="Search">
</form>
</aside><aside id="text-2" class="widget widget_text"><h1 class="widget-title">This is me!!</h1>			<div class="textwidget"><style>
.socl-btn
{
padding: 3px;
background: #f45145;
border-radius: 3px;
color: rgba(255, 255, 255, 0.6) !important;
margin-top: 9px;
display: inline-block;
text-align: center;
width:100%;
-webkit-transition: all 0.2s ease-in-out;
-moz-transition: all 0.2s ease-in-out;
-o-transition: all 0.2s ease-in-out;
transition: all 0.2s ease-in-out;
}
.socl-btn:hover{
color:#fff !important;
}
.lkdin{
background-image: url(/wp-content/uploads/2014/08/l.png);
background-repeat: no-repeat;
background-position: left;
}
.gplus{
background-image: url(/wp-content/uploads/2014/08/g.png);
background-repeat: no-repeat;
background-position: left;
}
.mongodir{
background-image: url(/wp-content/uploads/2014/08/m.png);
background-repeat: no-repeat;
background-position: left;
}
.sitept{
background-image: url(/wp-content/uploads/2014/08/s.png);
background-repeat: no-repeat;
background-position: left;
}
</style>
<img src="/wp-content/uploads/2014/02/030a49b.jpg" alt="Arvind Ravulavaru" style="width: 81px; margin: 0px auto;display: block;border-radius: 45px;"/>
<br/>
<label>
Hello.. I am Arvind Ravulavaru a Full Stack Consultant based out of Hyderabad, India. This blog is my way of giving back to the Javascript Community!</label>
<br/>
<div style="text-align:center;" ><a  href="/portfolio/">Know more about me</a></div>
<br/>
<div  style="text-align:center;">
<a href="https://twitter.com/arvindr21" onclick="__gaTracker('send', 'event', 'outbound-widget', 'https://twitter.com/arvindr21', 'Follow @arvindr21');" class="twitter-follow-button" data-show-count="false">Follow @arvindr21</a>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script> 
<iframe src="http://ghbtns.com/github-btn.html?user=arvindr21&type=follow"
allowtransparency="true" frameborder="0" scrolling="0" width="132" height="20"></iframe><br/><br/>
<a href="http://in.linkedin.com/in/arvindravulavaru" onclick="__gaTracker('send', 'event', 'outbound-widget', 'http://in.linkedin.com/in/arvindravulavaru', 'Linked In');" target="_blank"  class="socl-btn lkdin">Linked In</a>
<a href="https://plus.google.com/+ArvindRavulavaru" onclick="__gaTracker('send', 'event', 'outbound-widget', 'https://plus.google.com/+ArvindRavulavaru', 'Google Plus');" target="_blank"  class="socl-btn gplus">Google Plus</a><br/>
<a href="http://blog.mongodirector.com/author/arvindr" onclick="__gaTracker('send', 'event', 'outbound-widget', 'http://blog.mongodirector.com/author/arvindr', 'Mongo Director');" target="_blank"  class="socl-btn mongodir">Mongo Director</a> <a href="http://www.sitepoint.com/author/aravulavaru/" onclick="__gaTracker('send', 'event', 'outbound-widget', 'http://www.sitepoint.com/author/aravulavaru/', 'Site Point');" target="_blank"  class="socl-btn sitept">Site Point</a> <br/><br/>
<a href="https://paper.li/arvindr21/1409328222#!headlines/" onclick="__gaTracker('send', 'event', 'outbound-widget', 'https://paper.li/arvindr21/1409328222#!headlines/', 'Chronicles of the Jackal of Javascript');" target="_blank"  class="socl-btn">Chronicles of the Jackal of Javascript</a>
</div></div>
</aside><aside id="text-5" class="widget widget_text">			<div class="textwidget"><style>
.crm-app, .crm-ext
{
padding: 9px;
background: #787878;
border-radius: 45px;
color: #EFEFEE !important;
margin-top: 9px;
display: inline-block;
text-align: center;
}
</style>
<a href="https://chrome.google.com/webstore/detail/the-jackal-of-javascript/oiaebkkgbicadojhdipjajkhjkeencdm" onclick="__gaTracker('send', 'event', 'outbound-widget', 'https://chrome.google.com/webstore/detail/the-jackal-of-javascript/oiaebkkgbicadojhdipjajkhjkeencdm', 'Chrome App');" target ="_blank" class="crm-app">Chrome App</a>
<a href="https://chrome.google.com/webstore/detail/the-jackal-of-javascript/dokdjofgoglghfljkpmmkgfpipgcmjme" onclick="__gaTracker('send', 'event', 'outbound-widget', 'https://chrome.google.com/webstore/detail/the-jackal-of-javascript/dokdjofgoglghfljkpmmkgfpipgcmjme', 'Chrome Extension');" target ="_blank" class="crm-ext">Chrome Extension</a></div>
</aside><aside id="text-7" class="widget widget_text"><h1 class="widget-title">Workshops</h1>			<div class="textwidget"><ul>
<li><a href="http://mean-workshop.herokuapp.com/" onclick="__gaTracker('send', 'event', 'outbound-widget', 'http://mean-workshop.herokuapp.com', 'o/ M.E.A.N. Workshop');" target="_blank">\o/ M.E.A.N. Workshop</a>
</li>
</ul></div>
</aside><aside id="text-6" class="widget widget_text"><h1 class="widget-title">Presentations</h1>			<div class="textwidget"><ul>
<li><a href="http://arvindr21.github.io/ng-overview" onclick="__gaTracker('send', 'event', 'outbound-widget', 'http://arvindr21.github.io/ng-overview', 'Overview of Angularjs');" target="_blank">Overview of Angularjs</a>
</li>
<li><a href="http://arvindr21.github.io/howBrowserWorks" onclick="__gaTracker('send', 'event', 'outbound-widget', 'http://arvindr21.github.io/howBrowserWorks', 'How Browser Works');" target="_blank">How Browser Works</a>
</li>
<li><a href="http://arvindr21.github.io/WebComponents" onclick="__gaTracker('send', 'event', 'outbound-widget', 'http://arvindr21.github.io/WebComponents', 'Web Components');" target="_blank">Web Components</a>
</li>
<li><a href="http://arvindr21.github.io/building-n-Scaffolding" onclick="__gaTracker('send', 'event', 'outbound-widget', 'http://arvindr21.github.io/building-n-Scaffolding', 'Modern UI Build Systems and Scaffolding Tools');" target="_blank">Modern UI Build Systems and Scaffolding Tools</a>
</li>
<li><a href="http://arvindr21.github.io/backbonejs" onclick="__gaTracker('send', 'event', 'outbound-widget', 'http://arvindr21.github.io/backbonejs', 'Backbonejs');" target="_blank">Backbonejs</a>
</li>
<li><a href="http://arvindr21.github.io/rwd" onclick="__gaTracker('send', 'event', 'outbound-widget', 'http://arvindr21.github.io/rwd', 'Responsive Web Design');" target="_blank">Responsive Web Design</a>
</li>
</ul></div>
</aside><aside id="text-3" class="widget widget_text"><h1 class="widget-title">Projects</h1>			<div class="textwidget"><ul><li><a href="/rotten-tomatoes-jquery-rest-client/" target="_blank">Rotten Tomatoes jQuery Rest Client</a>
</li>
<li>
<a href="/uploading-files-made-fun/" target="_blank">blueimp-file-upload-expressjs</a> - A Node Package
</li>
<li>
<a href="http://arvindr21.github.io/lazyboy/" onclick="__gaTracker('send', 'event', 'outbound-widget', 'http://arvindr21.github.io/lazyboy/', 'lazyboy');" target="_blank">lazyboy</a> - Command line laziness redefined
</li>
<li>
<a href="http://arvindr21.github.io/diskDB/" onclick="__gaTracker('send', 'event', 'outbound-widget', 'http://arvindr21.github.io/diskDB/', 'diskDB');" target="_blank">diskDB</a> - A Light Weight Disk based JSON Database - A Node Package
</li>
<li>
<a href="https://github.com/search?utf8=%E2%9C%93&q=user%3Aarvindr21+slush&type=Repositories&ref=searchresults" onclick="__gaTracker('send', 'event', 'outbound-widget', 'https://github.com/search?utf8=%E2%9C%93&amp;q=user%3Aarvindr21+slush&amp;type=Repositories&amp;ref=searchresults', 'My Slush Generators');" target="_blank">My Slush Generators</a>
</li>
<li>
<a href="https://github.com/search?utf8=%E2%9C%93&q=user%3Aarvindr21+yeoman&type=Repositories&ref=searchresults" onclick="__gaTracker('send', 'event', 'outbound-widget', 'https://github.com/search?utf8=%E2%9C%93&amp;q=user%3Aarvindr21+yeoman&amp;type=Repositories&amp;ref=searchresults', 'My Yeoman Generators');" target="_blank">My Yeoman Generators</a>
</li>
<li>
<a href="https://github.com/arvindr21/myWebComponents#mywebcomponents" onclick="__gaTracker('send', 'event', 'outbound-widget', 'https://github.com/arvindr21/myWebComponents#mywebcomponents', 'My Web Components');" target="_blank">My Web Components</a>
</li>
<li>
<a href="http://bower.io/search/?q=owner:arvindr21" onclick="__gaTracker('send', 'event', 'outbound-widget', 'http://bower.io/search/?q=owner:arvindr21', 'My Bower Packages');" target="_blank">My Bower Packages</a>
</li>
</ul></div>
</aside><aside id="latestseries-2" class="widget widget_latestseries"><h1 class="widget-title">Series</h1>			<ul>
<div class="latest-series"><ul><li><a href="/series/a-reminder-app/" class="series-145" title="Ionic, Twilio and Node Scheduler – A Reminder App">Ionic, Twilio and Node Scheduler – A Reminder App</a></li><li><a href="/series/node-webkit-apps/" class="series-150" title="Node Webkit Apps">Node Webkit Apps</a></li><li><a href="/series/rpi/" class="series-148" title="Raspberry Pi">Raspberry Pi</a></li></ul></div>			</ul>
</aside><aside id="text-4" class="widget widget_text"><h1 class="widget-title">Guest Posts</h1>			<div class="textwidget"><ul>
<li><a href="http://www.sitepoint.com/building-chat-app-node-webkit-firebase-angularjs/" onclick="__gaTracker('send', 'event', 'outbound-widget', 'http://www.sitepoint.com/building-chat-app-node-webkit-firebase-angularjs/', 'Building a Chat App with node-webkit, Firebase, and AngularJS');" target="_blank">Building a Chat App with node-webkit, Firebase, and AngularJS</a></li>
<li><a href="http://www.sitepoint.com/creating-sentiment-analysis-application-using-node-js/" onclick="__gaTracker('send', 'event', 'outbound-widget', 'http://www.sitepoint.com/creating-sentiment-analysis-application-using-node-js/', 'Creating a Sentiment Analysis Application Using Node.js');" target="_blank">Creating a Sentiment Analysis Application Using Node.js</a></li>
<li><a href="http://blog.mongodirector.com/implementing-pagination-with-mongodb-express-js-slush/" onclick="__gaTracker('send', 'event', 'outbound-widget', 'http://blog.mongodirector.com/implementing-pagination-with-mongodb-express-js-slush/', 'Implementing pagination with MongoDB, Express.js &amp; Slush');" target="_blank">Implementing pagination with MongoDB, Express.js & Slush</a></li>
<li><a href="http://www.sitepoint.com/creating-firebase-powered-end-end-ionic-application/" onclick="__gaTracker('send', 'event', 'outbound-widget', 'http://www.sitepoint.com/creating-firebase-powered-end-end-ionic-application/', 'Creating a Firebase Powered End to End Ionic Application');" target="_blank">Creating a Firebase Powered End to End Ionic Application</a></li>
<li><a href="http://blog.mongodirector.com/getting-started-with-mongodb-and-mongoose/" onclick="__gaTracker('send', 'event', 'outbound-widget', 'http://blog.mongodirector.com/getting-started-with-mongodb-and-mongoose/', 'Getting started with MongoDB and Mongoose');" target="_blank">Getting started with MongoDB and Mongoose</a></li>
<li><a href="http://blog.mongodirector.com/yeoman-mongoose-and-mongodb/" onclick="__gaTracker('send', 'event', 'outbound-widget', 'http://blog.mongodirector.com/yeoman-mongoose-and-mongodb/', 'Yeoman, Mongoose and MongoDB');" target="_blank">Yeoman, Mongoose and MongoDB</a></li>
</ul></div>
</aside><aside id="views-2" class="widget widget_views"><h1 class="widget-title">Top5 Posts</h1><ul>
<li><a href="/architecting-a-restful-node-js-app/"  title="Architecting a Secure RESTful Node.js app">Architecting a Secure RESTful Node.js app</a> - 215,397 views</li><li><a href="/getting-started-with-angular-2-0/"  title="Getting Started with Angular 2.0">Getting Started with Angular 2.0</a> - 177,588 views</li><li><a href="/developing-a-mean-app-with-angular-2-0/"  title="Developing a MEAN app with Angular 2.0">Developing a MEAN app with Angular 2.0</a> - 149,730 views</li><li><a href="/getting-started-with-node-webkit-apps/"  title="Node Webkit &ndash; Build Desktop Apps with Node and Web Technologies">Node Webkit &ndash; Build Desktop Apps with Node and Web Technologies</a> - 93,577 views</li><li><a href="/rpi-live-streaming/"  title="Raspberry Pi, Camera and Node.js &ndash; Live Streaming with Websockets #IoT">Raspberry Pi, Camera and Node.js &ndash; Live Streaming with Websockets #IoT</a> - 92,016 views</li></ul>
</aside>		<aside id="recent-posts-2" class="widget widget_recent_entries">		<h1 class="widget-title">Recent Posts</h1>		<ul>
<li>
<a href="/learning-ionic/">Learning Ionic</a>
</li>
<li>
<a href="/electron-wordpress-angular-material-an-offline-viewer/">Electron, WordPress &#038; Angular Material &#8211; An Offline Viewer</a>
</li>
<li>
<a href="/developing-a-mean-app-with-angular-2-0/">Developing a MEAN app with Angular 2.0</a>
</li>
<li>
<a href="/pushbots-and-cordova/">Pushbots and Cordova &#8211; Easy Push Notifications for your app</a>
</li>
<li>
<a href="/getting-started-with-client-side-storage/">Getting Started with Client Side Storage</a>
</li>
</ul>
</aside><aside id="categories-2" class="widget widget_categories"><h1 class="widget-title">Categories</h1>		<ul>
<li class="cat-item cat-item-141"><a href="/architecture/" >Architecture</a> (8)
</li>
<li class="cat-item cat-item-3"><a href="/css/" >CSS</a> (9)
<ul class='children'>
<li class="cat-item cat-item-5"><a href="/css/css3/" >CSS3</a> (6)
</li>
<li class="cat-item cat-item-26"><a href="/css/less/" >LESS</a> (3)
</li>
<li class="cat-item cat-item-55"><a href="/css/sass/" >SASS</a> (1)
</li>
</ul>
</li>
<li class="cat-item cat-item-117"><a href="/database/" >Database</a> (17)
<ul class='children'>
<li class="cat-item cat-item-136"><a href="/database/disk-db/" >Disk DB</a> (6)
</li>
<li class="cat-item cat-item-131"><a href="/database/firebase/" >Firebase</a> (4)
</li>
<li class="cat-item cat-item-118"><a href="/database/mongodb/" >MongoDB</a> (8)
<ul class='children'>
<li class="cat-item cat-item-119"><a href="/database/mongodb/mongolab/" >MongoLab</a> (3)
</li>
<li class="cat-item cat-item-123"><a href="/database/mongodb/monk/" >Monk</a> (1)
</li>
</ul>
</li>
</ul>
</li>
<li class="cat-item cat-item-125"><a href="/deployments/" >Deployments</a> (4)
<ul class='children'>
<li class="cat-item cat-item-126"><a href="/deployments/heroku/" >Heroku</a> (2)
</li>
</ul>
</li>
<li class="cat-item cat-item-135"><a href="/desktop-apps/" >Desktop Apps</a> (8)
</li>
<li class="cat-item cat-item-155"><a href="/dna-analysis/" >DNA Analysis</a> (1)
</li>
<li class="cat-item cat-item-112"><a href="/es6/" >ECMAScript 6</a> (3)
</li>
<li class="cat-item cat-item-162"><a href="/electron-atom-shell/" >Electron (atom shell)</a> (1)
</li>
<li class="cat-item cat-item-25"><a href="/frameworks/" >Frameworks</a> (42)
<ul class='children'>
<li class="cat-item cat-item-160"><a href="/frameworks/angular-2-0/" >Angular 2.0</a> (2)
</li>
<li class="cat-item cat-item-108"><a href="/frameworks/angularjs/" >Angularjs</a> (21)
</li>
<li class="cat-item cat-item-132"><a href="/frameworks/backbonejs/" >Backbonejs</a> (1)
</li>
<li class="cat-item cat-item-105"><a href="/frameworks/bootstrap/" >Bootstrap</a> (9)
</li>
<li class="cat-item cat-item-159"><a href="/frameworks/emberjs/" >Emberjs</a> (1)
</li>
<li class="cat-item cat-item-56"><a href="/frameworks/foundation/" >Foundation</a> (3)
</li>
<li class="cat-item cat-item-110"><a href="/frameworks/framework7/" >Framework7</a> (1)
</li>
<li class="cat-item cat-item-107"><a href="/frameworks/ionic/" >Ionic</a> (11)
</li>
<li class="cat-item cat-item-157"><a href="/frameworks/lumx/" >Lumx</a> (1)
</li>
<li class="cat-item cat-item-138"><a href="/frameworks/mean/" >MEAN</a> (4)
</li>
<li class="cat-item cat-item-116"><a href="/frameworks/meteorjs/" >Meteorjs</a> (1)
</li>
<li class="cat-item cat-item-122"><a href="/frameworks/onsen-ui/" >Onsen UI</a> (2)
</li>
</ul>
</li>
<li class="cat-item cat-item-101"><a href="/git/" >Git</a> (12)
<ul class='children'>
<li class="cat-item cat-item-102"><a href="/git/github/" >GitHub</a> (10)
</li>
</ul>
</li>
<li class="cat-item cat-item-2"><a href="/html/" >HTML</a> (22)
<ul class='children'>
<li class="cat-item cat-item-4"><a href="/html/html5/" >HTML5</a> (21)
<ul class='children'>
<li class="cat-item cat-item-158"><a href="/html/html5/webrtc/" >WebRTC</a> (1)
</li>
<li class="cat-item cat-item-106"><a href="/html/html5/websockets/" >WebSockets</a> (6)
</li>
</ul>
</li>
</ul>
</li>
<li class="cat-item cat-item-137"><a href="/intels-app-ui/" >Intel&#039;s App UI</a> (1)
</li>
<li class="cat-item cat-item-143"><a href="/iot/" >IoT</a> (6)
</li>
<li class="cat-item cat-item-1"><a href="/javascript/" >Javascript</a> (75)
<ul class='children'>
<li class="cat-item cat-item-6"><a href="/javascript/jquery/" >jQuery</a> (14)
</li>
</ul>
</li>
<li class="cat-item cat-item-151"><a href="/material-design/" >Material Design</a> (3)
</li>
<li class="cat-item cat-item-99"><a href="/mobile/" >Mobile</a> (21)
<ul class='children'>
<li class="cat-item cat-item-103"><a href="/mobile/android/" >Android</a> (15)
</li>
<li class="cat-item cat-item-113"><a href="/mobile/firefox-os/" >Firefox OS</a> (2)
</li>
<li class="cat-item cat-item-104"><a href="/mobile/ios/" >iOS</a> (11)
</li>
<li class="cat-item cat-item-100"><a href="/mobile/phonegap/" >PhoneGap</a> (16)
</li>
</ul>
</li>
<li class="cat-item cat-item-149"><a href="/mqtt/" >MQTT</a> (1)
</li>
<li class="cat-item cat-item-163"><a href="/my-books/" >My Books</a> (1)
</li>
<li class="cat-item cat-item-45"><a href="/node/" >Node</a> (60)
<ul class='children'>
<li class="cat-item cat-item-152"><a href="/node/cli/" >CLI</a> (3)
</li>
<li class="cat-item cat-item-121"><a href="/node/expressjs/" >Expressjs</a> (18)
</li>
<li class="cat-item cat-item-156"><a href="/node/genome/" >Genome</a> (1)
</li>
<li class="cat-item cat-item-62"><a href="/node/grunt/" >Grunt</a> (8)
</li>
<li class="cat-item cat-item-124"><a href="/node/koa/" >Koa</a> (1)
</li>
<li class="cat-item cat-item-134"><a href="/node/node-webkit/" >Node Webkit</a> (7)
</li>
<li class="cat-item cat-item-54"><a href="/node/npm/" >NPM</a> (15)
</li>
<li class="cat-item cat-item-120"><a href="/node/restify/" >Restify</a> (3)
</li>
</ul>
</li>
<li class="cat-item cat-item-161"><a href="/push-notifications/" >Push Notifications</a> (1)
</li>
<li class="cat-item cat-item-59"><a href="/quick-and-dirty/" >Quick and Dirty</a> (42)
</li>
<li class="cat-item cat-item-142"><a href="/raspberry-pi/" >Raspberry Pi</a> (9)
</li>
<li class="cat-item cat-item-60"><a href="/setup/" >Setup</a> (60)
</li>
<li class="cat-item cat-item-61"><a href="/testing/" >Testing</a> (5)
<ul class='children'>
<li class="cat-item cat-item-129"><a href="/testing/jasmine/" >Jasmine</a> (1)
</li>
<li class="cat-item cat-item-128"><a href="/testing/protractor/" >Protractor</a> (1)
</li>
<li class="cat-item cat-item-98"><a href="/testing/test-automation/" >Test Automation</a> (1)
</li>
<li class="cat-item cat-item-41"><a href="/testing/tdd/" >Test Driven Developement</a> (2)
</li>
</ul>
</li>
<li class="cat-item cat-item-139"><a href="/third-party-products/" >Third Party Products</a> (4)
<ul class='children'>
<li class="cat-item cat-item-140"><a href="/third-party-products/twilio/" >Twilio</a> (4)
</li>
</ul>
</li>
<li class="cat-item cat-item-58"><a href="/tutorial/" >Tutorial</a> (79)
</li>
<li class="cat-item cat-item-130"><a href="/performance-analysis/" >UI Performance</a> (1)
</li>
<li class="cat-item cat-item-109"><a href="/web-components/" >Web Components</a> (3)
</li>
<li class="cat-item cat-item-133"><a href="/google-web-starter-kit/" >Web Starter Kit</a> (1)
</li>
</ul>
</aside><aside id="archives-2" class="widget widget_archive"><h1 class="widget-title">Archives</h1>		<ul>
<li><a href='/2015/07/'>July 2015</a></li>
<li><a href='/2015/05/'>May 2015</a></li>
<li><a href='/2015/04/'>April 2015</a></li>
<li><a href='/2015/03/'>March 2015</a></li>
<li><a href='/2015/02/'>February 2015</a></li>
<li><a href='/2015/01/'>January 2015</a></li>
<li><a href='/2014/12/'>December 2014</a></li>
<li><a href='/2014/11/'>November 2014</a></li>
<li><a href='/2014/10/'>October 2014</a></li>
<li><a href='/2014/09/'>September 2014</a></li>
<li><a href='/2014/08/'>August 2014</a></li>
<li><a href='/2014/07/'>July 2014</a></li>
<li><a href='/2014/06/'>June 2014</a></li>
<li><a href='/2014/05/'>May 2014</a></li>
<li><a href='/2014/04/'>April 2014</a></li>
<li><a href='/2014/03/'>March 2014</a></li>
<li><a href='/2014/02/'>February 2014</a></li>
</ul>
</aside><aside id="wysija-3" class="widget widget_wysija"><h1 class="widget-title">Inform me about new posts</h1><div class="widget_wysija_cont"><div id="msg-form-wysija-3" class="wysija-msg ajax"></div><form id="form-wysija-3" method="post" action="#wysija" class="widget_wysija">
<p class="wysija-paragraph">
<label>Email <span class="wysija-required">*</span></label>
<input type="text" name="wysija[user][email]" class="wysija-input validate[required,custom[email]]" title="Email"  value="" />
<span class="abs-req">
<input type="text" name="wysija[user][abs][email]" class="wysija-input validated[abs][email]" value="" />
</span>
</p>
<input class="wysija-submit wysija-submit-field" type="submit" value="Subscribe!" />
<input type="hidden" name="form_id" value="1" />
<input type="hidden" name="action" value="save" />
<input type="hidden" name="controller" value="subscribers" />
<input type="hidden" value="1" name="wysija-page" />
<input type="hidden" name="wysija[user_list][list_ids]" value="3" />
</form></div></aside>	</div><!-- #secondary -->
	<script>
var _prum = [['id', '544090ababe53d0e3e76d6ce'],
['mark', 'firstbyte', (new Date()).getTime()]];
(function() {
var s = document.getElementsByTagName('script')[0]
, p = document.createElement('script');
p.async = 'async';
p.src = '//rum-static.pingdom.net/prum.min.js';
s.parentNode.insertBefore(p, s);
})();
</script>
</div><!-- #content -->
<footer id="colophon" class="site-footer" role="contentinfo">
<div class="site-info">
All Rights Reserved
<span class="sep"> | </span>
The Jackal of Javascript
</div><!-- .site-info -->
<div class="rnd-circle" style="background: black;width: 10px;height: 10px;border-radius: 50%;"></div>
</footer><!-- #colophon -->
</div><!-- #page -->
<script type='text/javascript'><!--
var seriesdropdown = document.getElementById("orgseries_dropdown");
if (seriesdropdown) {
function onSeriesChange() {
if ( seriesdropdown.options[seriesdropdown.selectedIndex].value != ( 0 || -1 ) ) {
location.href = "/series/"+seriesdropdown.options[seriesdropdown.selectedIndex].value;
}
}
seriesdropdown.onchange = onSeriesChange;
}
--></script>
<script type="text/javascript">
// <![CDATA[
var disqus_shortname = 'thejackalofjavascriptcom';
(function () {
var nodes = document.getElementsByTagName('span');
for (var i = 0, url; i < nodes.length; i++) {
if (nodes[i].className.indexOf('dsq-postid') != -1) {
nodes[i].parentNode.setAttribute('data-disqus-identifier', nodes[i].getAttribute('data-dsqidentifier'));
url = nodes[i].parentNode.href.split('#', 1);
if (url.length == 1) { url = url[0]; }
else { url = url[1]; }
nodes[i].parentNode.href = url + '#disqus_thread';
}
}
var s = document.createElement('script'); 
s.async = true;
s.type = 'text/javascript';
s.src = '//' + disqus_shortname + '.disqus.com/count.js';
(document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
}());
// ]]>
</script>
<div class="scroll-back-to-top-wrapper">
<span class="scroll-back-to-top-inner">
<i class="fa fa-2x fa-arrow-circle-up"></i>
</span>
</div>
<style type="text/css">
#wpfront-notification-bar 
{
background: #242d36;
background: -moz-linear-gradient(top, #242d36 0%, #242d36 100%);
background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,#242d36), color-stop(100%,#242d36));
background: -webkit-linear-gradient(top, #242d36 0%,#242d36 100%);
background: -o-linear-gradient(top, #242d36 0%,#242d36 100%);
background: -ms-linear-gradient(top, #242d36 0%,#242d36 100%);
background: linear-gradient(to bottom, #242d36 0%, #242d36 100%);
filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#242d36', endColorstr='#242d36',GradientType=0 );
}
#wpfront-notification-bar div.wpfront-message
{
color: #ffffff;
}
#wpfront-notification-bar a.wpfront-button
{
background: #f45145;
background: -moz-linear-gradient(top, #f45145 0%, #f45145 100%);
background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,#f45145), color-stop(100%,#f45145));
background: -webkit-linear-gradient(top, #f45145 0%,#f45145 100%);
background: -o-linear-gradient(top, #f45145 0%,#f45145 100%);
background: -ms-linear-gradient(top, #f45145 0%,#f45145 100%);
background: linear-gradient(to bottom, #f45145 0%, #f45145 100%);
filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#f45145', endColorstr='#f45145',GradientType=0 );
color: #ffffff;
}
#wpfront-notification-bar-open-button
{
background-color: #00b7ea;
}
#wpfront-notification-bar  div.wpfront-close 
{
border: 1px solid #555555;
background-color: #555555;
color: #000000;
}
#wpfront-notification-bar  div.wpfront-close:hover 
{
border: 1px solid #aaaaaa;
background-color: #aaaaaa;
}
</style>
<div id="wpfront-notification-bar-spacer"  style="display: none;">
<div id="wpfront-notification-bar-open-button" class="top wpfront-bottom-shadow"></div>
<div id="wpfront-notification-bar" class="wpfront-fixed">
<div class="wpfront-close">X</div>
<table border="0" cellspacing="0" cellpadding="0">
<tr>
<td>
<div class="wpfront-message">
Interested in building IoT Solutions using only JavaScript?<br>Checkout my new book:                    </div>
<div>
<a class="wpfront-button" href="https://www.packtpub.com/hardware-and-creative/advanced-iot-javascript"  target="_blank" >Advanced IoT with JavaScript</a>
</div>
</td>
</tr>
</table>
</div>
</div>
<style type="text/css">
#wpfront-notification-bar  div{display:inline;}</style>
<script type="text/javascript">if(typeof wpfront_notification_bar == "function") wpfront_notification_bar({"position":1,"height":0,"fixed_position":"on","animate_delay":0.5,"close_button":true,"button_action_close_bar":false,"auto_close_after":0,"display_after":1,"is_admin_bar_showing":false,"display_open_button":false,"keep_closed":"on","keep_closed_for":1,"position_offset":0,"display_scroll":"on","display_scroll_offset":100});</script><script type='text/javascript' src='/wp-content/plugins/jetpack/modules/photon/photon.js'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var scrollBackToTop = {"scrollDuration":"500","fadeDuration":"0.5"};
/* ]]> */
</script>
<script type='text/javascript' src='/wp-content/plugins/scroll-back-to-top/assets/js/scroll-back-to-top.js'></script>
<script type='text/javascript' src='/wp-content/plugins/simple-share-buttons-adder/js/ssba.min.js'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var viewsCacheL10n = {"admin_ajax_url":"\/wp-admin\/admin-ajax.php","post_id":"2330"};
/* ]]> */
</script>
<script type='text/javascript' src='/wp-content/plugins/wp-postviews/postviews-cache.js'></script>
<script type='text/javascript' src='http://s0.wp.com/wp-content/js/devicepx-jetpack.js'></script>
<script type='text/javascript' src='/wp-content/themes/sorbet/js/menus.js'></script>
<script type='text/javascript' src='/wp-content/themes/sorbet/js/skip-link-focus-fix.js'></script>
<script type='text/javascript' src='/wp-includes/js/comment-reply.min.js'></script>
<script type='text/javascript' src='/wp-content/plugins/lazy-load/js/jquery.sonar.min.js'></script>
<script type='text/javascript' src='/wp-content/plugins/lazy-load/js/lazy-load.js'></script>
<script type='text/javascript' src='/wp-content/plugins/jetpack/_inc/postmessage.js'></script>
<script type='text/javascript' src='/wp-content/plugins/jetpack/_inc/jquery.jetpack-resize.js'></script>
<script type='text/javascript' src='/wp-content/plugins/jetpack/_inc/jquery.inview.js'></script>
<script type='text/javascript' src='/wp-content/plugins/jetpack/modules/likes/queuehandler.js'></script>
<script type='text/javascript' src='/wp-content/plugins/wysija-newsletters/js/validate/languages/jquery.validationEngine-en.js'></script>
<script type='text/javascript' src='/wp-content/plugins/wysija-newsletters/js/validate/jquery.validationEngine.js'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wysijaAJAX = {"action":"wysija_ajax","controller":"subscribers","ajaxurl":"\/wp-admin\/admin-ajax.php","loadingTrans":"Loading...","is_rtl":""};
var wysijaAJAX = {"action":"wysija_ajax","controller":"subscribers","ajaxurl":"\/wp-admin\/admin-ajax.php","loadingTrans":"Loading...","is_rtl":""};
/* ]]> */
</script>
<script type='text/javascript' src='/wp-content/plugins/wysija-newsletters/js/front-subscribers.js'></script>
<iframe src='http://widgets.wp.com/likes/master.html?ver=20141028#ver=20141028' scrolling='no' id='likes-master' name='likes-master' style='display:none;'></iframe>
<div id='likes-other-gravatars'><div class="likes-text"><span>%d</span> bloggers like this:</div><ul class="wpl-avatars sd-like-gravatars"></ul></div>
<script type="text/javascript">
jQuery.noConflict();
(function( $ ) {
$(function() {
// More code using $ as alias to jQuery
$("area[href*=#],a[href*=#]:not([href=#]):not([href^='#tab']):not([href^='#quicktab']):not([href^='#pane'])").click(function() {
if (location.pathname.replace(/^\//,'') == this.pathname.replace(/^\//,'') && location.hostname == this.hostname) {
var target = $(this.hash);
target = target.length ? target : $('[name=' + this.hash.slice(1) +']');
if (target.length) {
$('html,body').animate({
scrollTop: target.offset().top - 20  
},900 ,'easeOutQuint');
return false;
}
}
});
});
})(jQuery);	
</script>				
<script type='text/javascript' src='http://stats.wp.com/e-201746.js' async defer></script>
<script type='text/javascript'>
_stq = window._stq || [];
_stq.push([ 'view', {v:'ext',j:'1:3.7',blog:'70838519',post:'2330',tz:'5.5',srv:'thejackalofjavascript.com'} ]);
_stq.push([ 'clickTrackerInit', '70838519', '2330' ]);
</script>
<div id="upprev_box"><h6>Read previous post:</h6><div class="upprev_excerpt"><h5><a href="/rpi-pir-sensor-node-iot-intruder-alert/" rel="Getting started with MQTT">Raspberry pi, PIR Sensor and Node.js &#8211; An IoT Intruder Alert system</a></h5><p>In this post, we will build an Internet of Things Intruder alert system. This system uses a PIR Sensor along...</p></div><a id="upprev_close" href="#" rel="close">Close</a></div><script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-47881846-1', 'auto');
ga('send', 'pageview');
</script>
<a style="display:none;" href="http://www.alexa.com/siteinfo//"><script type="text/javascript" src="http://xslt.alexa.com/site_stats/js/t/a?url=/"></script></a>
</body>
</html><script>if(document.getElementById('to-contents') == null){ } else {var a = document.getElementById('to-contents').getElementsByTagName('a'); for(var i=0; i< a.length;i++){var b = a[i].getAttribute('href').split('#');if(b.length >=2)a[i].setAttribute('href', '#'+b[1]);}}</script>
<script>if(typeof jQuery == 'function'){jQuery('.widgetGuts.shortcode h3').html('Inform Me About New Posts')}</script><!-- WP Fastest Cache file was created in 3.18236303329 seconds, on 19-11-17 3:41:06 -->