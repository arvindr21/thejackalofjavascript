<!DOCTYPE html>
<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="alexaVerifyID" content="tHZTfJpU56tqERN4vjth74jHqBM"/>
<link rel="profile" href="http://gmpg.org/xfn/11">
<link rel="pingback" href="./xmlrpc.php">
<!-- <link href='http://fonts.googleapis.com/css?family=Exo+2' rel='stylesheet' type='text/css'> -->
<link rel="shortcut icon" href="./wp-content/uploads/2014/02/favicon.ico" type="image/x-icon">
<meta name="keywords" content="Javascript, HTML5, CSS3, ES6, Ecmascript, Hybrid Apps, Mobile Web Development, Desktop Apps, Apps, Arvind R, Arvind Ravulavaru, The Jackal of Javascript">
<link rel="icon" href="./wp-content/uploads/2014/02/favicon.ico" type="image/x-icon">
<!-- <link href='http://fonts.googleapis.com/css?family=Open+Sans:400italic,400,600' rel='stylesheet' type='text/css'> -->
<link rel="stylesheet" type="text/css" href="./wp-content/cache/wpfc-minified/61cc3c87f2aa625d55d3026ecc452e96/1511014149index.css" media="all"/>
<!-- Performance scores of this site is tuned by WP Performance Score Booster plugin v1.5 - http://wordpress.org/plugins/wp-performance-score-booster -->
<!-- Jetpack Site Verification Tags -->
<meta name="google-site-verification" content="1QBi99oBZzn4xisTyRUgPd4BXjQ-6Tu09iK6V_bviIY" />
<meta name="msvalidate.01" content="33E048D3C4E943B6450230EA909E12C6" />
<meta name="p:domain_verify" content="662a829c1b5ccc13015f1cc5d00ec7e4" />
<!-- This site is optimized with the Yoast SEO plugin v3.1 - https://yoast.com/wordpress/plugins/seo/ -->
<title>Architecting a Secure RESTful Node.js app | The Jackal of Javascript</title>
<meta name="description" content="Architecting a Secure RESTful Node.js app In this post, we will take a look at architecting a Node.js app that will act as a REST API server for all of our"/>
<meta name="robots" content="noodp"/>
<link rel="canonical" href="./index.html" />
<link rel="publisher" href="https://plus.google.com/ArvindRavulavaru"/>
<meta property="og:locale" content="en_US" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Architecting a Secure RESTful Node.js app | The Jackal of Javascript" />
<meta property="og:description" content="Architecting a Secure RESTful Node.js app In this post, we will take a look at architecting a Node.js app that will act as a REST API server for all of our" />
<meta property="og:url" content="./architecting-a-restful-node-js-app/" />
<meta property="og:site_name" content="The Jackal of Javascript" />
<meta property="article:publisher" content="https://www.facebook.com/arvindravulavaru" />
<meta property="article:section" content="Angularjs" />
<meta property="article:published_time" content="2014-09-22T09:38:15+05:30" />
<meta property="article:modified_time" content="2014-10-01T10:32:56+05:30" />
<meta property="og:updated_time" content="2014-10-01T10:32:56+05:30" />
<meta property="og:image" content="./wp-content/uploads/2014/09/minimal-341x300.png" />
<meta property="og:image" content="./wp-content/uploads/2014/09/Screen-Shot-2014-09-21-at-11.25.11-pm.png" />
<meta property="og:image" content="./wp-content/uploads/2014/09/Screen-Shot-2014-09-21-at-11.30.01-pm-451x38.png" />
<meta property="og:image" content="./wp-content/uploads/2014/09/Screen-Shot-2014-09-21-at-11.35.18-pm-451x29.png" />
<meta property="og:image" content="./wp-content/uploads/2014/09/Screen-Shot-2014-09-21-at-11.37.08-pm-451x30.png" />
<meta property="og:image" content="./wp-content/uploads/2014/09/Screen-Shot-2014-09-21-at-11.40.59-pm-451x29.png" />
<meta property="og:image" content="./wp-content/uploads/2014/09/Screen-Shot-2014-09-22-at-9.02.40-am-451x104.png" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:description" content="Architecting a Secure RESTful Node.js app In this post, we will take a look at architecting a Node.js app that will act as a REST API server for all of our" />
<meta name="twitter:title" content="Architecting a Secure RESTful Node.js app | The Jackal of Javascript" />
<meta name="twitter:site" content="@arvindr21" />
<meta name="twitter:image" content="./wp-content/uploads/2014/09/minimal-341x300.png" />
<meta name="twitter:creator" content="@arvindr21" />
<!-- / Yoast SEO plugin. -->
<script type="text/javascript">
window._wpemojiSettings = {"baseUrl":"http:\/\/s.w.org\/images\/core\/emoji\/72x72\/","ext":".png","source":{"concatemoji":".\/wp-includes\/js\/wp-emoji-release.min.js"}};
!function(a,b,c){function d(a){var c=b.createElement("canvas"),d=c.getContext&&c.getContext("2d");return d&&d.fillText?(d.textBaseline="top",d.font="600 32px Arial","flag"===a?(d.fillText(String.fromCharCode(55356,56812,55356,56807),0,0),c.toDataURL().length>3e3):(d.fillText(String.fromCharCode(55357,56835),0,0),0!==d.getImageData(16,16,1,1).data[0])):!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g;c.supports={simple:d("simple"),flag:d("flag")},c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.simple&&c.supports.flag||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
</script>
<style type="text/css">
img.wp-smiley,
img.emoji {
display: inline !important;
border: none !important;
box-shadow: none !important;
height: 1em !important;
width: 1em !important;
margin: 0 .07em !important;
vertical-align: -0.1em !important;
background: none !important;
padding: 0 !important;
}
</style>
<!-- <link rel='stylesheet' id='savrix-style.css-css'  href='./wp-content/plugins/savrix-android-market/savrix-style-only-play.css' type='text/css' media='all' /> -->
<!-- <link rel='stylesheet' id='validate-engine-css-css'  href='./wp-content/plugins/wysija-newsletters/css/validationEngine.jquery.css' type='text/css' media='all' /> -->
<!-- <link rel='stylesheet' id='crayon-css'  href='./wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css' type='text/css' media='all' /> -->
<!-- <link rel='stylesheet' id='crayon-theme-arduino-ide-css'  href='./wp-content/plugins/crayon-syntax-highlighter/themes/arduino-ide/arduino-ide.css' type='text/css' media='all' /> -->
<!-- <link rel='stylesheet' id='crayon-font-droid-sans-mono-css'  href='./wp-content/plugins/crayon-syntax-highlighter/fonts/droid-sans-mono.css' type='text/css' media='all' /> -->
<!-- <link rel='stylesheet' id='orgseries-default-css-css'  href='./wp-content/plugins/organize-series/orgSeries.css' type='text/css' media='all' /> -->
<!-- <link rel='stylesheet' id='responsive-lightbox-prettyphoto-css'  href='./wp-content/plugins/responsive-lightbox/assets/prettyphoto/css/prettyPhoto.css' type='text/css' media='all' /> -->
<link rel="stylesheet" type="text/css" href="./wp-content/cache/wpfc-minified/9f9f3b5f286a1b327e6bb0fdb1185c24/1511014149index.css" media="all"/>
<link rel='stylesheet' id='font-awesome-css'  href='//netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.css' type='text/css' media='screen' />
<!-- <link rel='stylesheet' id='ssbaFont-css'  href='//fonts.googleapis.com/css?family=Indie+Flower&#038;ver=4.2.16' type='text/css' media='all' /> -->
<!-- <link rel='stylesheet' id='wpfront-notification-bar-css'  href='./wp-content/plugins/wpfront-notification-bar/css/wpfront-notification-bar.css' type='text/css' media='all' /> -->
<!-- <link rel='stylesheet' id='sorbet-style-css'  href='./wp-content/themes/sorbet/style.css' type='text/css' media='all' /> -->
<!-- <link rel='stylesheet' id='sorbet-source-sans-pro-css'  href='http://fonts.googleapis.com/css?family=Source+Sans+Pro%3A300%2C400%2C700%2C300italic%2C400italic%2C700italic&#038;subset=latin%2Clatin-ext&#038;ver=4.2.16' type='text/css' media='all' /> -->
<!-- <link rel='stylesheet' id='sorbet-pt-serif-css'  href='http://fonts.googleapis.com/css?family=PT+Serif%3A400%2C700%2C400italic%2C700italic&#038;subset=latin%2Clatin-ext&#038;ver=4.2.16' type='text/css' media='all' /> -->
<!-- <link rel='stylesheet' id='sorbet-genericons-css'  href='./wp-content/themes/sorbet/genericons/genericons.css' type='text/css' media='all' /> -->
<!-- <link rel='stylesheet' id='easy_table_style-css'  href='./wp-content/plugins/easy-table/themes/default/style.css' type='text/css' media='all' /> -->
<!-- <link rel='stylesheet' id='upprev-css-css'  href='./wp-content/plugins/upprev/styles/upprev.css' type='text/css' media='all' /> -->
<!-- <link rel='stylesheet' id='jetpack_css-css'  href='./wp-content/plugins/jetpack/css/jetpack.css' type='text/css' media='all' /> -->
<link rel="stylesheet" type="text/css" href="./wp-content/cache/wpfc-minified/3af13bcd925b3eaa358c8ad5070bb07b/1511014148index.css" media="all"/>
<!-- This site uses the Google Analytics by Yoast plugin v5.4.6 - Universal enabled - https://yoast.com/wordpress/plugins/google-analytics/ -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','__gaTracker');
__gaTracker('create', 'UA-47881846-1', 'auto');
__gaTracker('set', 'forceSSL', true);
__gaTracker('require', 'displayfeatures');
__gaTracker('send','pageview');
</script>
<!-- / Google Analytics by Yoast -->
<script type="text/javascript">
var iworks_upprev = { animation: 'flyout', position: 'right', offset_percent: 75, offset_element: '#comments', css_width: 360, css_side: 5, compare: 'simple', url_new_window: 0, ga_track_views: 1, ga_track_clicks: 1, ga_opt_noninteraction: 1, title: 'Architecting a Secure RESTful Node.js app' };
</script>
<script src='./wp-content/cache/wpfc-minified/1f21a7a8ca343ebb57ffeb4ab24afbd9/1511014152index.js' type="text/javascript"></script>
<!-- <script type='text/javascript' src='./wp-includes/js/jquery/jquery.js'></script> -->
<!-- <script type='text/javascript' src='./wp-includes/js/jquery/jquery-migrate.min.js'></script> -->
<!-- <script type='text/javascript' src='./wp-content/plugins/jetpack/modules/related-posts/related-posts.js'></script> -->
<script type='text/javascript'>
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":".\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script src='./wp-content/cache/wpfc-minified/052c748258385b6c23fc6642e73a4285/1511014152index.js' type="text/javascript"></script>
<!-- <script type='text/javascript' src='./wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js'></script> -->
<!-- <script type='text/javascript' src='./wp-content/plugins/responsive-lightbox/assets/prettyphoto/js/jquery.prettyPhoto.js'></script> -->
<script type='text/javascript'>
/* <![CDATA[ */
var rlArgs = {"script":"prettyphoto","selector":"lightbox","customEvents":"","activeGalleries":"1","animationSpeed":"normal","slideshow":"0","slideshowDelay":"5000","slideshowAutoplay":"0","opacity":"0.75","showTitle":"1","allowResize":"1","allowExpand":"1","width":"1080","height":"720","separator":"\/","theme":"pp_default","horizontalPadding":"20","hideFlash":"0","wmode":"opaque","videoAutoplay":"0","modal":"0","deeplinking":"0","overlayGallery":"1","keyboardShortcuts":"1","social":"0"};
/* ]]> */
</script>
<script src='./wp-content/cache/wpfc-minified/d57c91500961bea5aea0e849cf08f7e7/1511014151index.js' type="text/javascript"></script>
<!-- <script type='text/javascript' src='./wp-content/plugins/responsive-lightbox/js/front.js'></script> -->
<!-- <script type='text/javascript' src='./wp-content/plugins/wpfront-notification-bar/jquery-plugins/jquery.c.js'></script> -->
<!-- <script type='text/javascript' src='./wp-content/plugins/wpfront-notification-bar/js/wpfront-notification-bar.js'></script> -->
<!-- <script type='text/javascript' src='./wp-content/plugins/upprev/scripts/upprev.js'></script> -->
<script type='text/javascript' src='//cdnjs.cloudflare.com/ajax/libs/jquery-easing/1.3/jquery.easing.min.js'></script>
<meta name="generator" content="WordPress 4.2.16" />
<style>
.scroll-back-to-top-wrapper {
position: fixed;
opacity: 0;
visibility: hidden;
overflow: hidden;
text-align: center;
z-index: 99999999;
background-color: #777777;
color: #eeeeee;
width: 50px;
height: 48px;
line-height: 48px;
right: 30px;
bottom: 30px;
padding-top: 2px;
border-top-left-radius: 10px;
border-top-right-radius: 10px;
border-bottom-right-radius: 10px;
border-bottom-left-radius: 10px;
-webkit-transition: all 0.5s ease-in-out;
-moz-transition: all 0.5s ease-in-out;
-ms-transition: all 0.5s ease-in-out;
-o-transition: all 0.5s ease-in-out;
transition: all 0.5s ease-in-out;
}
.scroll-back-to-top-wrapper:hover {
background-color: #888888;
color: #eeeeee;
}
.scroll-back-to-top-wrapper.show {
visibility:visible;
cursor:pointer;
opacity: 1.0;
}
.scroll-back-to-top-wrapper i.fa {
line-height: inherit;
}
.scroll-back-to-top-wrapper .fa-lg {
vertical-align: 0;
}
</style><style type="text/css">	.ssba {
}
.ssba img
{
width: 35px !important;
padding: 6px;
border:  0;
box-shadow: none !important;
display: inline !important;
vertical-align: middle;
}
.ssba, .ssba a
{
text-decoration:none;
border:0;
background: none;
font-family: Indie Flower;
font-size: 	20px;
}.ssba_sharecount:after, .ssba_sharecount:before {
right: 100%;
border: solid transparent;
content: " ";
height: 0;
width: 0;
position: absolute;
pointer-events: none;
}
.ssba_sharecount:after {
border-color: rgba(224, 221, 221, 0);
border-right-color: #f5f5f5;
border-width: 5px;
top: 50%;
margin-top: -5px;
}
.ssba_sharecount:before {
border-color: rgba(85, 94, 88, 0);
border-right-color: #e0dddd;
border-width: 6px;
top: 50%;
margin-top: -6px;
}
.ssba_sharecount {
font: 11px Arial, Helvetica, sans-serif;
padding: 5px;
-khtml-border-radius: 6px;
-o-border-radius: 6px;
-webkit-border-radius: 6px;
-moz-border-radius: 6px;
border-radius: 6px;
position: relative;
border: 1px solid #e0dddd;color: #555e58;
background: #ffffff;
}
.ssba_sharecount:after {
border-right-color: #ffffff;
}</style><style id="popup-maker-themes"  type="text/css">/* Popup Theme 2995: Default Theme */
.popmake-overlay.theme-2995, .popmake-overlay.theme-default-theme { background-color: rgba( 255, 255, 255, 1 ) } 
.popmake.theme-2995, .popmake.theme-default-theme { padding: 18px; border-radius: 0px; border: 1px none #000000; box-shadow: 1px 1px 3px 0px rgba( 2, 2, 2, 0.23 ); background-color: rgba( 249, 249, 249, 1 ) } 
.popmake.theme-2995 .popmake-title, .popmake.theme-default-theme .popmake-title { color: #000000; text-align: left; text-shadow: 0px 0px 0px rgba( 2, 2, 2, 0.23 ); font-family: inherit; font-weight: inherit; font-size: 32px; font-style: normal; line-height: 36px } 
.popmake.theme-2995 .popmake-content, .popmake.theme-default-theme .popmake-content { color: #8c8c8c; font-family: inherit; font-weight: inherit; font-style: normal } 
.popmake.theme-2995 > .popmake-close, .popmake.theme-default-theme > .popmake-close { height: 20px; width: 20px; left: auto; right: 0px; bottom: auto; top: 0px; padding: 8px; color: #ffffff; font-family: inherit; font-weight: inherit; font-size: 12px; font-style: normal; line-height: 14px; border: 1px none #ffffff; border-radius: 0px; box-shadow: 0px 0px 0px 0px rgba( 2, 2, 2, 0.23 ); text-shadow: 0px 0px 0px rgba( 0, 0, 0, 0.23 ); background-color: rgba( 0, 183, 205, 1 ) } 
</style>
<link rel='dns-prefetch' href='//i0.wp.com'>
<link rel='dns-prefetch' href='//i1.wp.com'>
<link rel='dns-prefetch' href='//i2.wp.com'>
<link rel='dns-prefetch' href='//widgets.wp.com'>
<link rel='dns-prefetch' href='//s0.wp.com'>
<link rel='dns-prefetch' href='//0.gravatar.com'>
<link rel='dns-prefetch' href='//1.gravatar.com'>
<link rel='dns-prefetch' href='//2.gravatar.com'>
<style type="text/css">
#upprev_box{bottom:5px;width:360px;right:5px;display:block;right:-415px;display:block;}
</style>
</head>
<body class="single single-post postid-2043 single-format-standard right-sidebar">
<div id="page" class="hfeed site">
<header id="masthead" class="site-header" role="banner">
<div class="site-header-wrapper">
<div class="site-branding">
<h1 class="site-title"><a href="./index.html" rel="home">The Jackal of Javascript</a></h1>
<h2 class="site-description">Knowing is different &amp; Doing is different</h2>
</div>
<div class="toggles">
<div id="menu-toggle" class="toggle active" title="Menu"><span class="screen-reader-text">Menu</span></div>
<div id="search-toggle" class="toggle" title="Search"><span class="screen-reader-text">Search</span></div>
</div>
</div>
</header><!-- #masthead -->
<div id="menu-toggle-nav" class="panel">
<nav id="site-navigation" class="main-navigation" role="navigation">
<a class="skip-link screen-reader-text" href="#content">Skip to content</a>
<div class="menu-main-container"><ul id="menu-main" class="menu"><li id="menu-item-2579" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-2579"><a href="./index.html">Home</a></li>
<li id="menu-item-2595" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-2595"><a href="./portfolio/index.html">About  me</a></li>
<li id="menu-item-2580" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2580"><a href="./history-of-the-web/index.html">History of the Web</a></li>
<li id="menu-item-2726" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2726"><a href="./javascript-101/index.html">Javascript 101</a></li>
<li id="menu-item-2581" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2581"><a href="./contact-request/index.html">Request</a></li>
</ul></div>		</nav><!-- #site-navigation -->
</div>
<div id="search-toggle-nav" class="panel">
<div class="search-wrapper">
<form role="search" method="get" class="search-form" action="./index.html">
<label>
<span class="screen-reader-text">Search for:</span>
<input type="search" class="search-field" placeholder="Search &hellip;" value="" name="s">
</label>
<input type="submit" class="search-submit" value="Search">
</form>
</div>
</div>
<div id="content" class="site-content">
<div id="primary" class="content-area">
<main id="main" class="site-main" role="main">
<article id="post-2043" class="post-2043 post type-post status-publish format-standard hentry category-angularjs category-architecture category-expressjs category-javascript category-node category-npm category-setup category-tutorial">
<header class="entry-header">
<h1 class="entry-title">Architecting a Secure RESTful Node.js app</h1>	</header><!-- .entry-header -->
<div class="entry-content">
<!-- Simple Share Buttons Adder (6.1.5) simplesharebuttons.com --><div class="ssba ssba-wrap"><div style="text-align:left"><a href="http://twitter.com/share?url=./architecting-a-restful-node-js-app/&amp;text=Architecting+a+Secure+RESTful+Node.js+app+From+The+Jackal+of+Javascript+by+%40arvindr21" onclick="__gaTracker('send', 'event', 'outbound-article', 'http://twitter.com/share?url=./architecting-a-restful-node-js-app/&amp;text=Architecting+a+Secure+RESTful+Node.js+app+From+The+Jackal+of+Javascript+by+%40arvindr21', '');" data-site="" class="ssba_twitter_share"   target="_blank"  rel="nofollow"><img src="http://i0.wp.com/thejackalofjavascript.com/wp-content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="http://i2.wp.com/thejackalofjavascript.com/wp-content/plugins/simple-share-buttons-adder/buttons/somacro/twitter.png?w=646" title="Twitter" class="ssba ssba-img" alt="Tweet about this on Twitter" data-recalc-dims="1" /><noscript><img src="http://i2.wp.com/thejackalofjavascript.com/wp-content/plugins/simple-share-buttons-adder/buttons/somacro/twitter.png?w=646" title="Twitter" class="ssba ssba-img" alt="Tweet about this on Twitter" data-recalc-dims="1" /></noscript></a><a href="http://www.linkedin.com/shareArticle?mini=true&amp;url=./architecting-a-restful-node-js-app/" onclick="__gaTracker('send', 'event', 'outbound-article', 'http://www.linkedin.com/shareArticle?mini=true&amp;url=./architecting-a-restful-node-js-app/', '');" data-site="linkedin" class="ssba_linkedin_share ssba_share_link"   target="_blank"  rel="nofollow"><img src="http://i0.wp.com/thejackalofjavascript.com/wp-content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="http://i1.wp.com/thejackalofjavascript.com/wp-content/plugins/simple-share-buttons-adder/buttons/somacro/linkedin.png?w=646" title="LinkedIn" class="ssba ssba-img" alt="Share on LinkedIn" data-recalc-dims="1" /><noscript><img src="http://i1.wp.com/thejackalofjavascript.com/wp-content/plugins/simple-share-buttons-adder/buttons/somacro/linkedin.png?w=646" title="LinkedIn" class="ssba ssba-img" alt="Share on LinkedIn" data-recalc-dims="1" /></noscript></a><span class="ssba_sharecount">48</span><a href="https://plus.google.com/share?url=./architecting-a-restful-node-js-app/" onclick="__gaTracker('send', 'event', 'outbound-article', 'https://plus.google.com/share?url=./architecting-a-restful-node-js-app/', '');" data-site="" class="ssba_google_share"   target="_blank"  rel="nofollow"><img src="http://i0.wp.com/thejackalofjavascript.com/wp-content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="http://i2.wp.com/thejackalofjavascript.com/wp-content/plugins/simple-share-buttons-adder/buttons/somacro/google.png?w=646" title="Google+" class="ssba ssba-img" alt="Share on Google+" data-recalc-dims="1" /><noscript><img src="http://i2.wp.com/thejackalofjavascript.com/wp-content/plugins/simple-share-buttons-adder/buttons/somacro/google.png?w=646" title="Google+" class="ssba ssba-img" alt="Share on Google+" data-recalc-dims="1" /></noscript></a><span class="ssba_sharecount">0</span><a href="http://reddit.com/submit?url=./architecting-a-restful-node-js-app/&amp;title=Architecting a Secure RESTful Node.js app" onclick="__gaTracker('send', 'event', 'outbound-article', 'http://reddit.com/submit?url=./architecting-a-restful-node-js-app/&amp;title=Architecting a Secure RESTful Node.js app', '');" data-site="reddit" class="ssba_reddit_share"   target="_blank"  rel="nofollow"><img src="http://i0.wp.com/thejackalofjavascript.com/wp-content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="http://i0.wp.com/thejackalofjavascript.com/wp-content/plugins/simple-share-buttons-adder/buttons/somacro/reddit.png?w=646" title="Reddit" class="ssba ssba-img" alt="Share on Reddit" data-recalc-dims="1" /><noscript><img src="http://i0.wp.com/thejackalofjavascript.com/wp-content/plugins/simple-share-buttons-adder/buttons/somacro/reddit.png?w=646" title="Reddit" class="ssba ssba-img" alt="Share on Reddit" data-recalc-dims="1" /></noscript></a><span class="ssba_sharecount">0</span><a href="https://bufferapp.com/add?url=./architecting-a-restful-node-js-app/&amp;text=From The Jackal of Javascript Architecting a Secure RESTful Node.js app" onclick="__gaTracker('send', 'event', 'outbound-article', 'https://bufferapp.com/add?url=./architecting-a-restful-node-js-app/&amp;text=From The Jackal of Javascript Architecting a Secure RESTful Node.js app', '');" data-site="buffer" class="ssba_buffer_share"   target="_blank"  rel="nofollow"><img src="http://i0.wp.com/thejackalofjavascript.com/wp-content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="http://i1.wp.com/thejackalofjavascript.com/wp-content/plugins/simple-share-buttons-adder/buttons/somacro/buffer.png?w=646" title="Buffer" class="ssba ssba-img" alt="Buffer this page" data-recalc-dims="1" /><noscript><img src="http://i1.wp.com/thejackalofjavascript.com/wp-content/plugins/simple-share-buttons-adder/buttons/somacro/buffer.png?w=646" title="Buffer" class="ssba ssba-img" alt="Buffer this page" data-recalc-dims="1" /></noscript></a><a href="https://flattr.com/submit/auto?user_id=arvindr21&amp;title=Architecting a Secure RESTful Node.js app&amp;url=https://flattr.com/profile/arvindr21" onclick="__gaTracker('send', 'event', 'outbound-article', 'https://flattr.com/submit/auto?user_id=arvindr21&amp;title=Architecting a Secure RESTful Node.js app&amp;url=https://flattr.com/profile/arvindr21', '');" data-site="flattr" class="ssba_flattr_share"   target="_blank"  rel="nofollow"><img src="http://i0.wp.com/thejackalofjavascript.com/wp-content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="http://i0.wp.com/thejackalofjavascript.com/wp-content/plugins/simple-share-buttons-adder/buttons/somacro/flattr.png?w=646" title="Flattr" class="ssba ssba-img" alt="Flattr the author" data-recalc-dims="1" /><noscript><img src="http://i0.wp.com/thejackalofjavascript.com/wp-content/plugins/simple-share-buttons-adder/buttons/somacro/flattr.png?w=646" title="Flattr" class="ssba ssba-img" alt="Flattr the author" data-recalc-dims="1" /></noscript></a><a data-site="email" class="ssba_email_share" href="./cdn-cgi/l/email-protection/index.html#b689c5c3d4dcd3d5c28bf7c4d5dedfc2d3d5c2dfd8d196d796e5d3d5c3c4d396e4f3e5e2d0c3da96f8d9d2d398dcc596d7c6c690d7dbc68dd4d9d2cf8bf0c4d9db96e2ded396fcd7d5ddd7da96d9d096fcd7c0d7c5d5c4dfc6c2938486dec2c2c68c9999c2ded3dcd7d5ddd7dad9d0dcd7c0d7c5d5c4dfc6c298d5d9db99d7c4d5dedfc2d3d5c2dfd8d19bd79bc4d3c5c2d0c3da9bd8d9d2d39bdcc59bd7c6c699"><img src="http://i0.wp.com/thejackalofjavascript.com/wp-content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="http://i0.wp.com/thejackalofjavascript.com/wp-content/plugins/simple-share-buttons-adder/buttons/somacro/email.png?w=646" title="Email" class="ssba ssba-img" alt="Email this to someone" data-recalc-dims="1" /><noscript><img src="http://i0.wp.com/thejackalofjavascript.com/wp-content/plugins/simple-share-buttons-adder/buttons/somacro/email.png?w=646" title="Email" class="ssba ssba-img" alt="Email this to someone" data-recalc-dims="1" /></noscript></a><a data-site="print" class="ssba_print ssba_share_link" href="#" onclick="window.print()"><img src="http://i0.wp.com/thejackalofjavascript.com/wp-content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="http://i0.wp.com/thejackalofjavascript.com/wp-content/plugins/simple-share-buttons-adder/buttons/somacro/print.png?w=646" title="Print" class="ssba ssba-img" alt="Print this page" data-recalc-dims="1" /><noscript><img src="http://i0.wp.com/thejackalofjavascript.com/wp-content/plugins/simple-share-buttons-adder/buttons/somacro/print.png?w=646" title="Print" class="ssba ssba-img" alt="Print this page" data-recalc-dims="1" /></noscript></a></div></div><h1 class="disp-none">Architecting a Secure RESTful Node.js app</h1>
<p>In this post, we will take a look at architecting a Node.js app that will act as a REST API server for all of our clients. We will be implementing a Token Based Authentication to authenticate and authorize the client to access the application data.</p>
<p>This application design is targeted at systems that would like to implement its own REST API with a custom authentication. To showcase how one can consume the REST API with authentication, we will be writing an Angular.js client.</p>
<p>This post is inspired by <a href="http://www.kdelemme.com/2014/03/09/authentication-with-angularjs-and-a-node-js-rest-api/" onclick="__gaTracker('send', 'event', 'outbound-article', 'http://www.kdelemme.com/2014/03/09/authentication-with-angularjs-and-a-node-js-rest-api/', 'Authentication with AngularJS and a Node.js REST api');" title="Authentication with AngularJS and a Node.js REST api"  target="_blank">Authentication with AngularJS and a Node.js REST api</a>.</p>
<p>You can find the completed code <a href="https://github.com/arvindr21/myRESTApp" onclick="__gaTracker('send', 'event', 'outbound-article', 'https://github.com/arvindr21/myRESTApp', 'here');" title="myRESTApp"  target="_blank">here</a>.</p>
<p>So, let us get started.<span id="more-2043"></span></p>
<h2>REST API</h2>
<p>If you are new to REST API, I would highly recommend watching the below video</p>
<p style="text-align: center;">
<!-- iframe plugin v.4.2 wordpress.org/plugins/iframe/ -->
<iframe width="560" height="315" src="//www.youtube.com/embed/7YcW25PHnAA?rel=0" frameborder="0" 0="allowfullscreen" scrolling="yes" class="iframe-class"></iframe>
</p>
<p style="text-align: left;">Also do checkout <a href="http://www.restapitutorial.com/" onclick="__gaTracker('send', 'event', 'outbound-article', 'http://www.restapitutorial.com/', 'restapitutorial.com');" title="restapitutorial.com"  target="_blank">restapitutorial.com</a> and <a href="http://www.restapitutorial.com/httpstatuscodes.html" onclick="__gaTracker('send', 'event', 'outbound-article', 'http://www.restapitutorial.com/httpstatuscodes.html', 'HTTP Status codes');" title="HTTP Status Codes"  target="_blank">HTTP Status codes</a> for more info.</p>
<h2 style="text-align: left;">Security</h2>
<p>If you are new to implementing security or want to gain a fair idea, I would recommend watching the below video</p>
<p style="text-align: center;"> 
<!-- iframe plugin v.4.2 wordpress.org/plugins/iframe/ -->
<iframe width="560" height="315" src="//www.youtube.com/embed/E6o3IKcQABY?rel=0" frameborder="0" 0="allowfullscreen" scrolling="yes" class="iframe-class"></iframe>
</p>
<h2>Architecture</h2>
<p>The key difference between a traditional application server and a RESTful server is that the RESTful server dispatches only data for an end point and not a web page. This is very advantageous when you want to have a mobile app or a tablet app built on top of your existing application data. This way the time to market your app idea is very low. You build your application logic only once and then consume it from any RESTful client.</p>
<p>Now the question which arises is how do we know if the client accessing our REST API is genuine? Here is one of the possible solution.</p>
<p>I have used the below architecture with a couple of my projects and it seemed to be pretty sturdy.</p>
<p><a href="http://i1.wp.com/thejackalofjavascript.com/wp-content/uploads/2014/09/minimal.png" data-rel="lightbox-0" title=""><img class="size-medium wp-image-2086 aligncenter" src="http://i0.wp.com/thejackalofjavascript.com/wp-content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="http://i2.wp.com/thejackalofjavascript.com/wp-content/uploads/2014/09/minimal-341x300.png?resize=341%2C300" alt="minimal" data-recalc-dims="1" /><noscript><img class="size-medium wp-image-2086 aligncenter" src="http://i2.wp.com/thejackalofjavascript.com/wp-content/uploads/2014/09/minimal-341x300.png?resize=341%2C300" alt="minimal" data-recalc-dims="1" /></noscript></a></p>
<p>As you can see from the above diagram, the architecture is pretty flexible and can be used by any client that can consume a REST API.</p>
<p>Any client which would like to access the data from our system should first fire a request to a <em>/login</em> route (<em>or endpoint</em>) with a valid username and a password. We then check if the credentials are valid. If they are valid, we would send an user object back to the client along with an access token.</p>
<p>This token has an expiration time associated with it. And the client is expected to send this token to the server everytime a request is made to fetch the data. This is our custom way of authenticating a client.</p>
<p>For your app, you can either issue a username/password for your client (<em>an Android app or Angular app</em>) to connect and make API calls or you can use your customer&#8217;s credentials to make the call too.</p>
<p>As soon as a user makes a call to one of our API endpoints, we redirect the request to the authentication middleware. This middleware is responsible for authenticating the client by first processing the token. If the token is not present/invalid or expired, it will throw a 401 HTTP status code. If the request has a valid token and is not yet expired, we will invoke the next middleware in the stack.</p>
<p>If you want, you can also add another layer of security. You can request the client to send the logged in user&#8217;s username along with the token. This way, first we will authenticate the token and then the client. This is authentication and authorization.  This approach will also help you to check if a given user is allowed to access a route and its data.</p>
<p>Simple and easy right? We will implement the same now to get a feel of the architecture.</p>
<h2>Setup the REST Server</h2>
<p>Create a new folder named <em>myRESTApp</em>. Inside that folder, create a folder named <em>server</em>. We will first create a new node project. Open a new terminal/prompt from inside the <em>server</em> folder and run</p>
<p style="text-align: center;">
<span id="crayon-5a103f9ecedb4121464490" class="crayon-syntax crayon-syntax-inline  crayon-theme-arduino-ide crayon-theme-arduino-ide-inline crayon-font-droid-sans-mono" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-e">npm </span><span class="crayon-v">init</span></span></span></p>
<p>Fill it up as applicable. Now, we will add a few dependencies. Run</p>
<p style="text-align: center;">
<span id="crayon-5a103f9ecedc9393470757" class="crayon-syntax crayon-syntax-inline  crayon-theme-arduino-ide crayon-theme-arduino-ide-inline crayon-font-droid-sans-mono" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-e">npm </span><span class="crayon-v">install</span><span class="crayon-h"> </span><span class="crayon-o">--</span><span class="crayon-e">save </span><span class="crayon-e">express </span><span class="crayon-v">body</span><span class="crayon-o">-</span><span class="crayon-e">parser </span><span class="crayon-e">morgan </span><span class="crayon-v">jwt</span><span class="crayon-o">-</span><span class="crayon-v">simple</span></span></span></p>
<p>We are going to use Express as our server side framework, jwt-simple module to generate JSON Web Tokens. These tokens will be used as access tokens between the server and client.</p>
<p>Our final <em>package.json</em> would look like</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div id="crayon-5a103f9ecedd1441178375" class="crayon-syntax crayon-theme-arduino-ide crayon-font-droid-sans-mono crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">package.json</span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">JavaScript</span></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
{
"name": "myRESTfulApp",
"version": "0.1.0",
"description": "myRESTfulApp",
"main": "server.js",
"scripts": {
"test": "echo \"Error: no test specified\" &amp;&amp; exit 1"
},
"author": "Arvind Ravulavaru",
"license": "MIT",
"dependencies": {
"body-parser": "^1.8.3",
"express": "^4.9.4",
"jwt-simple": "^0.2.0",
"morgan": "^1.3.1"
}
}</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums" data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a103f9ecedd1441178375-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecedd1441178375-2">2</div><div class="crayon-num" data-line="crayon-5a103f9ecedd1441178375-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecedd1441178375-4">4</div><div class="crayon-num" data-line="crayon-5a103f9ecedd1441178375-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecedd1441178375-6">6</div><div class="crayon-num" data-line="crayon-5a103f9ecedd1441178375-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecedd1441178375-8">8</div><div class="crayon-num" data-line="crayon-5a103f9ecedd1441178375-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecedd1441178375-10">10</div><div class="crayon-num" data-line="crayon-5a103f9ecedd1441178375-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecedd1441178375-12">12</div><div class="crayon-num" data-line="crayon-5a103f9ecedd1441178375-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecedd1441178375-14">14</div><div class="crayon-num" data-line="crayon-5a103f9ecedd1441178375-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecedd1441178375-16">16</div><div class="crayon-num" data-line="crayon-5a103f9ecedd1441178375-17">17</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a103f9ecedd1441178375-1"><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecedd1441178375-2"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-s">"name"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"myRESTfulApp"</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5a103f9ecedd1441178375-3"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-s">"version"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"0.1.0"</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecedd1441178375-4"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-s">"description"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"myRESTfulApp"</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5a103f9ecedd1441178375-5"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-s">"main"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"server.js"</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecedd1441178375-6"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-s">"scripts"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a103f9ecedd1441178375-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"test"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"echo \"Error: no test specified\" &amp;&amp; exit 1"</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecedd1441178375-8"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5a103f9ecedd1441178375-9"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-s">"author"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"Arvind Ravulavaru"</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecedd1441178375-10"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-s">"license"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"MIT"</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5a103f9ecedd1441178375-11"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-s">"dependencies"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecedd1441178375-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"body-parser"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"^1.8.3"</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5a103f9ecedd1441178375-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"express"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"^4.9.4"</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecedd1441178375-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"jwt-simple"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"^0.2.0"</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5a103f9ecedd1441178375-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"morgan"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"^1.3.1"</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecedd1441178375-16"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5a103f9ecedd1441178375-17"><span class="crayon-sy">}</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0033 seconds] -->
<p>Now, we will setup our server. At the root of <em>server</em> folder, create a file named <em>server.js</em>. This will be the entry point into our node application.</p>
<p>Update <em>server.js</em> as below</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div id="crayon-5a103f9ecedd9836163384" class="crayon-syntax crayon-theme-arduino-ide crayon-font-droid-sans-mono crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">server.js</span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">JavaScript</span></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
var express = require('express');
var path = require('path');
var logger = require('morgan');
var bodyParser = require('body-parser');
var app = express();
app.use(logger('dev'));
app.use(bodyParser.json());
app.all('/*', function(req, res, next) {
// CORS headers
res.header("Access-Control-Allow-Origin", "*"); // restrict it to the required domain
res.header('Access-Control-Allow-Methods', 'GET,PUT,POST,DELETE,OPTIONS');
// Set custom headers for CORS
res.header('Access-Control-Allow-Headers', 'Content-type,Accept,X-Access-Token,X-Key');
if (req.method == 'OPTIONS') {
res.status(200).end();
} else {
next();
}
});
// Auth Middleware - This will check if the token is valid
// Only the requests that start with /api/v1/* will be checked for the token.
// Any URL's that do not follow the below pattern should be avoided unless you 
// are sure that authentication is not needed
app.all('/api/v1/*', [require('./middlewares/validateRequest')]);
app.use('/', require('./routes'));
// If no route is matched by now, it must be a 404
app.use(function(req, res, next) {
var err = new Error('Not Found');
err.status = 404;
next(err);
});
// Start the server
app.set('port', process.env.PORT || 3000);
var server = app.listen(app.get('port'), function() {
console.log('Express server listening on port ' + server.address().port);
});</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums" data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a103f9ecedd9836163384-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecedd9836163384-2">2</div><div class="crayon-num" data-line="crayon-5a103f9ecedd9836163384-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecedd9836163384-4">4</div><div class="crayon-num" data-line="crayon-5a103f9ecedd9836163384-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecedd9836163384-6">6</div><div class="crayon-num" data-line="crayon-5a103f9ecedd9836163384-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecedd9836163384-8">8</div><div class="crayon-num" data-line="crayon-5a103f9ecedd9836163384-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecedd9836163384-10">10</div><div class="crayon-num" data-line="crayon-5a103f9ecedd9836163384-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecedd9836163384-12">12</div><div class="crayon-num" data-line="crayon-5a103f9ecedd9836163384-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecedd9836163384-14">14</div><div class="crayon-num" data-line="crayon-5a103f9ecedd9836163384-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecedd9836163384-16">16</div><div class="crayon-num" data-line="crayon-5a103f9ecedd9836163384-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecedd9836163384-18">18</div><div class="crayon-num" data-line="crayon-5a103f9ecedd9836163384-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecedd9836163384-20">20</div><div class="crayon-num" data-line="crayon-5a103f9ecedd9836163384-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecedd9836163384-22">22</div><div class="crayon-num" data-line="crayon-5a103f9ecedd9836163384-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecedd9836163384-24">24</div><div class="crayon-num" data-line="crayon-5a103f9ecedd9836163384-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecedd9836163384-26">26</div><div class="crayon-num" data-line="crayon-5a103f9ecedd9836163384-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecedd9836163384-28">28</div><div class="crayon-num" data-line="crayon-5a103f9ecedd9836163384-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecedd9836163384-30">30</div><div class="crayon-num" data-line="crayon-5a103f9ecedd9836163384-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecedd9836163384-32">32</div><div class="crayon-num" data-line="crayon-5a103f9ecedd9836163384-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecedd9836163384-34">34</div><div class="crayon-num" data-line="crayon-5a103f9ecedd9836163384-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecedd9836163384-36">36</div><div class="crayon-num" data-line="crayon-5a103f9ecedd9836163384-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecedd9836163384-38">38</div><div class="crayon-num" data-line="crayon-5a103f9ecedd9836163384-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecedd9836163384-40">40</div><div class="crayon-num" data-line="crayon-5a103f9ecedd9836163384-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecedd9836163384-42">42</div><div class="crayon-num" data-line="crayon-5a103f9ecedd9836163384-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecedd9836163384-44">44</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a103f9ecedd9836163384-1"><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">express</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">require</span><span class="crayon-sy">(</span><span class="crayon-s">'express'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecedd9836163384-2"><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">path</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">require</span><span class="crayon-sy">(</span><span class="crayon-s">'path'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a103f9ecedd9836163384-3"><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">logger</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">require</span><span class="crayon-sy">(</span><span class="crayon-s">'morgan'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecedd9836163384-4"><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">bodyParser</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">require</span><span class="crayon-sy">(</span><span class="crayon-s">'body-parser'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a103f9ecedd9836163384-5">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecedd9836163384-6"><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">app</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">express</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a103f9ecedd9836163384-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecedd9836163384-8"><span class="crayon-v">app</span><span class="crayon-sy">.</span><span class="crayon-st">use</span><span class="crayon-sy">(</span><span class="crayon-e">logger</span><span class="crayon-sy">(</span><span class="crayon-s">'dev'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a103f9ecedd9836163384-9"><span class="crayon-v">app</span><span class="crayon-sy">.</span><span class="crayon-st">use</span><span class="crayon-sy">(</span><span class="crayon-v">bodyParser</span><span class="crayon-sy">.</span><span class="crayon-e">json</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecedd9836163384-10">&nbsp;</div><div class="crayon-line" id="crayon-5a103f9ecedd9836163384-11"><span class="crayon-v">app</span><span class="crayon-sy">.</span><span class="crayon-e">all</span><span class="crayon-sy">(</span><span class="crayon-s">'/*'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-v">req</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">res</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">next</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecedd9836163384-12"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">// CORS headers</span></div><div class="crayon-line" id="crayon-5a103f9ecedd9836163384-13"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">res</span><span class="crayon-sy">.</span><span class="crayon-e">header</span><span class="crayon-sy">(</span><span class="crayon-s">"Access-Control-Allow-Origin"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"*"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// restrict it to the required domain</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecedd9836163384-14"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">res</span><span class="crayon-sy">.</span><span class="crayon-e">header</span><span class="crayon-sy">(</span><span class="crayon-s">'Access-Control-Allow-Methods'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'GET,PUT,POST,DELETE,OPTIONS'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a103f9ecedd9836163384-15"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">// Set custom headers for CORS</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecedd9836163384-16"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">res</span><span class="crayon-sy">.</span><span class="crayon-e">header</span><span class="crayon-sy">(</span><span class="crayon-s">'Access-Control-Allow-Headers'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'Content-type,Accept,X-Access-Token,X-Key'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a103f9ecedd9836163384-17"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">req</span><span class="crayon-sy">.</span><span class="crayon-v">method</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-s">'OPTIONS'</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecedd9836163384-18"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">res</span><span class="crayon-sy">.</span><span class="crayon-e">status</span><span class="crayon-sy">(</span><span class="crayon-cn">200</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-st">end</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a103f9ecedd9836163384-19"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecedd9836163384-20"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">next</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a103f9ecedd9836163384-21"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecedd9836163384-22"><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a103f9ecedd9836163384-23">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecedd9836163384-24"><span class="crayon-c">// Auth Middleware - This will check if the token is valid</span></div><div class="crayon-line" id="crayon-5a103f9ecedd9836163384-25"><span class="crayon-c">// Only the requests that start with /api/v1/* will be checked for the token.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecedd9836163384-26"><span class="crayon-c">// Any URL's that do not follow the below pattern should be avoided unless you </span></div><div class="crayon-line" id="crayon-5a103f9ecedd9836163384-27"><span class="crayon-c">// are sure that authentication is not needed</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecedd9836163384-28"><span class="crayon-v">app</span><span class="crayon-sy">.</span><span class="crayon-e">all</span><span class="crayon-sy">(</span><span class="crayon-s">'/api/v1/*'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-e">require</span><span class="crayon-sy">(</span><span class="crayon-s">'./middlewares/validateRequest'</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a103f9ecedd9836163384-29">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecedd9836163384-30"><span class="crayon-v">app</span><span class="crayon-sy">.</span><span class="crayon-st">use</span><span class="crayon-sy">(</span><span class="crayon-s">'/'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">require</span><span class="crayon-sy">(</span><span class="crayon-s">'./routes'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a103f9ecedd9836163384-31">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecedd9836163384-32"><span class="crayon-c">// If no route is matched by now, it must be a 404</span></div><div class="crayon-line" id="crayon-5a103f9ecedd9836163384-33"><span class="crayon-v">app</span><span class="crayon-sy">.</span><span class="crayon-st">use</span><span class="crayon-sy">(</span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-v">req</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">res</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">next</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecedd9836163384-34"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">err</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">new</span><span class="crayon-h"> </span><span class="crayon-e">Error</span><span class="crayon-sy">(</span><span class="crayon-s">'Not Found'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a103f9ecedd9836163384-35"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">err</span><span class="crayon-sy">.</span><span class="crayon-v">status</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">404</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecedd9836163384-36"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-e">next</span><span class="crayon-sy">(</span><span class="crayon-v">err</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a103f9ecedd9836163384-37"><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecedd9836163384-38">&nbsp;</div><div class="crayon-line" id="crayon-5a103f9ecedd9836163384-39"><span class="crayon-c">// Start the server</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecedd9836163384-40"><span class="crayon-v">app</span><span class="crayon-sy">.</span><span class="crayon-e">set</span><span class="crayon-sy">(</span><span class="crayon-s">'port'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">process</span><span class="crayon-sy">.</span><span class="crayon-v">env</span><span class="crayon-sy">.</span><span class="crayon-v">PORT</span><span class="crayon-h"> </span><span class="crayon-o">||</span><span class="crayon-h"> </span><span class="crayon-cn">3000</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a103f9ecedd9836163384-41">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecedd9836163384-42"><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">server</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">app</span><span class="crayon-sy">.</span><span class="crayon-e">listen</span><span class="crayon-sy">(</span><span class="crayon-v">app</span><span class="crayon-sy">.</span><span class="crayon-e">get</span><span class="crayon-sy">(</span><span class="crayon-s">'port'</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a103f9ecedd9836163384-43"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">console</span><span class="crayon-sy">.</span><span class="crayon-e">log</span><span class="crayon-sy">(</span><span class="crayon-s">'Express server listening on port '</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">server</span><span class="crayon-sy">.</span><span class="crayon-e">address</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-v">port</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecedd9836163384-44"><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0238 seconds] -->
<p>Things to notice</p>
<p><strong>Line 28</strong> : The middleware that we are <em>going to write</em> to authenticate and authorize the request.</p>
<p><strong>Line 30</strong> : The list of routes for our application. We will create this file soon.</p>
<p><strong>Line 42</strong> : Start the server</p>
<p><strong>Line 11</strong> : Enable Cross Origin Resource Sharing</p>
<p>Remaining config is pretty standard Express stuff.</p>
<p><strong>[Important]</strong> : You should consider adding HTTPS support to you app. Not only for login, but for every request. You can find more info about setting up HTTPS <a href="http://www.hacksparrow.com/express-js-https.html" onclick="__gaTracker('send', 'event', 'outbound-article', 'http://www.hacksparrow.com/express-js-https.html', 'here');" title="How to set up a HTTPS Express.js Server"  target="_blank">here</a>. Thanks to <a title="Ward Bell Comment" href="./index.html#comment-1614075726">Ward Bell</a> for pointing it out.</p>
<p>Now, we will work on the routes. For the purpose of this post, we will create 3 types of routes</p>
<ol>
<li>Routes that do not need authentication or authorization like the login. Or an About Us, Contact details etc.</li>
<li>Routes that need authentication to access the underlying resource. Like a list of products or any data that would be specific to the user.</li>
<li>Routes that need authentication as well as authorization. Like deleting users or updating configs etc. (<em>like an admin task</em>). For this authentication alone would not suffice, you need to be authorized to access that resource.</li>
</ol>
<p>Create a new folder named <em>routes</em> inside the <em>server</em> folder. Inside the <em>routes</em> folder create a new file named <em>index.js</em>. This file will hold all the routes needed for our app.</p>
<p>Updated <em>index.js </em> as below</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div id="crayon-5a103f9ecede9855813395" class="crayon-syntax crayon-theme-arduino-ide crayon-font-droid-sans-mono crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">server/routes/index.js</span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">JavaScript</span></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
var express = require('express');
var router = express.Router();
var auth = require('./auth.js');
var products = require('./products.js');
var user = require('./users.js');
/*
* Routes that can be accessed by any one
*/
router.post('/login', auth.login);
/*
* Routes that can be accessed only by autheticated users
*/
router.get('/api/v1/products', products.getAll);
router.get('/api/v1/product/:id', products.getOne);
router.post('/api/v1/product/', products.create);
router.put('/api/v1/product/:id', products.update);
router.delete('/api/v1/product/:id', products.delete);
/*
* Routes that can be accessed only by authenticated &amp; authorized users
*/
router.get('/api/v1/admin/users', user.getAll);
router.get('/api/v1/admin/user/:id', user.getOne);
router.post('/api/v1/admin/user/', user.create);
router.put('/api/v1/admin/user/:id', user.update);
router.delete('/api/v1/admin/user/:id', user.delete);
module.exports = router;</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums" data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a103f9ecede9855813395-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecede9855813395-2">2</div><div class="crayon-num" data-line="crayon-5a103f9ecede9855813395-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecede9855813395-4">4</div><div class="crayon-num" data-line="crayon-5a103f9ecede9855813395-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecede9855813395-6">6</div><div class="crayon-num" data-line="crayon-5a103f9ecede9855813395-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecede9855813395-8">8</div><div class="crayon-num" data-line="crayon-5a103f9ecede9855813395-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecede9855813395-10">10</div><div class="crayon-num" data-line="crayon-5a103f9ecede9855813395-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecede9855813395-12">12</div><div class="crayon-num" data-line="crayon-5a103f9ecede9855813395-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecede9855813395-14">14</div><div class="crayon-num" data-line="crayon-5a103f9ecede9855813395-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecede9855813395-16">16</div><div class="crayon-num" data-line="crayon-5a103f9ecede9855813395-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecede9855813395-18">18</div><div class="crayon-num" data-line="crayon-5a103f9ecede9855813395-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecede9855813395-20">20</div><div class="crayon-num" data-line="crayon-5a103f9ecede9855813395-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecede9855813395-22">22</div><div class="crayon-num" data-line="crayon-5a103f9ecede9855813395-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecede9855813395-24">24</div><div class="crayon-num" data-line="crayon-5a103f9ecede9855813395-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecede9855813395-26">26</div><div class="crayon-num" data-line="crayon-5a103f9ecede9855813395-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecede9855813395-28">28</div><div class="crayon-num" data-line="crayon-5a103f9ecede9855813395-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecede9855813395-30">30</div><div class="crayon-num" data-line="crayon-5a103f9ecede9855813395-31">31</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a103f9ecede9855813395-1"><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">express</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">require</span><span class="crayon-sy">(</span><span class="crayon-s">'express'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecede9855813395-2"><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">router</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">express</span><span class="crayon-sy">.</span><span class="crayon-e">Router</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a103f9ecede9855813395-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecede9855813395-4"><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">auth</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">require</span><span class="crayon-sy">(</span><span class="crayon-s">'./auth.js'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a103f9ecede9855813395-5"><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">products</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">require</span><span class="crayon-sy">(</span><span class="crayon-s">'./products.js'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecede9855813395-6"><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">user</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">require</span><span class="crayon-sy">(</span><span class="crayon-s">'./users.js'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a103f9ecede9855813395-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecede9855813395-8"><span class="crayon-c">/*</span></div><div class="crayon-line" id="crayon-5a103f9ecede9855813395-9"><span class="crayon-c"> * Routes that can be accessed by any one</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecede9855813395-10"><span class="crayon-c"> */</span></div><div class="crayon-line" id="crayon-5a103f9ecede9855813395-11"><span class="crayon-v">router</span><span class="crayon-sy">.</span><span class="crayon-e">post</span><span class="crayon-sy">(</span><span class="crayon-s">'/login'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">auth</span><span class="crayon-sy">.</span><span class="crayon-v">login</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecede9855813395-12">&nbsp;</div><div class="crayon-line" id="crayon-5a103f9ecede9855813395-13"><span class="crayon-c">/*</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecede9855813395-14"><span class="crayon-c"> * Routes that can be accessed only by autheticated users</span></div><div class="crayon-line" id="crayon-5a103f9ecede9855813395-15"><span class="crayon-c"> */</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecede9855813395-16"><span class="crayon-v">router</span><span class="crayon-sy">.</span><span class="crayon-e">get</span><span class="crayon-sy">(</span><span class="crayon-s">'/api/v1/products'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">products</span><span class="crayon-sy">.</span><span class="crayon-v">getAll</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a103f9ecede9855813395-17"><span class="crayon-v">router</span><span class="crayon-sy">.</span><span class="crayon-e">get</span><span class="crayon-sy">(</span><span class="crayon-s">'/api/v1/product/:id'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">products</span><span class="crayon-sy">.</span><span class="crayon-v">getOne</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecede9855813395-18"><span class="crayon-v">router</span><span class="crayon-sy">.</span><span class="crayon-e">post</span><span class="crayon-sy">(</span><span class="crayon-s">'/api/v1/product/'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">products</span><span class="crayon-sy">.</span><span class="crayon-v">create</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a103f9ecede9855813395-19"><span class="crayon-v">router</span><span class="crayon-sy">.</span><span class="crayon-e">put</span><span class="crayon-sy">(</span><span class="crayon-s">'/api/v1/product/:id'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">products</span><span class="crayon-sy">.</span><span class="crayon-v">update</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecede9855813395-20"><span class="crayon-v">router</span><span class="crayon-sy">.</span><span class="crayon-e">delete</span><span class="crayon-sy">(</span><span class="crayon-s">'/api/v1/product/:id'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">products</span><span class="crayon-sy">.</span><span class="crayon-v">delete</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a103f9ecede9855813395-21">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecede9855813395-22"><span class="crayon-c">/*</span></div><div class="crayon-line" id="crayon-5a103f9ecede9855813395-23"><span class="crayon-c"> * Routes that can be accessed only by authenticated &amp; authorized users</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecede9855813395-24"><span class="crayon-c"> */</span></div><div class="crayon-line" id="crayon-5a103f9ecede9855813395-25"><span class="crayon-v">router</span><span class="crayon-sy">.</span><span class="crayon-e">get</span><span class="crayon-sy">(</span><span class="crayon-s">'/api/v1/admin/users'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">user</span><span class="crayon-sy">.</span><span class="crayon-v">getAll</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecede9855813395-26"><span class="crayon-v">router</span><span class="crayon-sy">.</span><span class="crayon-e">get</span><span class="crayon-sy">(</span><span class="crayon-s">'/api/v1/admin/user/:id'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">user</span><span class="crayon-sy">.</span><span class="crayon-v">getOne</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a103f9ecede9855813395-27"><span class="crayon-v">router</span><span class="crayon-sy">.</span><span class="crayon-e">post</span><span class="crayon-sy">(</span><span class="crayon-s">'/api/v1/admin/user/'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">user</span><span class="crayon-sy">.</span><span class="crayon-v">create</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecede9855813395-28"><span class="crayon-v">router</span><span class="crayon-sy">.</span><span class="crayon-e">put</span><span class="crayon-sy">(</span><span class="crayon-s">'/api/v1/admin/user/:id'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">user</span><span class="crayon-sy">.</span><span class="crayon-v">update</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a103f9ecede9855813395-29"><span class="crayon-v">router</span><span class="crayon-sy">.</span><span class="crayon-e">delete</span><span class="crayon-sy">(</span><span class="crayon-s">'/api/v1/admin/user/:id'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">user</span><span class="crayon-sy">.</span><span class="crayon-v">delete</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecede9855813395-30">&nbsp;</div><div class="crayon-line" id="crayon-5a103f9ecede9855813395-31"><span class="crayon-v">module</span><span class="crayon-sy">.</span><span class="crayon-v">exports</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">router</span><span class="crayon-sy">;</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0136 seconds] -->
<p>Things to notice</p>
<p><strong>Lines 4 &#8211; 6</strong> : Externalized the business logic for each route</p>
<p><strong>Line 11:</strong> This is the login route. A client that would like to interact with our data, should first hit this URL, get the token and then only will be authorized to access the remaining routes</p>
<p><strong>Lines 16 &#8211; 20 :</strong> A dummy set of API methods to access a product. This can be any resource you would like to expose to your clients. Do notice the <em>/api/v1/</em> at the beginning of the route. This is cue for the authentication middleware to validate the request. If you do not provide the <em>/api/v1/</em>, the validation will be skipped. As you can see from line 11.</p>
<p><strong>Line 25 &#8211; 29</strong> : A dummy set of Admin API methods to manage a user. Do notice the <em>/api/v1/. </em></p>
<p>Now, we will build the logic for each of the 3 routes. First Login. Create a new file named <em>auth.js</em> inside the <em>routes </em>folder. This file will contain the logic to authenticate the user and generate an access token when the login is successful.</p>
<p>Update <em>auth.js</em> as below</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div id="crayon-5a103f9ecedf5154067704" class="crayon-syntax crayon-theme-arduino-ide crayon-font-droid-sans-mono crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">server/routes/auth.js</span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">JavaScript</span></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
var jwt = require('jwt-simple');
var auth = {
login: function(req, res) {
var username = req.body.username || '';
var password = req.body.password || '';
if (username == '' || password == '') {
res.status(401);
res.json({
"status": 401,
"message": "Invalid credentials"
});
return;
}
// Fire a query to your DB and check if the credentials are valid
var dbUserObj = auth.validate(username, password);
if (!dbUserObj) { // If authentication fails, we send a 401 back
res.status(401);
res.json({
"status": 401,
"message": "Invalid credentials"
});
return;
}
if (dbUserObj) {
// If authentication is success, we will generate a token
// and dispatch it to the client
res.json(genToken(dbUserObj));
}
},
validate: function(username, password) {
// spoofing the DB response for simplicity
var dbUserObj = { // spoofing a userobject from the DB. 
name: 'arvind',
role: 'admin',
username: 'arvind@myapp.com'
};
return dbUserObj;
},
validateUser: function(username) {
// spoofing the DB response for simplicity
var dbUserObj = { // spoofing a userobject from the DB. 
name: 'arvind',
role: 'admin',
username: 'arvind@myapp.com'
};
return dbUserObj;
},
}
// private method
function genToken(user) {
var expires = expiresIn(7); // 7 days
var token = jwt.encode({
exp: expires
}, require('../config/secret')());
return {
token: token,
expires: expires,
user: user
};
}
function expiresIn(numDays) {
var dateObj = new Date();
return dateObj.setDate(dateObj.getDate() + numDays);
}
module.exports = auth;</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums" data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a103f9ecedf5154067704-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecedf5154067704-2">2</div><div class="crayon-num" data-line="crayon-5a103f9ecedf5154067704-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecedf5154067704-4">4</div><div class="crayon-num" data-line="crayon-5a103f9ecedf5154067704-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecedf5154067704-6">6</div><div class="crayon-num" data-line="crayon-5a103f9ecedf5154067704-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecedf5154067704-8">8</div><div class="crayon-num" data-line="crayon-5a103f9ecedf5154067704-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecedf5154067704-10">10</div><div class="crayon-num" data-line="crayon-5a103f9ecedf5154067704-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecedf5154067704-12">12</div><div class="crayon-num" data-line="crayon-5a103f9ecedf5154067704-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecedf5154067704-14">14</div><div class="crayon-num" data-line="crayon-5a103f9ecedf5154067704-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecedf5154067704-16">16</div><div class="crayon-num" data-line="crayon-5a103f9ecedf5154067704-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecedf5154067704-18">18</div><div class="crayon-num" data-line="crayon-5a103f9ecedf5154067704-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecedf5154067704-20">20</div><div class="crayon-num" data-line="crayon-5a103f9ecedf5154067704-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecedf5154067704-22">22</div><div class="crayon-num" data-line="crayon-5a103f9ecedf5154067704-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecedf5154067704-24">24</div><div class="crayon-num" data-line="crayon-5a103f9ecedf5154067704-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecedf5154067704-26">26</div><div class="crayon-num" data-line="crayon-5a103f9ecedf5154067704-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecedf5154067704-28">28</div><div class="crayon-num" data-line="crayon-5a103f9ecedf5154067704-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecedf5154067704-30">30</div><div class="crayon-num" data-line="crayon-5a103f9ecedf5154067704-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecedf5154067704-32">32</div><div class="crayon-num" data-line="crayon-5a103f9ecedf5154067704-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecedf5154067704-34">34</div><div class="crayon-num" data-line="crayon-5a103f9ecedf5154067704-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecedf5154067704-36">36</div><div class="crayon-num" data-line="crayon-5a103f9ecedf5154067704-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecedf5154067704-38">38</div><div class="crayon-num" data-line="crayon-5a103f9ecedf5154067704-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecedf5154067704-40">40</div><div class="crayon-num" data-line="crayon-5a103f9ecedf5154067704-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecedf5154067704-42">42</div><div class="crayon-num" data-line="crayon-5a103f9ecedf5154067704-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecedf5154067704-44">44</div><div class="crayon-num" data-line="crayon-5a103f9ecedf5154067704-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecedf5154067704-46">46</div><div class="crayon-num" data-line="crayon-5a103f9ecedf5154067704-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecedf5154067704-48">48</div><div class="crayon-num" data-line="crayon-5a103f9ecedf5154067704-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecedf5154067704-50">50</div><div class="crayon-num" data-line="crayon-5a103f9ecedf5154067704-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecedf5154067704-52">52</div><div class="crayon-num" data-line="crayon-5a103f9ecedf5154067704-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecedf5154067704-54">54</div><div class="crayon-num" data-line="crayon-5a103f9ecedf5154067704-55">55</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecedf5154067704-56">56</div><div class="crayon-num" data-line="crayon-5a103f9ecedf5154067704-57">57</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecedf5154067704-58">58</div><div class="crayon-num" data-line="crayon-5a103f9ecedf5154067704-59">59</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecedf5154067704-60">60</div><div class="crayon-num" data-line="crayon-5a103f9ecedf5154067704-61">61</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecedf5154067704-62">62</div><div class="crayon-num" data-line="crayon-5a103f9ecedf5154067704-63">63</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecedf5154067704-64">64</div><div class="crayon-num" data-line="crayon-5a103f9ecedf5154067704-65">65</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecedf5154067704-66">66</div><div class="crayon-num" data-line="crayon-5a103f9ecedf5154067704-67">67</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecedf5154067704-68">68</div><div class="crayon-num" data-line="crayon-5a103f9ecedf5154067704-69">69</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecedf5154067704-70">70</div><div class="crayon-num" data-line="crayon-5a103f9ecedf5154067704-71">71</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecedf5154067704-72">72</div><div class="crayon-num" data-line="crayon-5a103f9ecedf5154067704-73">73</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecedf5154067704-74">74</div><div class="crayon-num" data-line="crayon-5a103f9ecedf5154067704-75">75</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecedf5154067704-76">76</div><div class="crayon-num" data-line="crayon-5a103f9ecedf5154067704-77">77</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecedf5154067704-78">78</div><div class="crayon-num" data-line="crayon-5a103f9ecedf5154067704-79">79</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecedf5154067704-80">80</div><div class="crayon-num" data-line="crayon-5a103f9ecedf5154067704-81">81</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecedf5154067704-82">82</div><div class="crayon-num" data-line="crayon-5a103f9ecedf5154067704-83">83</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a103f9ecedf5154067704-1"><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">jwt</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">require</span><span class="crayon-sy">(</span><span class="crayon-s">'jwt-simple'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecedf5154067704-2">&nbsp;</div><div class="crayon-line" id="crayon-5a103f9ecedf5154067704-3"><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">auth</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecedf5154067704-4">&nbsp;</div><div class="crayon-line" id="crayon-5a103f9ecedf5154067704-5"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">login</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-v">req</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">res</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecedf5154067704-6">&nbsp;</div><div class="crayon-line" id="crayon-5a103f9ecedf5154067704-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">username</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">req</span><span class="crayon-sy">.</span><span class="crayon-v">body</span><span class="crayon-sy">.</span><span class="crayon-v">username</span><span class="crayon-h"> </span><span class="crayon-o">||</span><span class="crayon-h"> </span><span class="crayon-s">''</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecedf5154067704-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">password</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">req</span><span class="crayon-sy">.</span><span class="crayon-v">body</span><span class="crayon-sy">.</span><span class="crayon-v">password</span><span class="crayon-h"> </span><span class="crayon-o">||</span><span class="crayon-h"> </span><span class="crayon-s">''</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a103f9ecedf5154067704-9">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecedf5154067704-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">username</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-s">''</span><span class="crayon-h"> </span><span class="crayon-o">||</span><span class="crayon-h"> </span><span class="crayon-v">password</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-s">''</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a103f9ecedf5154067704-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">res</span><span class="crayon-sy">.</span><span class="crayon-e">status</span><span class="crayon-sy">(</span><span class="crayon-cn">401</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecedf5154067704-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">res</span><span class="crayon-sy">.</span><span class="crayon-e">json</span><span class="crayon-sy">(</span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a103f9ecedf5154067704-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"status"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">401</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecedf5154067704-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"message"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"Invalid credentials"</span></div><div class="crayon-line" id="crayon-5a103f9ecedf5154067704-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecedf5154067704-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a103f9ecedf5154067704-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecedf5154067704-18">&nbsp;</div><div class="crayon-line" id="crayon-5a103f9ecedf5154067704-19"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Fire a query to your DB and check if the credentials are valid</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecedf5154067704-20"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">dbUserObj</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">auth</span><span class="crayon-sy">.</span><span class="crayon-e">validate</span><span class="crayon-sy">(</span><span class="crayon-v">username</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">password</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a103f9ecedf5154067704-21"><span class="crayon-h">&nbsp;&nbsp; </span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecedf5154067704-22"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-o">!</span><span class="crayon-v">dbUserObj</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-h"> </span><span class="crayon-c">// If authentication fails, we send a 401 back</span></div><div class="crayon-line" id="crayon-5a103f9ecedf5154067704-23"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">res</span><span class="crayon-sy">.</span><span class="crayon-e">status</span><span class="crayon-sy">(</span><span class="crayon-cn">401</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecedf5154067704-24"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">res</span><span class="crayon-sy">.</span><span class="crayon-e">json</span><span class="crayon-sy">(</span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a103f9ecedf5154067704-25"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"status"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">401</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecedf5154067704-26"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"message"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"Invalid credentials"</span></div><div class="crayon-line" id="crayon-5a103f9ecedf5154067704-27"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecedf5154067704-28"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a103f9ecedf5154067704-29"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecedf5154067704-30">&nbsp;</div><div class="crayon-line" id="crayon-5a103f9ecedf5154067704-31"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">dbUserObj</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecedf5154067704-32">&nbsp;</div><div class="crayon-line" id="crayon-5a103f9ecedf5154067704-33"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// If authentication is success, we will generate a token</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecedf5154067704-34"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// and dispatch it to the client</span></div><div class="crayon-line" id="crayon-5a103f9ecedf5154067704-35">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecedf5154067704-36"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">res</span><span class="crayon-sy">.</span><span class="crayon-e">json</span><span class="crayon-sy">(</span><span class="crayon-e">genToken</span><span class="crayon-sy">(</span><span class="crayon-v">dbUserObj</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a103f9ecedf5154067704-37"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecedf5154067704-38">&nbsp;</div><div class="crayon-line" id="crayon-5a103f9ecedf5154067704-39"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecedf5154067704-40">&nbsp;</div><div class="crayon-line" id="crayon-5a103f9ecedf5154067704-41"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">validate</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-v">username</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">password</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecedf5154067704-42"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// spoofing the DB response for simplicity</span></div><div class="crayon-line" id="crayon-5a103f9ecedf5154067704-43"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">dbUserObj</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-h"> </span><span class="crayon-c">// spoofing a userobject from the DB. </span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecedf5154067704-44"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">name</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">'arvind'</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5a103f9ecedf5154067704-45"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">role</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">'admin'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecedf5154067704-46"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">username</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">'<a href="./cdn-cgi/l/email-protection/index.html" class="__cf_email__" data-cfemail="81e0f3f7e8efe5c1ecf8e0f1f1afe2eeec">[email&#160;protected]</a>'</span></div><div class="crayon-line" id="crayon-5a103f9ecedf5154067704-47"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecedf5154067704-48">&nbsp;</div><div class="crayon-line" id="crayon-5a103f9ecedf5154067704-49"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">dbUserObj</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecedf5154067704-50"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5a103f9ecedf5154067704-51">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecedf5154067704-52"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">validateUser</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-v">username</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a103f9ecedf5154067704-53"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// spoofing the DB response for simplicity</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecedf5154067704-54"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">dbUserObj</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-h"> </span><span class="crayon-c">// spoofing a userobject from the DB. </span></div><div class="crayon-line" id="crayon-5a103f9ecedf5154067704-55"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">name</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">'arvind'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecedf5154067704-56"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">role</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">'admin'</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5a103f9ecedf5154067704-57"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">username</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">'<a href="./cdn-cgi/l/email-protection/index.html" class="__cf_email__" data-cfemail="4e2f3c3827202a0e23372f3e3e602d2123">[email&#160;protected]</a>'</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecedf5154067704-58"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a103f9ecedf5154067704-59">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecedf5154067704-60"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">dbUserObj</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a103f9ecedf5154067704-61"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecedf5154067704-62"><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5a103f9ecedf5154067704-63">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecedf5154067704-64"><span class="crayon-c">// private method</span></div><div class="crayon-line" id="crayon-5a103f9ecedf5154067704-65"><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-e">genToken</span><span class="crayon-sy">(</span><span class="crayon-v">user</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecedf5154067704-66"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">expires</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">expiresIn</span><span class="crayon-sy">(</span><span class="crayon-cn">7</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// 7 days</span></div><div class="crayon-line" id="crayon-5a103f9ecedf5154067704-67"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">token</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">jwt</span><span class="crayon-sy">.</span><span class="crayon-e">encode</span><span class="crayon-sy">(</span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecedf5154067704-68"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">exp</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">expires</span></div><div class="crayon-line" id="crayon-5a103f9ecedf5154067704-69"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">require</span><span class="crayon-sy">(</span><span class="crayon-s">'../config/secret'</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecedf5154067704-70">&nbsp;</div><div class="crayon-line" id="crayon-5a103f9ecedf5154067704-71"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecedf5154067704-72"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">token</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">token</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5a103f9ecedf5154067704-73"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">expires</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">expires</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecedf5154067704-74"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">user</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">user</span></div><div class="crayon-line" id="crayon-5a103f9ecedf5154067704-75"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecedf5154067704-76"><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5a103f9ecedf5154067704-77">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecedf5154067704-78"><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-e">expiresIn</span><span class="crayon-sy">(</span><span class="crayon-v">numDays</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a103f9ecedf5154067704-79"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">dateObj</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">new</span><span class="crayon-h"> </span><span class="crayon-r">Date</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecedf5154067704-80"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">dateObj</span><span class="crayon-sy">.</span><span class="crayon-e">setDate</span><span class="crayon-sy">(</span><span class="crayon-v">dateObj</span><span class="crayon-sy">.</span><span class="crayon-e">getDate</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">numDays</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a103f9ecedf5154067704-81"><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecedf5154067704-82">&nbsp;</div><div class="crayon-line" id="crayon-5a103f9ecedf5154067704-83"><span class="crayon-v">module</span><span class="crayon-sy">.</span><span class="crayon-v">exports</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">auth</span><span class="crayon-sy">;</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0286 seconds] -->
<p>Things to notice</p>
<p><strong>Line 10</strong> : If the username or password is invalid/not present, we will throw a 401</p>
<p><strong>Line 20 </strong>: At this point, we will fire a call to DB and check if the credentials are valid. To keep this example simple, I have spoofed the response as a success &amp; built a dummy DB response.</p>
<p><strong>Line 23</strong> : If the authentication fails, we send back a 401</p>
<p><strong>Line 36</strong> : If everything is fine so far, we respond with a token</p>
<p><strong>Line 65</strong> : This method is responsible for generating the JSON response that is expected from the login endpoint.</p>
<p><strong>Line 67</strong> : Generates the token with the provided expiration date and a app secret. We will create the app secret in a minute. Do note that the app secret is the only hook with which the decoding happens. If you change the secret after you dispatch a token, it may not be valid when it comes back from a client.</p>
<p>Now, we will create the secret. Create a new folder named <em>config </em>inside the <em>server </em>folder. Inside the <em>config</em> folder create a new file named <em>secret.js</em> and update it as</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div id="crayon-5a103f9ecee00415872603" class="crayon-syntax crayon-theme-arduino-ide crayon-font-droid-sans-mono crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">server/config/secret.js</span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">JavaScript</span></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
module.exports = function() {
return 'super.super.secret.shhh';
}</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums" data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a103f9ecee00415872603-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee00415872603-2">2</div><div class="crayon-num" data-line="crayon-5a103f9ecee00415872603-3">3</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a103f9ecee00415872603-1"><span class="crayon-v">module</span><span class="crayon-sy">.</span><span class="crayon-v">exports</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee00415872603-2"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-s">'super.super.secret.shhh'</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a103f9ecee00415872603-3"><span class="crayon-sy">}</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0008 seconds] -->
<p>Now, we will create the dummy API for products and users. Create a file named <em>products.js</em> inside the <em>routes</em> folder and update it as below</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div id="crayon-5a103f9ecee08551966711" class="crayon-syntax crayon-theme-arduino-ide crayon-font-droid-sans-mono crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">routes/products.js</span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">JavaScript</span></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
var products = {
getAll: function(req, res) {
var allProducts = data; // Spoof a DB call
res.json(allProducts);
},
getOne: function(req, res) {
var id = req.params.id;
var product = data[0]; // Spoof a DB call
res.json(product);
},
create: function(req, res) {
var newProduct = req.body;
data.push(newProduct); // Spoof a DB call
res.json(newProduct);
},
update: function(req, res) {
var updateProduct = req.body;
var id = req.params.id;
data[id] = updateProduct // Spoof a DB call
res.json(updateProduct);
},
delete: function(req, res) {
var id = req.params.id;
data.splice(id, 1) // Spoof a DB call
res.json(true);
}
};
var data = [{
name: 'product 1',
id: '1'
}, {
name: 'product 2',
id: '2'
}, {
name: 'product 3',
id: '3'
}];
module.exports = products;</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums" data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a103f9ecee08551966711-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee08551966711-2">2</div><div class="crayon-num" data-line="crayon-5a103f9ecee08551966711-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee08551966711-4">4</div><div class="crayon-num" data-line="crayon-5a103f9ecee08551966711-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee08551966711-6">6</div><div class="crayon-num" data-line="crayon-5a103f9ecee08551966711-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee08551966711-8">8</div><div class="crayon-num" data-line="crayon-5a103f9ecee08551966711-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee08551966711-10">10</div><div class="crayon-num" data-line="crayon-5a103f9ecee08551966711-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee08551966711-12">12</div><div class="crayon-num" data-line="crayon-5a103f9ecee08551966711-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee08551966711-14">14</div><div class="crayon-num" data-line="crayon-5a103f9ecee08551966711-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee08551966711-16">16</div><div class="crayon-num" data-line="crayon-5a103f9ecee08551966711-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee08551966711-18">18</div><div class="crayon-num" data-line="crayon-5a103f9ecee08551966711-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee08551966711-20">20</div><div class="crayon-num" data-line="crayon-5a103f9ecee08551966711-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee08551966711-22">22</div><div class="crayon-num" data-line="crayon-5a103f9ecee08551966711-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee08551966711-24">24</div><div class="crayon-num" data-line="crayon-5a103f9ecee08551966711-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee08551966711-26">26</div><div class="crayon-num" data-line="crayon-5a103f9ecee08551966711-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee08551966711-28">28</div><div class="crayon-num" data-line="crayon-5a103f9ecee08551966711-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee08551966711-30">30</div><div class="crayon-num" data-line="crayon-5a103f9ecee08551966711-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee08551966711-32">32</div><div class="crayon-num" data-line="crayon-5a103f9ecee08551966711-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee08551966711-34">34</div><div class="crayon-num" data-line="crayon-5a103f9ecee08551966711-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee08551966711-36">36</div><div class="crayon-num" data-line="crayon-5a103f9ecee08551966711-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee08551966711-38">38</div><div class="crayon-num" data-line="crayon-5a103f9ecee08551966711-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee08551966711-40">40</div><div class="crayon-num" data-line="crayon-5a103f9ecee08551966711-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee08551966711-42">42</div><div class="crayon-num" data-line="crayon-5a103f9ecee08551966711-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee08551966711-44">44</div><div class="crayon-num" data-line="crayon-5a103f9ecee08551966711-45">45</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a103f9ecee08551966711-1"><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">products</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee08551966711-2">&nbsp;</div><div class="crayon-line" id="crayon-5a103f9ecee08551966711-3"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">getAll</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-v">req</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">res</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee08551966711-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">allProducts</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// Spoof a DB call</span></div><div class="crayon-line" id="crayon-5a103f9ecee08551966711-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">res</span><span class="crayon-sy">.</span><span class="crayon-e">json</span><span class="crayon-sy">(</span><span class="crayon-v">allProducts</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee08551966711-6"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5a103f9ecee08551966711-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee08551966711-8"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">getOne</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-v">req</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">res</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a103f9ecee08551966711-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">id</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">req</span><span class="crayon-sy">.</span><span class="crayon-v">params</span><span class="crayon-sy">.</span><span class="crayon-v">id</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee08551966711-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">product</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// Spoof a DB call</span></div><div class="crayon-line" id="crayon-5a103f9ecee08551966711-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">res</span><span class="crayon-sy">.</span><span class="crayon-e">json</span><span class="crayon-sy">(</span><span class="crayon-v">product</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee08551966711-12"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5a103f9ecee08551966711-13">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee08551966711-14"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">create</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-v">req</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">res</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a103f9ecee08551966711-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">newProduct</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">req</span><span class="crayon-sy">.</span><span class="crayon-v">body</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee08551966711-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">data</span><span class="crayon-sy">.</span><span class="crayon-e">push</span><span class="crayon-sy">(</span><span class="crayon-v">newProduct</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// Spoof a DB call</span></div><div class="crayon-line" id="crayon-5a103f9ecee08551966711-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">res</span><span class="crayon-sy">.</span><span class="crayon-e">json</span><span class="crayon-sy">(</span><span class="crayon-v">newProduct</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee08551966711-18"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5a103f9ecee08551966711-19">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee08551966711-20"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">update</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-v">req</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">res</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a103f9ecee08551966711-21"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">updateProduct</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">req</span><span class="crayon-sy">.</span><span class="crayon-v">body</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee08551966711-22"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">id</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">req</span><span class="crayon-sy">.</span><span class="crayon-v">params</span><span class="crayon-sy">.</span><span class="crayon-v">id</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a103f9ecee08551966711-23"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">data</span><span class="crayon-sy">[</span><span class="crayon-v">id</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">updateProduct</span><span class="crayon-h"> </span><span class="crayon-c">// Spoof a DB call</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee08551966711-24"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">res</span><span class="crayon-sy">.</span><span class="crayon-e">json</span><span class="crayon-sy">(</span><span class="crayon-v">updateProduct</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a103f9ecee08551966711-25"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee08551966711-26">&nbsp;</div><div class="crayon-line" id="crayon-5a103f9ecee08551966711-27"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">delete</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-v">req</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">res</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee08551966711-28"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">id</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">req</span><span class="crayon-sy">.</span><span class="crayon-v">params</span><span class="crayon-sy">.</span><span class="crayon-v">id</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a103f9ecee08551966711-29"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">data</span><span class="crayon-sy">.</span><span class="crayon-e">splice</span><span class="crayon-sy">(</span><span class="crayon-v">id</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-c">// Spoof a DB call</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee08551966711-30"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">res</span><span class="crayon-sy">.</span><span class="crayon-e">json</span><span class="crayon-sy">(</span><span class="crayon-t">true</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a103f9ecee08551966711-31"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee08551966711-32"><span class="crayon-sy">}</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a103f9ecee08551966711-33">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee08551966711-34"><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a103f9ecee08551966711-35"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">name</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">'product 1'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee08551966711-36"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">id</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">'1'</span></div><div class="crayon-line" id="crayon-5a103f9ecee08551966711-37"><span class="crayon-sy">}</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee08551966711-38"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">name</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">'product 2'</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5a103f9ecee08551966711-39"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">id</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">'2'</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee08551966711-40"><span class="crayon-sy">}</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a103f9ecee08551966711-41"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">name</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">'product 3'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee08551966711-42"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">id</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">'3'</span></div><div class="crayon-line" id="crayon-5a103f9ecee08551966711-43"><span class="crayon-sy">}</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee08551966711-44">&nbsp;</div><div class="crayon-line" id="crayon-5a103f9ecee08551966711-45"><span class="crayon-v">module</span><span class="crayon-sy">.</span><span class="crayon-v">exports</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">products</span><span class="crayon-sy">;</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0185 seconds] -->
<p>And create another file named <em>users.js</em> and update it as below</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div id="crayon-5a103f9ecee10937581431" class="crayon-syntax crayon-theme-arduino-ide crayon-font-droid-sans-mono crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">server/routes/users.js</span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">JavaScript</span></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
var users = {
getAll: function(req, res) {
var allusers = data; // Spoof a DB call
res.json(allusers);
},
getOne: function(req, res) {
var id = req.params.id;
var user = data[0]; // Spoof a DB call
res.json(user);
},
create: function(req, res) {
var newuser = req.body;
data.push(newuser); // Spoof a DB call
res.json(newuser);
},
update: function(req, res) {
var updateuser = req.body;
var id = req.params.id;
data[id] = updateuser // Spoof a DB call
res.json(updateuser);
},
delete: function(req, res) {
var id = req.params.id;
data.splice(id, 1) // Spoof a DB call
res.json(true);
}
};
var data = [{
name: 'user 1',
id: '1'
}, {
name: 'user 2',
id: '2'
}, {
name: 'user 3',
id: '3'
}];
module.exports = users;</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums" data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a103f9ecee10937581431-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee10937581431-2">2</div><div class="crayon-num" data-line="crayon-5a103f9ecee10937581431-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee10937581431-4">4</div><div class="crayon-num" data-line="crayon-5a103f9ecee10937581431-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee10937581431-6">6</div><div class="crayon-num" data-line="crayon-5a103f9ecee10937581431-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee10937581431-8">8</div><div class="crayon-num" data-line="crayon-5a103f9ecee10937581431-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee10937581431-10">10</div><div class="crayon-num" data-line="crayon-5a103f9ecee10937581431-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee10937581431-12">12</div><div class="crayon-num" data-line="crayon-5a103f9ecee10937581431-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee10937581431-14">14</div><div class="crayon-num" data-line="crayon-5a103f9ecee10937581431-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee10937581431-16">16</div><div class="crayon-num" data-line="crayon-5a103f9ecee10937581431-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee10937581431-18">18</div><div class="crayon-num" data-line="crayon-5a103f9ecee10937581431-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee10937581431-20">20</div><div class="crayon-num" data-line="crayon-5a103f9ecee10937581431-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee10937581431-22">22</div><div class="crayon-num" data-line="crayon-5a103f9ecee10937581431-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee10937581431-24">24</div><div class="crayon-num" data-line="crayon-5a103f9ecee10937581431-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee10937581431-26">26</div><div class="crayon-num" data-line="crayon-5a103f9ecee10937581431-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee10937581431-28">28</div><div class="crayon-num" data-line="crayon-5a103f9ecee10937581431-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee10937581431-30">30</div><div class="crayon-num" data-line="crayon-5a103f9ecee10937581431-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee10937581431-32">32</div><div class="crayon-num" data-line="crayon-5a103f9ecee10937581431-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee10937581431-34">34</div><div class="crayon-num" data-line="crayon-5a103f9ecee10937581431-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee10937581431-36">36</div><div class="crayon-num" data-line="crayon-5a103f9ecee10937581431-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee10937581431-38">38</div><div class="crayon-num" data-line="crayon-5a103f9ecee10937581431-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee10937581431-40">40</div><div class="crayon-num" data-line="crayon-5a103f9ecee10937581431-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee10937581431-42">42</div><div class="crayon-num" data-line="crayon-5a103f9ecee10937581431-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee10937581431-44">44</div><div class="crayon-num" data-line="crayon-5a103f9ecee10937581431-45">45</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a103f9ecee10937581431-1"><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">users</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee10937581431-2">&nbsp;</div><div class="crayon-line" id="crayon-5a103f9ecee10937581431-3"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">getAll</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-v">req</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">res</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee10937581431-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">allusers</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// Spoof a DB call</span></div><div class="crayon-line" id="crayon-5a103f9ecee10937581431-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">res</span><span class="crayon-sy">.</span><span class="crayon-e">json</span><span class="crayon-sy">(</span><span class="crayon-v">allusers</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee10937581431-6"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5a103f9ecee10937581431-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee10937581431-8"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">getOne</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-v">req</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">res</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a103f9ecee10937581431-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">id</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">req</span><span class="crayon-sy">.</span><span class="crayon-v">params</span><span class="crayon-sy">.</span><span class="crayon-v">id</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee10937581431-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">user</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// Spoof a DB call</span></div><div class="crayon-line" id="crayon-5a103f9ecee10937581431-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">res</span><span class="crayon-sy">.</span><span class="crayon-e">json</span><span class="crayon-sy">(</span><span class="crayon-v">user</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee10937581431-12"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5a103f9ecee10937581431-13">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee10937581431-14"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">create</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-v">req</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">res</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a103f9ecee10937581431-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">newuser</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">req</span><span class="crayon-sy">.</span><span class="crayon-v">body</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee10937581431-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">data</span><span class="crayon-sy">.</span><span class="crayon-e">push</span><span class="crayon-sy">(</span><span class="crayon-v">newuser</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// Spoof a DB call</span></div><div class="crayon-line" id="crayon-5a103f9ecee10937581431-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">res</span><span class="crayon-sy">.</span><span class="crayon-e">json</span><span class="crayon-sy">(</span><span class="crayon-v">newuser</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee10937581431-18"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5a103f9ecee10937581431-19">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee10937581431-20"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">update</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-v">req</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">res</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a103f9ecee10937581431-21"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">updateuser</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">req</span><span class="crayon-sy">.</span><span class="crayon-v">body</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee10937581431-22"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">id</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">req</span><span class="crayon-sy">.</span><span class="crayon-v">params</span><span class="crayon-sy">.</span><span class="crayon-v">id</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a103f9ecee10937581431-23"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">data</span><span class="crayon-sy">[</span><span class="crayon-v">id</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">updateuser</span><span class="crayon-h"> </span><span class="crayon-c">// Spoof a DB call</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee10937581431-24"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">res</span><span class="crayon-sy">.</span><span class="crayon-e">json</span><span class="crayon-sy">(</span><span class="crayon-v">updateuser</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a103f9ecee10937581431-25"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee10937581431-26">&nbsp;</div><div class="crayon-line" id="crayon-5a103f9ecee10937581431-27"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">delete</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-v">req</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">res</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee10937581431-28"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">id</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">req</span><span class="crayon-sy">.</span><span class="crayon-v">params</span><span class="crayon-sy">.</span><span class="crayon-v">id</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a103f9ecee10937581431-29"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">data</span><span class="crayon-sy">.</span><span class="crayon-e">splice</span><span class="crayon-sy">(</span><span class="crayon-v">id</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-c">// Spoof a DB call</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee10937581431-30"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">res</span><span class="crayon-sy">.</span><span class="crayon-e">json</span><span class="crayon-sy">(</span><span class="crayon-t">true</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a103f9ecee10937581431-31"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee10937581431-32"><span class="crayon-sy">}</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a103f9ecee10937581431-33">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee10937581431-34"><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a103f9ecee10937581431-35"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">name</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">'user 1'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee10937581431-36"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">id</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">'1'</span></div><div class="crayon-line" id="crayon-5a103f9ecee10937581431-37"><span class="crayon-sy">}</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee10937581431-38"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">name</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">'user 2'</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5a103f9ecee10937581431-39"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">id</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">'2'</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee10937581431-40"><span class="crayon-sy">}</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a103f9ecee10937581431-41"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">name</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">'user 3'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee10937581431-42"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">id</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">'3'</span></div><div class="crayon-line" id="crayon-5a103f9ecee10937581431-43"><span class="crayon-sy">}</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee10937581431-44">&nbsp;</div><div class="crayon-line" id="crayon-5a103f9ecee10937581431-45"><span class="crayon-v">module</span><span class="crayon-sy">.</span><span class="crayon-v">exports</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">users</span><span class="crayon-sy">;</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0234 seconds] -->
<p>Now, we will create the validation middleware. Create a new folder named <em>middleware </em> inside the <em>server</em> folder. Inside the <i>middleware </i>folder create a new file named <em>validateRequest.js</em>. This will be the validation layer for the API requests.</p>
<p>Update <em>validateRequest.js</em> as below</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div id="crayon-5a103f9ecee19759726994" class="crayon-syntax crayon-theme-arduino-ide crayon-font-droid-sans-mono crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">server/middlewares/validateRequest.js</span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">JavaScript</span></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
var jwt = require('jwt-simple');
var validateUser = require('../routes/auth').validateUser;
module.exports = function(req, res, next) {
// When performing a cross domain request, you will recieve
// a preflighted request first. This is to check if our the app
// is safe. 
// We skip the token outh for [OPTIONS] requests.
//if(req.method == 'OPTIONS') next();
var token = (req.body &amp;&amp; req.body.access_token) || (req.query &amp;&amp; req.query.access_token) || req.headers['x-access-token'];
var key = (req.body &amp;&amp; req.body.x_key) || (req.query &amp;&amp; req.query.x_key) || req.headers['x-key'];
if (token || key) {
try {
var decoded = jwt.decode(token, require('../config/secret.js')());
if (decoded.exp &lt;= Date.now()) {
res.status(400);
res.json({
"status": 400,
"message": "Token Expired"
});
return;
}
// Authorize the user to see if s/he can access our resources
var dbUser = validateUser(key); // The key would be the logged in user's username
if (dbUser) {
if ((req.url.indexOf('admin') &gt;= 0 &amp;&amp; dbUser.role == 'admin') || (req.url.indexOf('admin') &lt; 0 &amp;&amp; req.url.indexOf('/api/v1/') &gt;= 0)) {
next(); // To move to next middleware
} else {
res.status(403);
res.json({
"status": 403,
"message": "Not Authorized"
});
return;
}
} else {
// No user with this name exists, respond back with a 401
res.status(401);
res.json({
"status": 401,
"message": "Invalid User"
});
return;
}
} catch (err) {
res.status(500);
res.json({
"status": 500,
"message": "Oops something went wrong",
"error": err
});
}
} else {
res.status(401);
res.json({
"status": 401,
"message": "Invalid Token or Key"
});
return;
}
};</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums" data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a103f9ecee19759726994-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee19759726994-2">2</div><div class="crayon-num" data-line="crayon-5a103f9ecee19759726994-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee19759726994-4">4</div><div class="crayon-num" data-line="crayon-5a103f9ecee19759726994-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee19759726994-6">6</div><div class="crayon-num" data-line="crayon-5a103f9ecee19759726994-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee19759726994-8">8</div><div class="crayon-num" data-line="crayon-5a103f9ecee19759726994-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee19759726994-10">10</div><div class="crayon-num" data-line="crayon-5a103f9ecee19759726994-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee19759726994-12">12</div><div class="crayon-num" data-line="crayon-5a103f9ecee19759726994-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee19759726994-14">14</div><div class="crayon-num" data-line="crayon-5a103f9ecee19759726994-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee19759726994-16">16</div><div class="crayon-num" data-line="crayon-5a103f9ecee19759726994-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee19759726994-18">18</div><div class="crayon-num" data-line="crayon-5a103f9ecee19759726994-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee19759726994-20">20</div><div class="crayon-num" data-line="crayon-5a103f9ecee19759726994-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee19759726994-22">22</div><div class="crayon-num" data-line="crayon-5a103f9ecee19759726994-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee19759726994-24">24</div><div class="crayon-num" data-line="crayon-5a103f9ecee19759726994-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee19759726994-26">26</div><div class="crayon-num" data-line="crayon-5a103f9ecee19759726994-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee19759726994-28">28</div><div class="crayon-num" data-line="crayon-5a103f9ecee19759726994-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee19759726994-30">30</div><div class="crayon-num" data-line="crayon-5a103f9ecee19759726994-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee19759726994-32">32</div><div class="crayon-num" data-line="crayon-5a103f9ecee19759726994-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee19759726994-34">34</div><div class="crayon-num" data-line="crayon-5a103f9ecee19759726994-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee19759726994-36">36</div><div class="crayon-num" data-line="crayon-5a103f9ecee19759726994-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee19759726994-38">38</div><div class="crayon-num" data-line="crayon-5a103f9ecee19759726994-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee19759726994-40">40</div><div class="crayon-num" data-line="crayon-5a103f9ecee19759726994-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee19759726994-42">42</div><div class="crayon-num" data-line="crayon-5a103f9ecee19759726994-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee19759726994-44">44</div><div class="crayon-num" data-line="crayon-5a103f9ecee19759726994-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee19759726994-46">46</div><div class="crayon-num" data-line="crayon-5a103f9ecee19759726994-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee19759726994-48">48</div><div class="crayon-num" data-line="crayon-5a103f9ecee19759726994-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee19759726994-50">50</div><div class="crayon-num" data-line="crayon-5a103f9ecee19759726994-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee19759726994-52">52</div><div class="crayon-num" data-line="crayon-5a103f9ecee19759726994-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee19759726994-54">54</div><div class="crayon-num" data-line="crayon-5a103f9ecee19759726994-55">55</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee19759726994-56">56</div><div class="crayon-num" data-line="crayon-5a103f9ecee19759726994-57">57</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee19759726994-58">58</div><div class="crayon-num" data-line="crayon-5a103f9ecee19759726994-59">59</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee19759726994-60">60</div><div class="crayon-num" data-line="crayon-5a103f9ecee19759726994-61">61</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee19759726994-62">62</div><div class="crayon-num" data-line="crayon-5a103f9ecee19759726994-63">63</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee19759726994-64">64</div><div class="crayon-num" data-line="crayon-5a103f9ecee19759726994-65">65</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee19759726994-66">66</div><div class="crayon-num" data-line="crayon-5a103f9ecee19759726994-67">67</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee19759726994-68">68</div><div class="crayon-num" data-line="crayon-5a103f9ecee19759726994-69">69</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee19759726994-70">70</div><div class="crayon-num" data-line="crayon-5a103f9ecee19759726994-71">71</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a103f9ecee19759726994-1"><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">jwt</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">require</span><span class="crayon-sy">(</span><span class="crayon-s">'jwt-simple'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee19759726994-2"><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">validateUser</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">require</span><span class="crayon-sy">(</span><span class="crayon-s">'../routes/auth'</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-v">validateUser</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a103f9ecee19759726994-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee19759726994-4"><span class="crayon-v">module</span><span class="crayon-sy">.</span><span class="crayon-v">exports</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-v">req</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">res</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">next</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a103f9ecee19759726994-5">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee19759726994-6"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">// When performing a cross domain request, you will recieve</span></div><div class="crayon-line" id="crayon-5a103f9ecee19759726994-7"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">// a preflighted request first. This is to check if our the app</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee19759726994-8"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">// is safe. </span></div><div class="crayon-line" id="crayon-5a103f9ecee19759726994-9">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee19759726994-10"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">// We skip the token outh for [OPTIONS] requests.</span></div><div class="crayon-line" id="crayon-5a103f9ecee19759726994-11"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">//if(req.method == 'OPTIONS') next();</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee19759726994-12">&nbsp;</div><div class="crayon-line" id="crayon-5a103f9ecee19759726994-13"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">token</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">req</span><span class="crayon-sy">.</span><span class="crayon-v">body</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-v">req</span><span class="crayon-sy">.</span><span class="crayon-v">body</span><span class="crayon-sy">.</span><span class="crayon-v">access_token</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">||</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">req</span><span class="crayon-sy">.</span><span class="crayon-v">query</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-v">req</span><span class="crayon-sy">.</span><span class="crayon-v">query</span><span class="crayon-sy">.</span><span class="crayon-v">access_token</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">||</span><span class="crayon-h"> </span><span class="crayon-v">req</span><span class="crayon-sy">.</span><span class="crayon-v">headers</span><span class="crayon-sy">[</span><span class="crayon-s">'x-access-token'</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee19759726994-14"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">key</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">req</span><span class="crayon-sy">.</span><span class="crayon-v">body</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-v">req</span><span class="crayon-sy">.</span><span class="crayon-v">body</span><span class="crayon-sy">.</span><span class="crayon-v">x_key</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">||</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">req</span><span class="crayon-sy">.</span><span class="crayon-v">query</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-v">req</span><span class="crayon-sy">.</span><span class="crayon-v">query</span><span class="crayon-sy">.</span><span class="crayon-v">x_key</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">||</span><span class="crayon-h"> </span><span class="crayon-v">req</span><span class="crayon-sy">.</span><span class="crayon-v">headers</span><span class="crayon-sy">[</span><span class="crayon-s">'x-key'</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a103f9ecee19759726994-15">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee19759726994-16"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">token</span><span class="crayon-h"> </span><span class="crayon-o">||</span><span class="crayon-h"> </span><span class="crayon-v">key</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a103f9ecee19759726994-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">try</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee19759726994-18"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">decoded</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">jwt</span><span class="crayon-sy">.</span><span class="crayon-e">decode</span><span class="crayon-sy">(</span><span class="crayon-v">token</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">require</span><span class="crayon-sy">(</span><span class="crayon-s">'../config/secret.js'</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a103f9ecee19759726994-19">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee19759726994-20"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">decoded</span><span class="crayon-sy">.</span><span class="crayon-v">exp</span><span class="crayon-h"> </span><span class="crayon-o">&lt;=</span><span class="crayon-h"> </span><span class="crayon-v">Date</span><span class="crayon-sy">.</span><span class="crayon-e">now</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a103f9ecee19759726994-21"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">res</span><span class="crayon-sy">.</span><span class="crayon-e">status</span><span class="crayon-sy">(</span><span class="crayon-cn">400</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee19759726994-22"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">res</span><span class="crayon-sy">.</span><span class="crayon-e">json</span><span class="crayon-sy">(</span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a103f9ecee19759726994-23"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"status"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">400</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee19759726994-24"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"message"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"Token Expired"</span></div><div class="crayon-line" id="crayon-5a103f9ecee19759726994-25"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee19759726994-26"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a103f9ecee19759726994-27"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee19759726994-28">&nbsp;</div><div class="crayon-line" id="crayon-5a103f9ecee19759726994-29"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Authorize the user to see if s/he can access our resources</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee19759726994-30">&nbsp;</div><div class="crayon-line" id="crayon-5a103f9ecee19759726994-31"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">dbUser</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">validateUser</span><span class="crayon-sy">(</span><span class="crayon-v">key</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// The key would be the logged in user's username</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee19759726994-32"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">dbUser</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a103f9ecee19759726994-33">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee19759726994-34">&nbsp;</div><div class="crayon-line" id="crayon-5a103f9ecee19759726994-35"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">req</span><span class="crayon-sy">.</span><span class="crayon-v">url</span><span class="crayon-sy">.</span><span class="crayon-e">indexOf</span><span class="crayon-sy">(</span><span class="crayon-s">'admin'</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&gt;=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-v">dbUser</span><span class="crayon-sy">.</span><span class="crayon-v">role</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-s">'admin'</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">||</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">req</span><span class="crayon-sy">.</span><span class="crayon-v">url</span><span class="crayon-sy">.</span><span class="crayon-e">indexOf</span><span class="crayon-sy">(</span><span class="crayon-s">'admin'</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-v">req</span><span class="crayon-sy">.</span><span class="crayon-v">url</span><span class="crayon-sy">.</span><span class="crayon-e">indexOf</span><span class="crayon-sy">(</span><span class="crayon-s">'/api/v1/'</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&gt;=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee19759726994-36"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">next</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// To move to next middleware</span></div><div class="crayon-line" id="crayon-5a103f9ecee19759726994-37"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee19759726994-38"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">res</span><span class="crayon-sy">.</span><span class="crayon-e">status</span><span class="crayon-sy">(</span><span class="crayon-cn">403</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a103f9ecee19759726994-39"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">res</span><span class="crayon-sy">.</span><span class="crayon-e">json</span><span class="crayon-sy">(</span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee19759726994-40"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"status"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">403</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5a103f9ecee19759726994-41"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"message"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"Not Authorized"</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee19759726994-42"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a103f9ecee19759726994-43"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee19759726994-44"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5a103f9ecee19759726994-45"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee19759726994-46"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// No user with this name exists, respond back with a 401</span></div><div class="crayon-line" id="crayon-5a103f9ecee19759726994-47"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">res</span><span class="crayon-sy">.</span><span class="crayon-e">status</span><span class="crayon-sy">(</span><span class="crayon-cn">401</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee19759726994-48"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">res</span><span class="crayon-sy">.</span><span class="crayon-e">json</span><span class="crayon-sy">(</span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a103f9ecee19759726994-49"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"status"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">401</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee19759726994-50"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"message"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"Invalid User"</span></div><div class="crayon-line" id="crayon-5a103f9ecee19759726994-51"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee19759726994-52"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a103f9ecee19759726994-53"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee19759726994-54">&nbsp;</div><div class="crayon-line" id="crayon-5a103f9ecee19759726994-55"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-st">catch</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">err</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee19759726994-56"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">res</span><span class="crayon-sy">.</span><span class="crayon-e">status</span><span class="crayon-sy">(</span><span class="crayon-cn">500</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a103f9ecee19759726994-57"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">res</span><span class="crayon-sy">.</span><span class="crayon-e">json</span><span class="crayon-sy">(</span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee19759726994-58"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"status"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">500</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5a103f9ecee19759726994-59"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"message"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"Oops something went wrong"</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee19759726994-60"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"error"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">err</span></div><div class="crayon-line" id="crayon-5a103f9ecee19759726994-61"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee19759726994-62"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5a103f9ecee19759726994-63"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee19759726994-64"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">res</span><span class="crayon-sy">.</span><span class="crayon-e">status</span><span class="crayon-sy">(</span><span class="crayon-cn">401</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a103f9ecee19759726994-65"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">res</span><span class="crayon-sy">.</span><span class="crayon-e">json</span><span class="crayon-sy">(</span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee19759726994-66"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"status"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">401</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5a103f9ecee19759726994-67"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"message"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"Invalid Token or Key"</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee19759726994-68"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a103f9ecee19759726994-69"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee19759726994-70"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5a103f9ecee19759726994-71"><span class="crayon-sy">}</span><span class="crayon-sy">;</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0342 seconds] -->
<p>Things to notice</p>
<p><strong>Line 13,14</strong> : We search for a token/key and in the request. This is the access token we have issued post successful login and key is the current logged in user&#8217;s username.</p>
<p><strong>Line 18</strong> : We decode the token and check its validity on line 20</p>
<p><strong>Line 31</strong> : We hit the DB to check if the current user is a valid user and also fetch his role.</p>
<p><strong>Line 35</strong> : We validate role vs url accessed and allow or deny accordingly.</p>
<p>All the other else cases would dispatch appropriate HTTP status codes.</p>
<p>That is all we need to build a secure REST API.</p>
<h2>Testing the REST API</h2>
<p>The process is pretty simple. First, we will fire a request to the <em>login</em> end point with dummy credentials. The response will contain a user object and the access token. Since we have spoofed the response to be a success, you will get a success response always. In your actual app, update this login to valid authentication.</p>
<p>Using that access token, we will make further request to our API.</p>
<p>I will be using CURL to fire the REST requests, you can use any REST client to do so.</p>
<p>Start our server by running</p>
<p style="text-align: center;">
<span id="crayon-5a103f9ecee25662242123" class="crayon-syntax crayon-syntax-inline  crayon-theme-arduino-ide crayon-theme-arduino-ide-inline crayon-font-droid-sans-mono" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-e">node </span><span class="crayon-v">server</span><span class="crayon-sy">.</span><span class="crayon-v">js</span></span></span>  or 
<span id="crayon-5a103f9ecee2b489492467" class="crayon-syntax crayon-syntax-inline  crayon-theme-arduino-ide crayon-theme-arduino-ide-inline crayon-font-droid-sans-mono" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-e">nodemon </span><span class="crayon-v">server</span><span class="crayon-sy">.</span><span class="crayon-v">js</span></span></span></p>
<h3>Brute Force</h3>
<p>Without any token, let us fire a request to get all the products</p>
<p><strong>URL</strong> : curl http://localhost:3000/api/v1/products</p>
<p><a href="http://i2.wp.com/thejackalofjavascript.com/wp-content/uploads/2014/09/Screen-Shot-2014-09-21-at-11.25.11-pm.png" data-rel="lightbox-1" title=""><img class="size-full wp-image-2095 aligncenter" src="http://i0.wp.com/thejackalofjavascript.com/wp-content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="http://i2.wp.com/thejackalofjavascript.com/wp-content/uploads/2014/09/Screen-Shot-2014-09-21-at-11.25.11-pm.png?resize=353%2C41" alt="Screen Shot 2014-09-21 at 11.25.11 pm" data-recalc-dims="1" /><noscript><img class="size-full wp-image-2095 aligncenter" src="http://i2.wp.com/thejackalofjavascript.com/wp-content/uploads/2014/09/Screen-Shot-2014-09-21-at-11.25.11-pm.png?resize=353%2C41" alt="Screen Shot 2014-09-21 at 11.25.11 pm" data-recalc-dims="1" /></noscript></a></p>
<p>As expected you will get a 401. You can also dispatch a 403 unauthorized here.</p>
<h3>Login</h3>
<p>Now, let us try logging in.</p>
<p><strong>URL</strong> : curl &#8211;data &#8220;{\&#8221;username\&#8221; : \&#8221;<a href="./cdn-cgi/l/email-protection/index.html" class="__cf_email__" data-cfemail="61001317080f05210c180011114f020e0c">[email&#160;protected]</a>\&#8221;, \&#8221;password\&#8221; : \&#8221;pass123\&#8221;}&#8221; -H &#8220;content-type:application/json&#8221; http://localhost:3000/login</p>
<p>The username and password above are dummy. Do notice the header content-type. Without this, Bodyparser will not kick in. And the response would consist of a token and the user object.</p>
<p><a href="http://i1.wp.com/thejackalofjavascript.com/wp-content/uploads/2014/09/Screen-Shot-2014-09-21-at-11.30.01-pm.png" data-rel="lightbox-2" title=""><img class="size-medium wp-image-2097 aligncenter" src="http://i0.wp.com/thejackalofjavascript.com/wp-content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="http://i0.wp.com/thejackalofjavascript.com/wp-content/uploads/2014/09/Screen-Shot-2014-09-21-at-11.30.01-pm-451x38.png?resize=451%2C38" alt="Screen Shot 2014-09-21 at 11.30.01 pm" data-recalc-dims="1" /><noscript><img class="size-medium wp-image-2097 aligncenter" src="http://i0.wp.com/thejackalofjavascript.com/wp-content/uploads/2014/09/Screen-Shot-2014-09-21-at-11.30.01-pm-451x38.png?resize=451%2C38" alt="Screen Shot 2014-09-21 at 11.30.01 pm" data-recalc-dims="1" /></noscript></a></p>
<p>Now, we will make a copy of the token and we need to send this in the headers from now on.</p>
<h3>Fetch Products</h3>
<p>To fetch all products, you would run</p>
<p><strong>URL</strong> : curl -H &#8220;content-type:application/json&#8221; -H &#8220;x-access-token:eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJleHAiOjE0MTE5MjcyMDAzNjl9.cuUKFKsf2qhQJHToP-zBmObhMwi84rhnrhH03OdyzSA&#8221; -H &#8220;x-key:<a href="./cdn-cgi/l/email-protection/index.html" class="__cf_email__" data-cfemail="badbc8ccd3d4defad7c3dbcaca94d9d5d7">[email&#160;protected]</a>&#8221; http://localhost:3000/api/v1/products</p>
<p><em>Do notice that I have updated the token in the above URL. Make sure you update the token before firing the request.</em></p>
<p>Do notice that we have another header named key. This will consist of the current logged in user&#8217;s username.</p>
<p>And we would get the response back as</p>
<h3><a href="http://i2.wp.com/thejackalofjavascript.com/wp-content/uploads/2014/09/Screen-Shot-2014-09-21-at-11.35.18-pm.png" data-rel="lightbox-3" title=""><img class="size-medium wp-image-2098 aligncenter" src="http://i0.wp.com/thejackalofjavascript.com/wp-content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="http://i2.wp.com/thejackalofjavascript.com/wp-content/uploads/2014/09/Screen-Shot-2014-09-21-at-11.35.18-pm-451x29.png?resize=451%2C29" alt="Screen Shot 2014-09-21 at 11.35.18 pm" data-recalc-dims="1" /><noscript><img class="size-medium wp-image-2098 aligncenter" src="http://i2.wp.com/thejackalofjavascript.com/wp-content/uploads/2014/09/Screen-Shot-2014-09-21-at-11.35.18-pm-451x29.png?resize=451%2C29" alt="Screen Shot 2014-09-21 at 11.35.18 pm" data-recalc-dims="1" /></noscript></a>Admin resources</h3>
<p>Since we have hardcoded the role for the current user to be admin, we will be able to access the admin URL&#8217;s too. You can fire a request like</p>
<p><strong>URL</strong> : curl -H &#8220;content-type:application/json&#8221; -H &#8220;x-access-token:eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJleHAiOjE0MTE5MjcyMDAzNjl9.cuUKFKsf2qhQJHToP-zBmObhMwi84rhnrhH03OdyzSA&#8221; -H &#8220;x-key:<a href="./cdn-cgi/l/email-protection/index.html" class="__cf_email__" data-cfemail="0b6a797d62656f4b66726a7b7b25686466">[email&#160;protected]</a>&#8221; http://localhost:3000/api/v1/admin/users</p>
<p>And you should see the response like</p>
<p><a href="http://i1.wp.com/thejackalofjavascript.com/wp-content/uploads/2014/09/Screen-Shot-2014-09-21-at-11.37.08-pm.png" data-rel="lightbox-4" title=""><img class="size-medium wp-image-2099 aligncenter" src="http://i0.wp.com/thejackalofjavascript.com/wp-content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="http://i0.wp.com/thejackalofjavascript.com/wp-content/uploads/2014/09/Screen-Shot-2014-09-21-at-11.37.08-pm-451x30.png?resize=451%2C30" alt="Screen Shot 2014-09-21 at 11.37.08 pm" data-recalc-dims="1" /><noscript><img class="size-medium wp-image-2099 aligncenter" src="http://i0.wp.com/thejackalofjavascript.com/wp-content/uploads/2014/09/Screen-Shot-2014-09-21-at-11.37.08-pm-451x30.png?resize=451%2C30" alt="Screen Shot 2014-09-21 at 11.37.08 pm" data-recalc-dims="1" /></noscript></a>Now, let us test the authorization part. Navigate to <i>routes/auth.js</i> line 56, set the role to &#8216;user&#8217; and restart the server</p>
<p>Now, fire the request to get all users</p>
<p><strong>URL</strong> : curl -H &#8220;content-type:application/json&#8221; -H &#8220;x-access-token:eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJleHAiOjE0MTE5MjcyMDAzNjl9.cuUKFKsf2qhQJHToP-zBmObhMwi84rhnrhH03OdyzSA&#8221; -H &#8220;x-key:<a href="./cdn-cgi/l/email-protection/index.html" class="__cf_email__" data-cfemail="f69784809f9892b69b8f978686d895999b">[email&#160;protected]</a>&#8221; http://localhost:3000/api/v1/admin/users</p>
<p>and you should see a &#8220;Not Authorized&#8221; error as expected.<a href="http://i1.wp.com/thejackalofjavascript.com/wp-content/uploads/2014/09/Screen-Shot-2014-09-21-at-11.40.59-pm.png" data-rel="lightbox-5" title=""><img class="size-medium wp-image-2100 aligncenter" src="http://i0.wp.com/thejackalofjavascript.com/wp-content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="http://i0.wp.com/thejackalofjavascript.com/wp-content/uploads/2014/09/Screen-Shot-2014-09-21-at-11.40.59-pm-451x29.png?resize=451%2C29" alt="Screen Shot 2014-09-21 at 11.40.59 pm" data-recalc-dims="1" /><noscript><img class="size-medium wp-image-2100 aligncenter" src="http://i0.wp.com/thejackalofjavascript.com/wp-content/uploads/2014/09/Screen-Shot-2014-09-21-at-11.40.59-pm-451x29.png?resize=451%2C29" alt="Screen Shot 2014-09-21 at 11.40.59 pm" data-recalc-dims="1" /></noscript></a>Simple and easy right!!</p>
<h2>Angular.js Client</h2>
<p>Now, we will build an Angular.js client that will consume the above API. Inside the <em>myRESTApp</em> folder, create another folder named <em>ngClient</em>. Open a new terminal/prompt here.</p>
<p>We will use a slush generator named <a href="https://github.com/arvindr21/slush-ng" onclick="__gaTracker('send', 'event', 'outbound-article', 'https://github.com/arvindr21/slush-ng', 'slush-ng');" title="slush-ng"  target="_blank">slush-ng</a> (<em>written by me</em>) to scaffold a minimal Angular.js app. For that we will install gulp, slush and slush-ng globally. Execute</p>
<div class="table-responsive"><table  style="width:100%; "  class="easy-table easy-table-default" border="0">
<thead>
<tr><th >Windows</th>
<th > Mac/*nix</th>
</tr>
</thead>
<tbody>
<tr><td >
<span id="crayon-5a103f9ecee3a844764178" class="crayon-syntax crayon-syntax-inline  crayon-theme-arduino-ide crayon-theme-arduino-ide-inline crayon-font-droid-sans-mono" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-i">npm</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">g</span><span class="crayon-h"> </span><span class="crayon-e">gulp </span><span class="crayon-e">slush </span><span class="crayon-v">slush</span><span class="crayon-o">-</span><span class="crayon-v">ng</span></span></span> </td>
<td > 
<span id="crayon-5a103f9ecee41041416883" class="crayon-syntax crayon-syntax-inline  crayon-theme-arduino-ide crayon-theme-arduino-ide-inline crayon-font-droid-sans-mono" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-e">sudo </span><span class="crayon-i">npm</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">g</span><span class="crayon-h"> </span><span class="crayon-e">gulp </span><span class="crayon-e">slush </span><span class="crayon-v">slush</span><span class="crayon-o">-</span><span class="crayon-v">ng</span></span></span></td>
</tr>
</tbody></table></div>
<p>Once this is done, from inside the <em>ngClient </em>folder, run</p>
<p style="text-align: center;">
<span id="crayon-5a103f9ecee47611185890" class="crayon-syntax crayon-syntax-inline  crayon-theme-arduino-ide crayon-theme-arduino-ide-inline crayon-font-droid-sans-mono" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-e">slush </span><span class="crayon-v">ng</span></span></span></p>
<p>You can provide any name to your project. And slush will scaffold a minimal angular app and download the required dependencies.</p>
<p>To run the Angular.js app as is, we will run</p>
<p style="text-align: center;">
<span id="crayon-5a103f9ecee4e647907994" class="crayon-syntax crayon-syntax-inline  crayon-theme-arduino-ide crayon-theme-arduino-ide-inline crayon-font-droid-sans-mono" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">gulp</span></span></span></p>
<p>This will start a new server on port 2772. Now you can navigate to 
<span id="crayon-5a103f9ecee54582977666" class="crayon-syntax crayon-syntax-inline  crayon-theme-arduino-ide crayon-theme-arduino-ide-inline crayon-font-droid-sans-mono" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">http</span><span class="crayon-o">:</span><span class="crayon-c">//localhost:2772</span></span></span> to see the scaffolded app in action.</p>
<p>This app is configured with routes, a sample directive a sample filter and an integration with the service layer. All you need to start off with a minimal Angular.js app.</p>
<h3>Authentication Layer</h3>
<p>The first thing we are going to do is setup an authentication factory on the client. Create a new folder named <em>auth </em>inside the <em>js</em> folder. Inside this folder, create a new file named <em>auth.factory.js</em>.</p>
<p>Update <em>auth.factory.js</em> as below</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div id="crayon-5a103f9ecee5a229807085" class="crayon-syntax crayon-theme-arduino-ide crayon-font-droid-sans-mono crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">ngClient/js/factory/auth.factory.js</span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">JavaScript</span></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
myApp.factory('AuthenticationFactory', function($window) {
var auth = {
isLogged: false,
check: function() {
if ($window.sessionStorage.token &amp;&amp; $window.sessionStorage.user) {
this.isLogged = true;
} else {
this.isLogged = false;
delete this.user;
}
}
}
return auth;
});
myApp.factory('UserAuthFactory', function($window, $location, $http, AuthenticationFactory) {
return {
login: function(username, password) {
return $http.post('http://localhost:3000/login', {
username: username,
password: password
});
},
logout: function() {
if (AuthenticationFactory.isLogged) {
AuthenticationFactory.isLogged = false;
delete AuthenticationFactory.user;
delete AuthenticationFactory.userRole;
delete $window.sessionStorage.token;
delete $window.sessionStorage.user;
delete $window.sessionStorage.userRole;
$location.path("/login");
}
}
}
});
myApp.factory('TokenInterceptor', function($q, $window) {
return {
request: function(config) {
config.headers = config.headers || {};
if ($window.sessionStorage.token) {
config.headers['X-Access-Token'] = $window.sessionStorage.token;
config.headers['X-Key'] = $window.sessionStorage.user;
config.headers['Content-Type'] = "application/json";
}
return config || $q.when(config);
},
response: function(response) {
return response || $q.when(response);
}
};
});</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums" data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a103f9ecee5a229807085-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee5a229807085-2">2</div><div class="crayon-num" data-line="crayon-5a103f9ecee5a229807085-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee5a229807085-4">4</div><div class="crayon-num" data-line="crayon-5a103f9ecee5a229807085-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee5a229807085-6">6</div><div class="crayon-num" data-line="crayon-5a103f9ecee5a229807085-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee5a229807085-8">8</div><div class="crayon-num" data-line="crayon-5a103f9ecee5a229807085-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee5a229807085-10">10</div><div class="crayon-num" data-line="crayon-5a103f9ecee5a229807085-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee5a229807085-12">12</div><div class="crayon-num" data-line="crayon-5a103f9ecee5a229807085-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee5a229807085-14">14</div><div class="crayon-num" data-line="crayon-5a103f9ecee5a229807085-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee5a229807085-16">16</div><div class="crayon-num" data-line="crayon-5a103f9ecee5a229807085-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee5a229807085-18">18</div><div class="crayon-num" data-line="crayon-5a103f9ecee5a229807085-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee5a229807085-20">20</div><div class="crayon-num" data-line="crayon-5a103f9ecee5a229807085-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee5a229807085-22">22</div><div class="crayon-num" data-line="crayon-5a103f9ecee5a229807085-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee5a229807085-24">24</div><div class="crayon-num" data-line="crayon-5a103f9ecee5a229807085-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee5a229807085-26">26</div><div class="crayon-num" data-line="crayon-5a103f9ecee5a229807085-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee5a229807085-28">28</div><div class="crayon-num" data-line="crayon-5a103f9ecee5a229807085-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee5a229807085-30">30</div><div class="crayon-num" data-line="crayon-5a103f9ecee5a229807085-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee5a229807085-32">32</div><div class="crayon-num" data-line="crayon-5a103f9ecee5a229807085-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee5a229807085-34">34</div><div class="crayon-num" data-line="crayon-5a103f9ecee5a229807085-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee5a229807085-36">36</div><div class="crayon-num" data-line="crayon-5a103f9ecee5a229807085-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee5a229807085-38">38</div><div class="crayon-num" data-line="crayon-5a103f9ecee5a229807085-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee5a229807085-40">40</div><div class="crayon-num" data-line="crayon-5a103f9ecee5a229807085-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee5a229807085-42">42</div><div class="crayon-num" data-line="crayon-5a103f9ecee5a229807085-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee5a229807085-44">44</div><div class="crayon-num" data-line="crayon-5a103f9ecee5a229807085-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee5a229807085-46">46</div><div class="crayon-num" data-line="crayon-5a103f9ecee5a229807085-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee5a229807085-48">48</div><div class="crayon-num" data-line="crayon-5a103f9ecee5a229807085-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee5a229807085-50">50</div><div class="crayon-num" data-line="crayon-5a103f9ecee5a229807085-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee5a229807085-52">52</div><div class="crayon-num" data-line="crayon-5a103f9ecee5a229807085-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee5a229807085-54">54</div><div class="crayon-num" data-line="crayon-5a103f9ecee5a229807085-55">55</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee5a229807085-56">56</div><div class="crayon-num" data-line="crayon-5a103f9ecee5a229807085-57">57</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee5a229807085-58">58</div><div class="crayon-num" data-line="crayon-5a103f9ecee5a229807085-59">59</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee5a229807085-60">60</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a103f9ecee5a229807085-1"><span class="crayon-v">myApp</span><span class="crayon-sy">.</span><span class="crayon-e">factory</span><span class="crayon-sy">(</span><span class="crayon-s">'AuthenticationFactory'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-r">window</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee5a229807085-2"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">auth</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a103f9ecee5a229807085-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">isLogged</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-t">false</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee5a229807085-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">check</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a103f9ecee5a229807085-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">window</span><span class="crayon-sy">.</span><span class="crayon-v">sessionStorage</span><span class="crayon-sy">.</span><span class="crayon-v">token</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">window</span><span class="crayon-sy">.</span><span class="crayon-v">sessionStorage</span><span class="crayon-sy">.</span><span class="crayon-v">user</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee5a229807085-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">this</span><span class="crayon-sy">.</span><span class="crayon-v">isLogged</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">true</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a103f9ecee5a229807085-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee5a229807085-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">this</span><span class="crayon-sy">.</span><span class="crayon-v">isLogged</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">false</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a103f9ecee5a229807085-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">delete</span><span class="crayon-h"> </span><span class="crayon-r">this</span><span class="crayon-sy">.</span><span class="crayon-v">user</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee5a229807085-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5a103f9ecee5a229807085-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee5a229807085-12"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5a103f9ecee5a229807085-13">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee5a229807085-14"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">auth</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a103f9ecee5a229807085-15"><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee5a229807085-16">&nbsp;</div><div class="crayon-line" id="crayon-5a103f9ecee5a229807085-17"><span class="crayon-v">myApp</span><span class="crayon-sy">.</span><span class="crayon-e">factory</span><span class="crayon-sy">(</span><span class="crayon-s">'UserAuthFactory'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-r">window</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-r">location</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">http</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">AuthenticationFactory</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee5a229807085-18"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a103f9ecee5a229807085-19"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">login</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-v">username</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">password</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee5a229807085-20"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">http</span><span class="crayon-sy">.</span><span class="crayon-e">post</span><span class="crayon-sy">(</span><span class="crayon-s">'http://localhost:3000/login'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a103f9ecee5a229807085-21"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">username</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">username</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee5a229807085-22"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">password</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">password</span></div><div class="crayon-line" id="crayon-5a103f9ecee5a229807085-23"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee5a229807085-24"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5a103f9ecee5a229807085-25"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">logout</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee5a229807085-26">&nbsp;</div><div class="crayon-line" id="crayon-5a103f9ecee5a229807085-27"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">AuthenticationFactory</span><span class="crayon-sy">.</span><span class="crayon-v">isLogged</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee5a229807085-28">&nbsp;</div><div class="crayon-line" id="crayon-5a103f9ecee5a229807085-29"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">AuthenticationFactory</span><span class="crayon-sy">.</span><span class="crayon-v">isLogged</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">false</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee5a229807085-30"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">delete</span><span class="crayon-h"> </span><span class="crayon-v">AuthenticationFactory</span><span class="crayon-sy">.</span><span class="crayon-v">user</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a103f9ecee5a229807085-31"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">delete</span><span class="crayon-h"> </span><span class="crayon-v">AuthenticationFactory</span><span class="crayon-sy">.</span><span class="crayon-v">userRole</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee5a229807085-32">&nbsp;</div><div class="crayon-line" id="crayon-5a103f9ecee5a229807085-33"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">delete</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">window</span><span class="crayon-sy">.</span><span class="crayon-v">sessionStorage</span><span class="crayon-sy">.</span><span class="crayon-v">token</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee5a229807085-34"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">delete</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">window</span><span class="crayon-sy">.</span><span class="crayon-v">sessionStorage</span><span class="crayon-sy">.</span><span class="crayon-v">user</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a103f9ecee5a229807085-35"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">delete</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">window</span><span class="crayon-sy">.</span><span class="crayon-v">sessionStorage</span><span class="crayon-sy">.</span><span class="crayon-v">userRole</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee5a229807085-36">&nbsp;</div><div class="crayon-line" id="crayon-5a103f9ecee5a229807085-37"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">location</span><span class="crayon-sy">.</span><span class="crayon-e">path</span><span class="crayon-sy">(</span><span class="crayon-s">"/login"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee5a229807085-38"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5a103f9ecee5a229807085-39">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee5a229807085-40"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5a103f9ecee5a229807085-41"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee5a229807085-42"><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a103f9ecee5a229807085-43">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee5a229807085-44"><span class="crayon-v">myApp</span><span class="crayon-sy">.</span><span class="crayon-e">factory</span><span class="crayon-sy">(</span><span class="crayon-s">'TokenInterceptor'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">q</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-r">window</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a103f9ecee5a229807085-45"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee5a229807085-46"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">request</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-v">config</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a103f9ecee5a229807085-47"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">config</span><span class="crayon-sy">.</span><span class="crayon-v">headers</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">config</span><span class="crayon-sy">.</span><span class="crayon-v">headers</span><span class="crayon-h"> </span><span class="crayon-o">||</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-sy">}</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee5a229807085-48"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">window</span><span class="crayon-sy">.</span><span class="crayon-v">sessionStorage</span><span class="crayon-sy">.</span><span class="crayon-v">token</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a103f9ecee5a229807085-49"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">config</span><span class="crayon-sy">.</span><span class="crayon-v">headers</span><span class="crayon-sy">[</span><span class="crayon-s">'X-Access-Token'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">window</span><span class="crayon-sy">.</span><span class="crayon-v">sessionStorage</span><span class="crayon-sy">.</span><span class="crayon-v">token</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee5a229807085-50"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">config</span><span class="crayon-sy">.</span><span class="crayon-v">headers</span><span class="crayon-sy">[</span><span class="crayon-s">'X-Key'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">window</span><span class="crayon-sy">.</span><span class="crayon-v">sessionStorage</span><span class="crayon-sy">.</span><span class="crayon-v">user</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a103f9ecee5a229807085-51"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">config</span><span class="crayon-sy">.</span><span class="crayon-v">headers</span><span class="crayon-sy">[</span><span class="crayon-s">'Content-Type'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"application/json"</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee5a229807085-52"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5a103f9ecee5a229807085-53"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">config</span><span class="crayon-h"> </span><span class="crayon-o">||</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">q</span><span class="crayon-sy">.</span><span class="crayon-e">when</span><span class="crayon-sy">(</span><span class="crayon-v">config</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee5a229807085-54"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5a103f9ecee5a229807085-55">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee5a229807085-56"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">response</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-v">response</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a103f9ecee5a229807085-57"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">response</span><span class="crayon-h"> </span><span class="crayon-o">||</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">q</span><span class="crayon-sy">.</span><span class="crayon-e">when</span><span class="crayon-sy">(</span><span class="crayon-v">response</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee5a229807085-58"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5a103f9ecee5a229807085-59"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee5a229807085-60"><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0136 seconds] -->
<p>Things to notice</p>
<p><strong>Line 1</strong> : <em>AuthenticationFactory. </em>This Factory is responsible for checking the user status on the client side.</p>
<p><strong>Line 17</strong> : <em>UserAuthFactory</em>. This factory is responsible for contacting the <em>login</em> endpoint and validating the user. And also logging out the user.</p>
<p><strong>Line 44</strong> : <em>TokenInterceptor</em>. This factory is responsible for sending in the access token and the key along with each request to the server.</p>
<p>Next, we will create a controller to manage the login. Create a file named <em>auth.controller.js</em> inside the <em>auth</em> folder. Update it as below</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div id="crayon-5a103f9ecee65894021846" class="crayon-syntax crayon-theme-arduino-ide crayon-font-droid-sans-mono crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">ngClient/js/auth/auth.controller.js</span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">JavaScript</span></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
myApp.controller('LoginCtrl', ['$scope', '$window', '$location', 'UserAuthFactory', 'AuthenticationFactory',
function($scope, $window, $location, UserAuthFactory, AuthenticationFactory) {
$scope.user = {
username: 'arvind@myApp.com',
password: 'pass123'
};
$scope.login = function() {
var username = $scope.user.username,
password = $scope.user.password;
if (username !== undefined &amp;&amp; password !== undefined) {
UserAuthFactory.login(username, password).success(function(data) {
AuthenticationFactory.isLogged = true;
AuthenticationFactory.user = data.user.username;
AuthenticationFactory.userRole = data.user.role;
$window.sessionStorage.token = data.token;
$window.sessionStorage.user = data.user.username; // to fetch the user details on refresh
$window.sessionStorage.userRole = data.user.role; // to fetch the user details on refresh
$location.path("/");
}).error(function(status) {
alert('Oops something went wrong!');
});
} else {
alert('Invalid credentials');
}
};
}
]);</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums" data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a103f9ecee65894021846-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee65894021846-2">2</div><div class="crayon-num" data-line="crayon-5a103f9ecee65894021846-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee65894021846-4">4</div><div class="crayon-num" data-line="crayon-5a103f9ecee65894021846-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee65894021846-6">6</div><div class="crayon-num" data-line="crayon-5a103f9ecee65894021846-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee65894021846-8">8</div><div class="crayon-num" data-line="crayon-5a103f9ecee65894021846-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee65894021846-10">10</div><div class="crayon-num" data-line="crayon-5a103f9ecee65894021846-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee65894021846-12">12</div><div class="crayon-num" data-line="crayon-5a103f9ecee65894021846-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee65894021846-14">14</div><div class="crayon-num" data-line="crayon-5a103f9ecee65894021846-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee65894021846-16">16</div><div class="crayon-num" data-line="crayon-5a103f9ecee65894021846-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee65894021846-18">18</div><div class="crayon-num" data-line="crayon-5a103f9ecee65894021846-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee65894021846-20">20</div><div class="crayon-num" data-line="crayon-5a103f9ecee65894021846-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee65894021846-22">22</div><div class="crayon-num" data-line="crayon-5a103f9ecee65894021846-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee65894021846-24">24</div><div class="crayon-num" data-line="crayon-5a103f9ecee65894021846-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee65894021846-26">26</div><div class="crayon-num" data-line="crayon-5a103f9ecee65894021846-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee65894021846-28">28</div><div class="crayon-num" data-line="crayon-5a103f9ecee65894021846-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee65894021846-30">30</div><div class="crayon-num" data-line="crayon-5a103f9ecee65894021846-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee65894021846-32">32</div><div class="crayon-num" data-line="crayon-5a103f9ecee65894021846-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee65894021846-34">34</div><div class="crayon-num" data-line="crayon-5a103f9ecee65894021846-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee65894021846-36">36</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a103f9ecee65894021846-1"><span class="crayon-v">myApp</span><span class="crayon-sy">.</span><span class="crayon-e">controller</span><span class="crayon-sy">(</span><span class="crayon-s">'LoginCtrl'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'$scope'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'$window'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'$location'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'UserAuthFactory'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'AuthenticationFactory'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee65894021846-2"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">scope</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-r">window</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-r">location</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">UserAuthFactory</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">AuthenticationFactory</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a103f9ecee65894021846-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">scope</span><span class="crayon-sy">.</span><span class="crayon-v">user</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee65894021846-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">username</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">'<a href="./cdn-cgi/l/email-protection/index.html" class="__cf_email__" data-cfemail="d6b7a4a0bfb8b296bbaf97a6a6f8b5b9bb">[email&#160;protected]</a>'</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5a103f9ecee65894021846-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">password</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">'pass123'</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee65894021846-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a103f9ecee65894021846-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee65894021846-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">scope</span><span class="crayon-sy">.</span><span class="crayon-v">login</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a103f9ecee65894021846-9">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee65894021846-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">username</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">scope</span><span class="crayon-sy">.</span><span class="crayon-v">user</span><span class="crayon-sy">.</span><span class="crayon-v">username</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5a103f9ecee65894021846-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">password</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">scope</span><span class="crayon-sy">.</span><span class="crayon-v">user</span><span class="crayon-sy">.</span><span class="crayon-v">password</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee65894021846-12">&nbsp;</div><div class="crayon-line" id="crayon-5a103f9ecee65894021846-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">username</span><span class="crayon-h"> </span><span class="crayon-o">!==</span><span class="crayon-h"> </span><span class="crayon-v">undefined</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-v">password</span><span class="crayon-h"> </span><span class="crayon-o">!==</span><span class="crayon-h"> </span><span class="crayon-v">undefined</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee65894021846-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">UserAuthFactory</span><span class="crayon-sy">.</span><span class="crayon-e">login</span><span class="crayon-sy">(</span><span class="crayon-v">username</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">password</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">success</span><span class="crayon-sy">(</span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a103f9ecee65894021846-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee65894021846-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">AuthenticationFactory</span><span class="crayon-sy">.</span><span class="crayon-v">isLogged</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">true</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a103f9ecee65894021846-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">AuthenticationFactory</span><span class="crayon-sy">.</span><span class="crayon-v">user</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">.</span><span class="crayon-v">user</span><span class="crayon-sy">.</span><span class="crayon-v">username</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee65894021846-18"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">AuthenticationFactory</span><span class="crayon-sy">.</span><span class="crayon-v">userRole</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">.</span><span class="crayon-v">user</span><span class="crayon-sy">.</span><span class="crayon-v">role</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a103f9ecee65894021846-19">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee65894021846-20"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">window</span><span class="crayon-sy">.</span><span class="crayon-v">sessionStorage</span><span class="crayon-sy">.</span><span class="crayon-v">token</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">.</span><span class="crayon-v">token</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a103f9ecee65894021846-21"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">window</span><span class="crayon-sy">.</span><span class="crayon-v">sessionStorage</span><span class="crayon-sy">.</span><span class="crayon-v">user</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">.</span><span class="crayon-v">user</span><span class="crayon-sy">.</span><span class="crayon-v">username</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// to fetch the user details on refresh</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee65894021846-22"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">window</span><span class="crayon-sy">.</span><span class="crayon-v">sessionStorage</span><span class="crayon-sy">.</span><span class="crayon-v">userRole</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">.</span><span class="crayon-v">user</span><span class="crayon-sy">.</span><span class="crayon-v">role</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// to fetch the user details on refresh</span></div><div class="crayon-line" id="crayon-5a103f9ecee65894021846-23">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee65894021846-24"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">location</span><span class="crayon-sy">.</span><span class="crayon-e">path</span><span class="crayon-sy">(</span><span class="crayon-s">"/"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a103f9ecee65894021846-25">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee65894021846-26"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">error</span><span class="crayon-sy">(</span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-r">status</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a103f9ecee65894021846-27"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">alert</span><span class="crayon-sy">(</span><span class="crayon-s">'Oops something went wrong!'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee65894021846-28"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a103f9ecee65894021846-29"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee65894021846-30"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">alert</span><span class="crayon-sy">(</span><span class="crayon-s">'Invalid credentials'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a103f9ecee65894021846-31"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee65894021846-32">&nbsp;</div><div class="crayon-line" id="crayon-5a103f9ecee65894021846-33"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee65894021846-34">&nbsp;</div><div class="crayon-line" id="crayon-5a103f9ecee65894021846-35"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee65894021846-36"><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0095 seconds] -->
<p>Things to notice</p>
<p><strong>Line 3</strong> : We hard code a user, for easy testing (<em>lazy</em>)</p>
<p><strong>Line 14</strong> : We fire a request to the Login endpoint</p>
<p><strong>Line 16 &#8211; 22</strong> : We set client side session variables. We store the values in the <em>AuthenticationFactory</em> as well as <em>sessionStorage</em>. This way, if the user refreshes, we will still have the session on the client side.</p>
<p><strong>Line 24</strong> : Upon successful login, we will redirect the user to the home page.</p>
<p>On the client side, we will create a partial for Login. Inside the <em>partials </em>folder, create a new file named <em>login.html</em> and update it as below</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div id="crayon-5a103f9ecee6f825488614" class="crayon-syntax crayon-theme-arduino-ide crayon-font-droid-sans-mono crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">ngClient/partials/login.html</span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
&lt;legend&gt;Login Form&lt;/legend&gt;
&lt;div class="form-group"&gt;
&lt;label for="username"&gt;Username&lt;/label&gt;
&lt;input type="text" class="form-control" id="username" placeholder="Username" ng-model="user.username"&gt;
&lt;/div&gt;
&lt;div class="form-group"&gt;
&lt;label for="password"&gt;Password&lt;/label&gt;
&lt;input type="password" class="form-control" id="password" placeholder="Password" ng-model="user.password"&gt;
&lt;/div&gt;
&lt;button type="button" ng-click="login()" class="btn btn-primary"&gt;Submit&lt;/button&gt;</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums" data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a103f9ecee6f825488614-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee6f825488614-2">2</div><div class="crayon-num" data-line="crayon-5a103f9ecee6f825488614-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee6f825488614-4">4</div><div class="crayon-num" data-line="crayon-5a103f9ecee6f825488614-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee6f825488614-6">6</div><div class="crayon-num" data-line="crayon-5a103f9ecee6f825488614-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee6f825488614-8">8</div><div class="crayon-num" data-line="crayon-5a103f9ecee6f825488614-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee6f825488614-10">10</div><div class="crayon-num" data-line="crayon-5a103f9ecee6f825488614-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee6f825488614-12">12</div><div class="crayon-num" data-line="crayon-5a103f9ecee6f825488614-13">13</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a103f9ecee6f825488614-1"><span class="crayon-o">&lt;</span><span class="crayon-v">legend</span><span class="crayon-o">&gt;</span><span class="crayon-e">Login </span><span class="crayon-v">Form</span><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-v">legend</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee6f825488614-2">&nbsp;</div><div class="crayon-line" id="crayon-5a103f9ecee6f825488614-3"><span class="crayon-o">&lt;</span><span class="crayon-e">div </span><span class="crayon-t">class</span><span class="crayon-o">=</span><span class="crayon-s">"form-group"</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee6f825488614-4"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">label </span><span class="crayon-st">for</span><span class="crayon-o">=</span><span class="crayon-s">"username"</span><span class="crayon-o">&gt;</span><span class="crayon-v">Username</span><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-v">label</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-5a103f9ecee6f825488614-5"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"text"</span><span class="crayon-h"> </span><span class="crayon-t">class</span><span class="crayon-o">=</span><span class="crayon-s">"form-control"</span><span class="crayon-h"> </span><span class="crayon-v">id</span><span class="crayon-o">=</span><span class="crayon-s">"username"</span><span class="crayon-h"> </span><span class="crayon-v">placeholder</span><span class="crayon-o">=</span><span class="crayon-s">"Username"</span><span class="crayon-h"> </span><span class="crayon-v">ng</span><span class="crayon-o">-</span><span class="crayon-v">model</span><span class="crayon-o">=</span><span class="crayon-s">"user.username"</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee6f825488614-6"><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-v">div</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-5a103f9ecee6f825488614-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee6f825488614-8"><span class="crayon-o">&lt;</span><span class="crayon-e">div </span><span class="crayon-t">class</span><span class="crayon-o">=</span><span class="crayon-s">"form-group"</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-5a103f9ecee6f825488614-9"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">label </span><span class="crayon-st">for</span><span class="crayon-o">=</span><span class="crayon-s">"password"</span><span class="crayon-o">&gt;</span><span class="crayon-v">Password</span><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-v">label</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee6f825488614-10"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"password"</span><span class="crayon-h"> </span><span class="crayon-t">class</span><span class="crayon-o">=</span><span class="crayon-s">"form-control"</span><span class="crayon-h"> </span><span class="crayon-v">id</span><span class="crayon-o">=</span><span class="crayon-s">"password"</span><span class="crayon-h"> </span><span class="crayon-v">placeholder</span><span class="crayon-o">=</span><span class="crayon-s">"Password"</span><span class="crayon-h"> </span><span class="crayon-v">ng</span><span class="crayon-o">-</span><span class="crayon-v">model</span><span class="crayon-o">=</span><span class="crayon-s">"user.password"</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-5a103f9ecee6f825488614-11"><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-v">div</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee6f825488614-12">&nbsp;</div><div class="crayon-line" id="crayon-5a103f9ecee6f825488614-13"><span class="crayon-o">&lt;</span><span class="crayon-e">button </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"button"</span><span class="crayon-h"> </span><span class="crayon-v">ng</span><span class="crayon-o">-</span><span class="crayon-v">click</span><span class="crayon-o">=</span><span class="crayon-s">"login()"</span><span class="crayon-h"> </span><span class="crayon-t">class</span><span class="crayon-o">=</span><span class="crayon-s">"btn btn-primary"</span><span class="crayon-o">&gt;</span><span class="crayon-v">Submit</span><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-v">button</span><span class="crayon-o">&gt;</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0047 seconds] -->
<p>This partial will be associated with a Login Controller, which we created in <em>auth.controller.js</em>.</p>
<p>Now, we will setup our app. Open <i>js/app.js</i> and update it as below</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div id="crayon-5a103f9ecee76391520106" class="crayon-syntax crayon-theme-arduino-ide crayon-font-droid-sans-mono crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">ngClient/js/app.js</span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">JavaScript</span></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
var myApp = angular.module('ngclient', ['ngRoute']);
myApp.config(function($routeProvider, $httpProvider) {
$httpProvider.interceptors.push('TokenInterceptor');
$routeProvider
.when('/login', {
templateUrl: 'partials/login.html',
controller: 'LoginCtrl',
access: {
requiredLogin: false
}
}).when('/', {
templateUrl: 'partials/home.html',
controller: 'HomeCtrl',
access: {
requiredLogin: true
}
}).when('/page1', {
templateUrl: 'partials/page1.html',
controller: 'Page1Ctrl',
access: {
requiredLogin: true
}
}).when('/page2', {
templateUrl: 'partials/page2.html',
controller: 'Page2Ctrl',
access: {
requiredLogin: true
}
}).when('/page3', {
templateUrl: 'partials/page3.html',
controller: 'Page3Ctrl',
access: {
requiredLogin: true
}
}).otherwise({
redirectTo: '/login'
});
});
myApp.run(function($rootScope, $window, $location, AuthenticationFactory) {
// when the page refreshes, check if the user is already logged in
AuthenticationFactory.check();
$rootScope.$on("$routeChangeStart", function(event, nextRoute, currentRoute) {
if ((nextRoute.access &amp;&amp; nextRoute.access.requiredLogin) &amp;&amp; !AuthenticationFactory.isLogged) {
$location.path("/login");
} else {
// check if user object exists else fetch it. This is incase of a page refresh
if (!AuthenticationFactory.user) AuthenticationFactory.user = $window.sessionStorage.user;
if (!AuthenticationFactory.userRole) AuthenticationFactory.userRole = $window.sessionStorage.userRole;
}
});
$rootScope.$on('$routeChangeSuccess', function(event, nextRoute, currentRoute) {
$rootScope.showMenu = AuthenticationFactory.isLogged;
$rootScope.role = AuthenticationFactory.userRole;
// if the user is already logged in, take him to the home page
if (AuthenticationFactory.isLogged == true &amp;&amp; $location.path() == '/login') {
$location.path('/');
}
});
});</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums" data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a103f9ecee76391520106-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee76391520106-2">2</div><div class="crayon-num" data-line="crayon-5a103f9ecee76391520106-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee76391520106-4">4</div><div class="crayon-num" data-line="crayon-5a103f9ecee76391520106-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee76391520106-6">6</div><div class="crayon-num" data-line="crayon-5a103f9ecee76391520106-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee76391520106-8">8</div><div class="crayon-num" data-line="crayon-5a103f9ecee76391520106-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee76391520106-10">10</div><div class="crayon-num" data-line="crayon-5a103f9ecee76391520106-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee76391520106-12">12</div><div class="crayon-num" data-line="crayon-5a103f9ecee76391520106-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee76391520106-14">14</div><div class="crayon-num" data-line="crayon-5a103f9ecee76391520106-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee76391520106-16">16</div><div class="crayon-num" data-line="crayon-5a103f9ecee76391520106-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee76391520106-18">18</div><div class="crayon-num" data-line="crayon-5a103f9ecee76391520106-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee76391520106-20">20</div><div class="crayon-num" data-line="crayon-5a103f9ecee76391520106-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee76391520106-22">22</div><div class="crayon-num" data-line="crayon-5a103f9ecee76391520106-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee76391520106-24">24</div><div class="crayon-num" data-line="crayon-5a103f9ecee76391520106-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee76391520106-26">26</div><div class="crayon-num" data-line="crayon-5a103f9ecee76391520106-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee76391520106-28">28</div><div class="crayon-num" data-line="crayon-5a103f9ecee76391520106-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee76391520106-30">30</div><div class="crayon-num" data-line="crayon-5a103f9ecee76391520106-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee76391520106-32">32</div><div class="crayon-num" data-line="crayon-5a103f9ecee76391520106-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee76391520106-34">34</div><div class="crayon-num" data-line="crayon-5a103f9ecee76391520106-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee76391520106-36">36</div><div class="crayon-num" data-line="crayon-5a103f9ecee76391520106-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee76391520106-38">38</div><div class="crayon-num" data-line="crayon-5a103f9ecee76391520106-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee76391520106-40">40</div><div class="crayon-num" data-line="crayon-5a103f9ecee76391520106-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee76391520106-42">42</div><div class="crayon-num" data-line="crayon-5a103f9ecee76391520106-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee76391520106-44">44</div><div class="crayon-num" data-line="crayon-5a103f9ecee76391520106-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee76391520106-46">46</div><div class="crayon-num" data-line="crayon-5a103f9ecee76391520106-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee76391520106-48">48</div><div class="crayon-num" data-line="crayon-5a103f9ecee76391520106-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee76391520106-50">50</div><div class="crayon-num" data-line="crayon-5a103f9ecee76391520106-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee76391520106-52">52</div><div class="crayon-num" data-line="crayon-5a103f9ecee76391520106-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee76391520106-54">54</div><div class="crayon-num" data-line="crayon-5a103f9ecee76391520106-55">55</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee76391520106-56">56</div><div class="crayon-num" data-line="crayon-5a103f9ecee76391520106-57">57</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee76391520106-58">58</div><div class="crayon-num" data-line="crayon-5a103f9ecee76391520106-59">59</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee76391520106-60">60</div><div class="crayon-num" data-line="crayon-5a103f9ecee76391520106-61">61</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee76391520106-62">62</div><div class="crayon-num" data-line="crayon-5a103f9ecee76391520106-63">63</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee76391520106-64">64</div><div class="crayon-num" data-line="crayon-5a103f9ecee76391520106-65">65</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a103f9ecee76391520106-1"><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">myApp</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">angular</span><span class="crayon-sy">.</span><span class="crayon-e">module</span><span class="crayon-sy">(</span><span class="crayon-s">'ngclient'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'ngRoute'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee76391520106-2">&nbsp;</div><div class="crayon-line" id="crayon-5a103f9ecee76391520106-3"><span class="crayon-v">myApp</span><span class="crayon-sy">.</span><span class="crayon-e">config</span><span class="crayon-sy">(</span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">routeProvider</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">httpProvider</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee76391520106-4">&nbsp;</div><div class="crayon-line" id="crayon-5a103f9ecee76391520106-5"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">httpProvider</span><span class="crayon-sy">.</span><span class="crayon-v">interceptors</span><span class="crayon-sy">.</span><span class="crayon-e">push</span><span class="crayon-sy">(</span><span class="crayon-s">'TokenInterceptor'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee76391520106-6">&nbsp;</div><div class="crayon-line" id="crayon-5a103f9ecee76391520106-7"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-i">routeProvider</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee76391520106-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">.</span><span class="crayon-e">when</span><span class="crayon-sy">(</span><span class="crayon-s">'/login'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a103f9ecee76391520106-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">templateUrl</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">'partials/login.html'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee76391520106-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">controller</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">'LoginCtrl'</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5a103f9ecee76391520106-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">access</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee76391520106-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">requiredLogin</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-t">false</span></div><div class="crayon-line" id="crayon-5a103f9ecee76391520106-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee76391520106-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">when</span><span class="crayon-sy">(</span><span class="crayon-s">'/'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a103f9ecee76391520106-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">templateUrl</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">'partials/home.html'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee76391520106-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">controller</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">'HomeCtrl'</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5a103f9ecee76391520106-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">access</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee76391520106-18"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">requiredLogin</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-t">true</span></div><div class="crayon-line" id="crayon-5a103f9ecee76391520106-19"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee76391520106-20"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">when</span><span class="crayon-sy">(</span><span class="crayon-s">'/page1'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a103f9ecee76391520106-21"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">templateUrl</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">'partials/page1.html'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee76391520106-22"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">controller</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">'Page1Ctrl'</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5a103f9ecee76391520106-23"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">access</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee76391520106-24"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">requiredLogin</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-t">true</span></div><div class="crayon-line" id="crayon-5a103f9ecee76391520106-25"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee76391520106-26"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">when</span><span class="crayon-sy">(</span><span class="crayon-s">'/page2'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a103f9ecee76391520106-27"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">templateUrl</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">'partials/page2.html'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee76391520106-28"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">controller</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">'Page2Ctrl'</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5a103f9ecee76391520106-29"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">access</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee76391520106-30"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">requiredLogin</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-t">true</span></div><div class="crayon-line" id="crayon-5a103f9ecee76391520106-31"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee76391520106-32"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">when</span><span class="crayon-sy">(</span><span class="crayon-s">'/page3'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a103f9ecee76391520106-33"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">templateUrl</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">'partials/page3.html'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee76391520106-34"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">controller</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">'Page3Ctrl'</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5a103f9ecee76391520106-35"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">access</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee76391520106-36"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">requiredLogin</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-t">true</span></div><div class="crayon-line" id="crayon-5a103f9ecee76391520106-37"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee76391520106-38"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">otherwise</span><span class="crayon-sy">(</span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a103f9ecee76391520106-39"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">redirectTo</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">'/login'</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee76391520106-40"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a103f9ecee76391520106-41"><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee76391520106-42">&nbsp;</div><div class="crayon-line" id="crayon-5a103f9ecee76391520106-43"><span class="crayon-v">myApp</span><span class="crayon-sy">.</span><span class="crayon-e">run</span><span class="crayon-sy">(</span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">rootScope</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-r">window</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-r">location</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">AuthenticationFactory</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee76391520106-44"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">// when the page refreshes, check if the user is already logged in</span></div><div class="crayon-line" id="crayon-5a103f9ecee76391520106-45"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">AuthenticationFactory</span><span class="crayon-sy">.</span><span class="crayon-e">check</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee76391520106-46">&nbsp;</div><div class="crayon-line" id="crayon-5a103f9ecee76391520106-47"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">rootScope</span><span class="crayon-sy">.</span><span class="crayon-sy">$</span><span class="crayon-e">on</span><span class="crayon-sy">(</span><span class="crayon-s">"$routeChangeStart"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-v">event</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">nextRoute</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">currentRoute</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee76391520106-48"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">nextRoute</span><span class="crayon-sy">.</span><span class="crayon-v">access</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-v">nextRoute</span><span class="crayon-sy">.</span><span class="crayon-v">access</span><span class="crayon-sy">.</span><span class="crayon-v">requiredLogin</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-o">!</span><span class="crayon-v">AuthenticationFactory</span><span class="crayon-sy">.</span><span class="crayon-v">isLogged</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a103f9ecee76391520106-49"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">location</span><span class="crayon-sy">.</span><span class="crayon-e">path</span><span class="crayon-sy">(</span><span class="crayon-s">"/login"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee76391520106-50"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a103f9ecee76391520106-51"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// check if user object exists else fetch it. This is incase of a page refresh</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee76391520106-52"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-o">!</span><span class="crayon-v">AuthenticationFactory</span><span class="crayon-sy">.</span><span class="crayon-v">user</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-v">AuthenticationFactory</span><span class="crayon-sy">.</span><span class="crayon-v">user</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">window</span><span class="crayon-sy">.</span><span class="crayon-v">sessionStorage</span><span class="crayon-sy">.</span><span class="crayon-v">user</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a103f9ecee76391520106-53"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-o">!</span><span class="crayon-v">AuthenticationFactory</span><span class="crayon-sy">.</span><span class="crayon-v">userRole</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-v">AuthenticationFactory</span><span class="crayon-sy">.</span><span class="crayon-v">userRole</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">window</span><span class="crayon-sy">.</span><span class="crayon-v">sessionStorage</span><span class="crayon-sy">.</span><span class="crayon-v">userRole</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee76391520106-54"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5a103f9ecee76391520106-55"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee76391520106-56">&nbsp;</div><div class="crayon-line" id="crayon-5a103f9ecee76391520106-57"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">rootScope</span><span class="crayon-sy">.</span><span class="crayon-sy">$</span><span class="crayon-e">on</span><span class="crayon-sy">(</span><span class="crayon-s">'$routeChangeSuccess'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-v">event</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">nextRoute</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">currentRoute</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee76391520106-58"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">rootScope</span><span class="crayon-sy">.</span><span class="crayon-v">showMenu</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">AuthenticationFactory</span><span class="crayon-sy">.</span><span class="crayon-v">isLogged</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a103f9ecee76391520106-59"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">rootScope</span><span class="crayon-sy">.</span><span class="crayon-v">role</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">AuthenticationFactory</span><span class="crayon-sy">.</span><span class="crayon-v">userRole</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee76391520106-60"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// if the user is already logged in, take him to the home page</span></div><div class="crayon-line" id="crayon-5a103f9ecee76391520106-61"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">AuthenticationFactory</span><span class="crayon-sy">.</span><span class="crayon-v">isLogged</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-t">true</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">location</span><span class="crayon-sy">.</span><span class="crayon-e">path</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-s">'/login'</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee76391520106-62"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">location</span><span class="crayon-sy">.</span><span class="crayon-e">path</span><span class="crayon-sy">(</span><span class="crayon-s">'/'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a103f9ecee76391520106-63"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee76391520106-64"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a103f9ecee76391520106-65"><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0166 seconds] -->
<p>Things to notice</p>
<p><strong>Line 5</strong> : We have added the <em>TokenInterceptor.</em></p>
<p><strong>Line 8</strong> : New route <em>/login</em></p>
<p><strong>Line 12,18,24,30,36</strong> : Setting if the current route needs authentication.</p>
<p><strong>Line 43</strong> : We set up a few session variables to keep a track of user&#8217;s session. These variables are stored both in memory as well as browser&#8217;s session storage (<em>in case of a full page refresh we do not want the user to login again</em>).</p>
<p>Now, we will add the logout link. Open <em>partials/header.html</em> and update it as below</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div id="crayon-5a103f9ecee81483685712" class="crayon-syntax crayon-theme-arduino-ide crayon-font-droid-sans-mono crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">ngClient/partials/header.html</span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
&lt;div class="navbar navbar-default navbar-fixed-top" role="navigation" ng-controller="HeaderCtrl"&gt;
&lt;div class="container"&gt;
&lt;div class="navbar-header"&gt;
&lt;button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".navbar-collapse" ng-show="showMenu"&gt;
&lt;span class="sr-only"&gt;Toggle navigation&lt;/span&gt;
&lt;span class="icon-bar"&gt;&lt;/span&gt;
&lt;span class="icon-bar"&gt;&lt;/span&gt;
&lt;span class="icon-bar"&gt;&lt;/span&gt;
&lt;/button&gt; &lt;a class="navbar-brand" href="#/"&gt;ngClient&lt;/a&gt;
&lt;/div&gt;
&lt;div class="collapse navbar-collapse"&gt;
&lt;ul class="nav navbar-nav" ng-show="showMenu"&gt;
&lt;li ng-class="{active:isActive('/')}"&gt;&lt;a href="#"&gt;Home&lt;/a&gt;
&lt;/li&gt;
&lt;li ng-class="{active:isActive('/page1')}"&gt;&lt;a ng-href="#/page1"&gt;Page 1 (Sample Directive)&lt;/a&gt;
&lt;/li&gt;
&lt;li ng-class="{active:isActive('/page2')}"&gt;&lt;a ng-href="#/page2"&gt;Page 2 (Sample Filter)&lt;/a&gt;
&lt;/li&gt;
&lt;li ng-class="{active:isActive('/page3')}"&gt;&lt;a ng-href="#/page3"&gt;Page 3 (Sample Factory)&lt;/a&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href="javascript:" ng-click="logout()"&gt;Logout&lt;/a&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums" data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a103f9ecee81483685712-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee81483685712-2">2</div><div class="crayon-num" data-line="crayon-5a103f9ecee81483685712-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee81483685712-4">4</div><div class="crayon-num" data-line="crayon-5a103f9ecee81483685712-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee81483685712-6">6</div><div class="crayon-num" data-line="crayon-5a103f9ecee81483685712-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee81483685712-8">8</div><div class="crayon-num" data-line="crayon-5a103f9ecee81483685712-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee81483685712-10">10</div><div class="crayon-num" data-line="crayon-5a103f9ecee81483685712-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee81483685712-12">12</div><div class="crayon-num" data-line="crayon-5a103f9ecee81483685712-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee81483685712-14">14</div><div class="crayon-num" data-line="crayon-5a103f9ecee81483685712-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee81483685712-16">16</div><div class="crayon-num" data-line="crayon-5a103f9ecee81483685712-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee81483685712-18">18</div><div class="crayon-num" data-line="crayon-5a103f9ecee81483685712-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee81483685712-20">20</div><div class="crayon-num" data-line="crayon-5a103f9ecee81483685712-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee81483685712-22">22</div><div class="crayon-num" data-line="crayon-5a103f9ecee81483685712-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee81483685712-24">24</div><div class="crayon-num" data-line="crayon-5a103f9ecee81483685712-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee81483685712-26">26</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a103f9ecee81483685712-1"><span class="crayon-o">&lt;</span><span class="crayon-e">div </span><span class="crayon-t">class</span><span class="crayon-o">=</span><span class="crayon-s">"navbar navbar-default navbar-fixed-top"</span><span class="crayon-h"> </span><span class="crayon-v">role</span><span class="crayon-o">=</span><span class="crayon-s">"navigation"</span><span class="crayon-h"> </span><span class="crayon-v">ng</span><span class="crayon-o">-</span><span class="crayon-v">controller</span><span class="crayon-o">=</span><span class="crayon-s">"HeaderCtrl"</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee81483685712-2"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">div </span><span class="crayon-t">class</span><span class="crayon-o">=</span><span class="crayon-s">"container"</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-5a103f9ecee81483685712-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">div </span><span class="crayon-t">class</span><span class="crayon-o">=</span><span class="crayon-s">"navbar-header"</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee81483685712-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">button </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"button"</span><span class="crayon-h"> </span><span class="crayon-t">class</span><span class="crayon-o">=</span><span class="crayon-s">"navbar-toggle collapsed"</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-o">-</span><span class="crayon-v">toggle</span><span class="crayon-o">=</span><span class="crayon-s">"collapse"</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-o">-</span><span class="crayon-v">target</span><span class="crayon-o">=</span><span class="crayon-s">".navbar-collapse"</span><span class="crayon-h"> </span><span class="crayon-v">ng</span><span class="crayon-o">-</span><span class="crayon-v">show</span><span class="crayon-o">=</span><span class="crayon-s">"showMenu"</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-5a103f9ecee81483685712-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">span </span><span class="crayon-t">class</span><span class="crayon-o">=</span><span class="crayon-s">"sr-only"</span><span class="crayon-o">&gt;</span><span class="crayon-e">Toggle </span><span class="crayon-v">navigation</span><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-v">span</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee81483685712-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">span </span><span class="crayon-t">class</span><span class="crayon-o">=</span><span class="crayon-s">"icon-bar"</span><span class="crayon-o">&gt;</span><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-v">span</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-5a103f9ecee81483685712-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">span </span><span class="crayon-t">class</span><span class="crayon-o">=</span><span class="crayon-s">"icon-bar"</span><span class="crayon-o">&gt;</span><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-v">span</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee81483685712-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">span </span><span class="crayon-t">class</span><span class="crayon-o">=</span><span class="crayon-s">"icon-bar"</span><span class="crayon-o">&gt;</span><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-v">span</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-5a103f9ecee81483685712-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-v">button</span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-i">a</span><span class="crayon-h"> </span><span class="crayon-t">class</span><span class="crayon-o">=</span><span class="crayon-s">"navbar-brand"</span><span class="crayon-h"> </span><span class="crayon-v">href</span><span class="crayon-o">=</span><span class="crayon-s">"#/"</span><span class="crayon-o">&gt;</span><span class="crayon-v">ngClient</span><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-v">a</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee81483685712-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-v">div</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-5a103f9ecee81483685712-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">div </span><span class="crayon-t">class</span><span class="crayon-o">=</span><span class="crayon-s">"collapse navbar-collapse"</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee81483685712-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">ul </span><span class="crayon-t">class</span><span class="crayon-o">=</span><span class="crayon-s">"nav navbar-nav"</span><span class="crayon-h"> </span><span class="crayon-v">ng</span><span class="crayon-o">-</span><span class="crayon-v">show</span><span class="crayon-o">=</span><span class="crayon-s">"showMenu"</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-5a103f9ecee81483685712-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">li </span><span class="crayon-v">ng</span><span class="crayon-o">-</span><span class="crayon-t">class</span><span class="crayon-o">=</span><span class="crayon-s">"{active:isActive('/')}"</span><span class="crayon-o">&gt;</span><span class="crayon-o">&lt;</span><span class="crayon-i">a</span><span class="crayon-h"> </span><span class="crayon-v">href</span><span class="crayon-o">=</span><span class="crayon-s">"#"</span><span class="crayon-o">&gt;</span><span class="crayon-v">Home</span><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-v">a</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee81483685712-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-v">li</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-5a103f9ecee81483685712-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">li </span><span class="crayon-v">ng</span><span class="crayon-o">-</span><span class="crayon-t">class</span><span class="crayon-o">=</span><span class="crayon-s">"{active:isActive('/page1')}"</span><span class="crayon-o">&gt;</span><span class="crayon-o">&lt;</span><span class="crayon-i">a</span><span class="crayon-h"> </span><span class="crayon-v">ng</span><span class="crayon-o">-</span><span class="crayon-v">href</span><span class="crayon-o">=</span><span class="crayon-s">"#/page1"</span><span class="crayon-o">&gt;</span><span class="crayon-i">Page</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">Sample </span><span class="crayon-v">Directive</span><span class="crayon-sy">)</span><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-v">a</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee81483685712-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-v">li</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-5a103f9ecee81483685712-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">li </span><span class="crayon-v">ng</span><span class="crayon-o">-</span><span class="crayon-t">class</span><span class="crayon-o">=</span><span class="crayon-s">"{active:isActive('/page2')}"</span><span class="crayon-o">&gt;</span><span class="crayon-o">&lt;</span><span class="crayon-i">a</span><span class="crayon-h"> </span><span class="crayon-v">ng</span><span class="crayon-o">-</span><span class="crayon-v">href</span><span class="crayon-o">=</span><span class="crayon-s">"#/page2"</span><span class="crayon-o">&gt;</span><span class="crayon-i">Page</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">Sample </span><span class="crayon-v">Filter</span><span class="crayon-sy">)</span><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-v">a</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee81483685712-18"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-v">li</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-5a103f9ecee81483685712-19"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">li </span><span class="crayon-v">ng</span><span class="crayon-o">-</span><span class="crayon-t">class</span><span class="crayon-o">=</span><span class="crayon-s">"{active:isActive('/page3')}"</span><span class="crayon-o">&gt;</span><span class="crayon-o">&lt;</span><span class="crayon-i">a</span><span class="crayon-h"> </span><span class="crayon-v">ng</span><span class="crayon-o">-</span><span class="crayon-v">href</span><span class="crayon-o">=</span><span class="crayon-s">"#/page3"</span><span class="crayon-o">&gt;</span><span class="crayon-i">Page</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">Sample </span><span class="crayon-v">Factory</span><span class="crayon-sy">)</span><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-v">a</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee81483685712-20"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-v">li</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-5a103f9ecee81483685712-21"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-v">li</span><span class="crayon-o">&gt;</span><span class="crayon-o">&lt;</span><span class="crayon-i">a</span><span class="crayon-h"> </span><span class="crayon-v">href</span><span class="crayon-o">=</span><span class="crayon-s">"javascript:"</span><span class="crayon-h"> </span><span class="crayon-v">ng</span><span class="crayon-o">-</span><span class="crayon-v">click</span><span class="crayon-o">=</span><span class="crayon-s">"logout()"</span><span class="crayon-o">&gt;</span><span class="crayon-v">Logout</span><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-v">a</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee81483685712-22"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-v">li</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-5a103f9ecee81483685712-23"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-v">ul</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee81483685712-24"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-v">div</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-5a103f9ecee81483685712-25"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-v">div</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee81483685712-26"><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-v">div</span><span class="crayon-o">&gt;</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0158 seconds] -->
<p>Things to notice</p>
<p><strong>Line 4,12</strong> : 
<span id="crayon-5a103f9ecee98626407084" class="crayon-syntax crayon-syntax-inline  crayon-theme-arduino-ide crayon-theme-arduino-ide-inline crayon-font-droid-sans-mono" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">showMenu</span></span></span> expression will be true when the user is logged in. This way, we do not show the menu to the user if not logged in. This value will be updated in <em>app.js</em> line 58.</p>
<p><strong>Line 21</strong> : The logout link</p>
<p>Now, the functionality for the logout link. Open <em>controllers.js </em>and update the <em>HeaderCtrl </em>as below</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div id="crayon-5a103f9ecee9f803461021" class="crayon-syntax crayon-theme-arduino-ide crayon-font-droid-sans-mono crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">ngClient/js/controllers.js</span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">JavaScript</span></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
myApp.controller("HeaderCtrl", ['$scope', '$location', 'UserAuthFactory',
function($scope, $location, UserAuthFactory) {
$scope.isActive = function(route) {
return route === $location.path();
}
$scope.logout = function () {
UserAuthFactory.logout();
}
}
]);
/// snipp</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums" data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a103f9ecee9f803461021-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee9f803461021-2">2</div><div class="crayon-num" data-line="crayon-5a103f9ecee9f803461021-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee9f803461021-4">4</div><div class="crayon-num" data-line="crayon-5a103f9ecee9f803461021-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee9f803461021-6">6</div><div class="crayon-num" data-line="crayon-5a103f9ecee9f803461021-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee9f803461021-8">8</div><div class="crayon-num" data-line="crayon-5a103f9ecee9f803461021-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee9f803461021-10">10</div><div class="crayon-num" data-line="crayon-5a103f9ecee9f803461021-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee9f803461021-12">12</div><div class="crayon-num" data-line="crayon-5a103f9ecee9f803461021-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ecee9f803461021-14">14</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a103f9ecee9f803461021-1"><span class="crayon-v">myApp</span><span class="crayon-sy">.</span><span class="crayon-e">controller</span><span class="crayon-sy">(</span><span class="crayon-s">"HeaderCtrl"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'$scope'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'$location'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'UserAuthFactory'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee9f803461021-2"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">scope</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-r">location</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">UserAuthFactory</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a103f9ecee9f803461021-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee9f803461021-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">scope</span><span class="crayon-sy">.</span><span class="crayon-v">isActive</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-v">route</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a103f9ecee9f803461021-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">route</span><span class="crayon-h"> </span><span class="crayon-o">===</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">location</span><span class="crayon-sy">.</span><span class="crayon-e">path</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee9f803461021-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5a103f9ecee9f803461021-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee9f803461021-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">scope</span><span class="crayon-sy">.</span><span class="crayon-v">logout</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a103f9ecee9f803461021-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">UserAuthFactory</span><span class="crayon-sy">.</span><span class="crayon-e">logout</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee9f803461021-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5a103f9ecee9f803461021-11"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee9f803461021-12"><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a103f9ecee9f803461021-13">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ecee9f803461021-14"><span class="crayon-c">/// snipp</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0048 seconds] -->
<p>The code so far will take care of the login. Now we will make a request to get all products after successful login.</p>
<p>We will create a new <em>dataFactory</em> to interact with the REST API. Open <em>factory.js </em>and update it as below</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div id="crayon-5a103f9eceea6289388597" class="crayon-syntax crayon-theme-arduino-ide crayon-font-droid-sans-mono crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">ngClient/js/factory.js</span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">JavaScript</span></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
myApp.factory('dataFactory', function($http) {
/** https://docs.angularjs.org/guide/providers **/
var urlBase = 'http://localhost:3000/api/v1/products';
var _prodFactory = {};
_prodFactory.getProducts = function() {
return $http.get(urlBase);
}; 
return _prodFactory;
});</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums" data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a103f9eceea6289388597-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9eceea6289388597-2">2</div><div class="crayon-num" data-line="crayon-5a103f9eceea6289388597-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9eceea6289388597-4">4</div><div class="crayon-num" data-line="crayon-5a103f9eceea6289388597-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9eceea6289388597-6">6</div><div class="crayon-num" data-line="crayon-5a103f9eceea6289388597-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9eceea6289388597-8">8</div><div class="crayon-num" data-line="crayon-5a103f9eceea6289388597-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9eceea6289388597-10">10</div><div class="crayon-num" data-line="crayon-5a103f9eceea6289388597-11">11</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a103f9eceea6289388597-1"><span class="crayon-v">myApp</span><span class="crayon-sy">.</span><span class="crayon-e">factory</span><span class="crayon-sy">(</span><span class="crayon-s">'dataFactory'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">http</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9eceea6289388597-2"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">/** https://docs.angularjs.org/guide/providers **/</span></div><div class="crayon-line" id="crayon-5a103f9eceea6289388597-3"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-e">urlBase</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'http://localhost:3000/api/v1/products'</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9eceea6289388597-4"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">_prodFactory</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-sy">}</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a103f9eceea6289388597-5">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9eceea6289388597-6"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">_prodFactory</span><span class="crayon-sy">.</span><span class="crayon-v">getProducts</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a103f9eceea6289388597-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">http</span><span class="crayon-sy">.</span><span class="crayon-e">get</span><span class="crayon-sy">(</span><span class="crayon-v">urlBase</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9eceea6289388597-8"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">;</span><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-5a103f9eceea6289388597-9">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9eceea6289388597-10"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">_prodFactory</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a103f9eceea6289388597-11"><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0035 seconds] -->
<p>A sample route to demonstrate the access of API methods post login.</p>
<p>Now in <em>controllers.js</em> update the <em>Page3Ctrl</em> as below</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div id="crayon-5a103f9eceeac323782564" class="crayon-syntax crayon-theme-arduino-ide crayon-font-droid-sans-mono crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">ngClient/js/controllers.js</span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">JavaScript</span></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
/// snipp
myApp.controller("Page3Ctrl", ['$scope', 'dataFactory',
function($scope, dataFactory) {
$scope.products = [];
// Access the factory and get the latest products list
dataFactory.getProducts().then(function(data) {
$scope.products = data.data;
});
}
]);</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums" data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a103f9eceeac323782564-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9eceeac323782564-2">2</div><div class="crayon-num" data-line="crayon-5a103f9eceeac323782564-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9eceeac323782564-4">4</div><div class="crayon-num" data-line="crayon-5a103f9eceeac323782564-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9eceeac323782564-6">6</div><div class="crayon-num" data-line="crayon-5a103f9eceeac323782564-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9eceeac323782564-8">8</div><div class="crayon-num" data-line="crayon-5a103f9eceeac323782564-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9eceeac323782564-10">10</div><div class="crayon-num" data-line="crayon-5a103f9eceeac323782564-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9eceeac323782564-12">12</div><div class="crayon-num" data-line="crayon-5a103f9eceeac323782564-13">13</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a103f9eceeac323782564-1"><span class="crayon-c">/// snipp</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9eceeac323782564-2">&nbsp;</div><div class="crayon-line" id="crayon-5a103f9eceeac323782564-3"><span class="crayon-v">myApp</span><span class="crayon-sy">.</span><span class="crayon-e">controller</span><span class="crayon-sy">(</span><span class="crayon-s">"Page3Ctrl"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'$scope'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'dataFactory'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9eceeac323782564-4"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">scope</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dataFactory</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a103f9eceeac323782564-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">scope</span><span class="crayon-sy">.</span><span class="crayon-v">products</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9eceeac323782564-6">&nbsp;</div><div class="crayon-line" id="crayon-5a103f9eceeac323782564-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Access the factory and get the latest products list</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9eceeac323782564-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">dataFactory</span><span class="crayon-sy">.</span><span class="crayon-e">getProducts</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-st">then</span><span class="crayon-sy">(</span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a103f9eceeac323782564-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">scope</span><span class="crayon-sy">.</span><span class="crayon-v">products</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">.</span><span class="crayon-v">data</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9eceeac323782564-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a103f9eceeac323782564-11">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9eceeac323782564-12"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5a103f9eceeac323782564-13"><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0040 seconds] -->
<p>Pretty straight forward. Access the Factory, get the products and finally update the UI. Open <em>partials/page3.html </em>and update it as below</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div id="crayon-5a103f9eceeb3932729731" class="crayon-syntax crayon-theme-arduino-ide crayon-font-droid-sans-mono crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">ngClient/partials/page3.html</span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
&lt;div class="container" ng-controller="Page3Ctrl"&gt;
&lt;div class="page-header"&gt;
&lt;h3&gt;List of products from the REST API
&lt;code&gt;/api/v1/products&lt;/code&gt;
&lt;/h3&gt;
&lt;/div&gt;
&lt;p class="lead"&gt;
&lt;table class="table table-striped"&gt;
&lt;tr&gt;
&lt;th&gt;ID&lt;/th&gt;
&lt;th&gt;Name&lt;/th&gt;
&lt;/tr&gt;
&lt;tr ng-repeat="p in products"&gt;
&lt;td&gt;{{p.id}}&lt;/td&gt;
&lt;td&gt;{{p.name}}&lt;/td&gt;
&lt;/tr&gt;
&lt;/table&gt;
&lt;/p&gt;
&lt;/div&gt;</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums" data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a103f9eceeb3932729731-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9eceeb3932729731-2">2</div><div class="crayon-num" data-line="crayon-5a103f9eceeb3932729731-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9eceeb3932729731-4">4</div><div class="crayon-num" data-line="crayon-5a103f9eceeb3932729731-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9eceeb3932729731-6">6</div><div class="crayon-num" data-line="crayon-5a103f9eceeb3932729731-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9eceeb3932729731-8">8</div><div class="crayon-num" data-line="crayon-5a103f9eceeb3932729731-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9eceeb3932729731-10">10</div><div class="crayon-num" data-line="crayon-5a103f9eceeb3932729731-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9eceeb3932729731-12">12</div><div class="crayon-num" data-line="crayon-5a103f9eceeb3932729731-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9eceeb3932729731-14">14</div><div class="crayon-num" data-line="crayon-5a103f9eceeb3932729731-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9eceeb3932729731-16">16</div><div class="crayon-num" data-line="crayon-5a103f9eceeb3932729731-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9eceeb3932729731-18">18</div><div class="crayon-num" data-line="crayon-5a103f9eceeb3932729731-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9eceeb3932729731-20">20</div><div class="crayon-num" data-line="crayon-5a103f9eceeb3932729731-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9eceeb3932729731-22">22</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a103f9eceeb3932729731-1"><span class="crayon-o">&lt;</span><span class="crayon-e">div </span><span class="crayon-t">class</span><span class="crayon-o">=</span><span class="crayon-s">"container"</span><span class="crayon-h"> </span><span class="crayon-v">ng</span><span class="crayon-o">-</span><span class="crayon-v">controller</span><span class="crayon-o">=</span><span class="crayon-s">"Page3Ctrl"</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9eceeb3932729731-2"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">div </span><span class="crayon-t">class</span><span class="crayon-o">=</span><span class="crayon-s">"page-header"</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-5a103f9eceeb3932729731-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-v">h3</span><span class="crayon-o">&gt;</span><span class="crayon-e">List </span><span class="crayon-e">of </span><span class="crayon-e">products </span><span class="crayon-e">from </span><span class="crayon-e">the </span><span class="crayon-e">REST </span><span class="crayon-v">API</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9eceeb3932729731-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-v">code</span><span class="crayon-o">&gt;</span><span class="crayon-o">/</span><span class="crayon-v">api</span><span class="crayon-o">/</span><span class="crayon-v">v1</span><span class="crayon-o">/</span><span class="crayon-v">products</span><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-v">code</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-5a103f9eceeb3932729731-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-v">h3</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9eceeb3932729731-6"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-v">div</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-5a103f9eceeb3932729731-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9eceeb3932729731-8">&nbsp;</div><div class="crayon-line" id="crayon-5a103f9eceeb3932729731-9"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-i">p</span><span class="crayon-h"> </span><span class="crayon-t">class</span><span class="crayon-o">=</span><span class="crayon-s">"lead"</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9eceeb3932729731-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">table </span><span class="crayon-t">class</span><span class="crayon-o">=</span><span class="crayon-s">"table table-striped"</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-5a103f9eceeb3932729731-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-v">tr</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9eceeb3932729731-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-v">th</span><span class="crayon-o">&gt;</span><span class="crayon-v">ID</span><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-v">th</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-5a103f9eceeb3932729731-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-v">th</span><span class="crayon-o">&gt;</span><span class="crayon-v">Name</span><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-v">th</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9eceeb3932729731-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-v">tr</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-5a103f9eceeb3932729731-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">tr </span><span class="crayon-v">ng</span><span class="crayon-o">-</span><span class="crayon-v">repeat</span><span class="crayon-o">=</span><span class="crayon-s">"p in products"</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9eceeb3932729731-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">td</span><span class="crayon-o">&gt;</span><span class="crayon-sy">{</span><span class="crayon-sy">{</span><span class="crayon-v">p</span><span class="crayon-sy">.</span><span class="crayon-v">id</span><span class="crayon-sy">}</span><span class="crayon-sy">}</span><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-e">td</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-5a103f9eceeb3932729731-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">td</span><span class="crayon-o">&gt;</span><span class="crayon-sy">{</span><span class="crayon-sy">{</span><span class="crayon-v">p</span><span class="crayon-sy">.</span><span class="crayon-v">name</span><span class="crayon-sy">}</span><span class="crayon-sy">}</span><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-v">td</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9eceeb3932729731-18"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-v">tr</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-5a103f9eceeb3932729731-19"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-v">table</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9eceeb3932729731-20"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-v">p</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-5a103f9eceeb3932729731-21">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9eceeb3932729731-22"><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-v">div</span><span class="crayon-o">&gt;</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0119 seconds] -->
<p>Finally the <i>index.html</i>. Update it as below with the newly created js references</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div id="crayon-5a103f9eceeba854888822" class="crayon-syntax crayon-theme-arduino-ide crayon-font-droid-sans-mono crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">ngClient/index.html</span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-mixed-highlight" title="Contains Mixed Languages"></span><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
&lt;!DOCTYPE html&gt;
&lt;html ng-app="ngclient"&gt;
&lt;head&gt;
&lt;title&gt;ngClient&lt;/title&gt;
&lt;link rel="stylesheet" type="text/css" href="libs/bootstrap/dist/css/bootstrap.min.css"&gt;
&lt;link rel="stylesheet" type="text/css" href="css/app.css"&gt;
&lt;script type="text/javascript" src="libs/angular/angular.min.js"&gt;&lt;/script&gt;
&lt;script type="text/javascript" src="libs/angular-route/angular-route.min.js"&gt;&lt;/script&gt;
&lt;script type="text/javascript" src="js/app.js"&gt;&lt;/script&gt;
&lt;script type="text/javascript" src="js/factory.js"&gt;&lt;/script&gt;
&lt;script type="text/javascript" src="js/filters.js"&gt;&lt;/script&gt;
&lt;script type="text/javascript" src="js/directives.js"&gt;&lt;/script&gt;
&lt;script type="text/javascript" src="js/controllers.js"&gt;&lt;/script&gt;
&lt;script type="text/javascript" src="js/auth/auth.factory.js"&gt;&lt;/script&gt;
&lt;script type="text/javascript" src="js/auth/auth.controller.js"&gt;&lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;div ng-include="'partials/header.html'"&gt;&lt;/div&gt;
&lt;div class="container" ng-view&gt;&lt;/div&gt;
&lt;div ng-include="'partials/footer.html'"&gt;&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums" data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a103f9eceeba854888822-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9eceeba854888822-2">2</div><div class="crayon-num" data-line="crayon-5a103f9eceeba854888822-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9eceeba854888822-4">4</div><div class="crayon-num" data-line="crayon-5a103f9eceeba854888822-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9eceeba854888822-6">6</div><div class="crayon-num" data-line="crayon-5a103f9eceeba854888822-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9eceeba854888822-8">8</div><div class="crayon-num" data-line="crayon-5a103f9eceeba854888822-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9eceeba854888822-10">10</div><div class="crayon-num" data-line="crayon-5a103f9eceeba854888822-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9eceeba854888822-12">12</div><div class="crayon-num" data-line="crayon-5a103f9eceeba854888822-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9eceeba854888822-14">14</div><div class="crayon-num" data-line="crayon-5a103f9eceeba854888822-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9eceeba854888822-16">16</div><div class="crayon-num" data-line="crayon-5a103f9eceeba854888822-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9eceeba854888822-18">18</div><div class="crayon-num" data-line="crayon-5a103f9eceeba854888822-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9eceeba854888822-20">20</div><div class="crayon-num" data-line="crayon-5a103f9eceeba854888822-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9eceeba854888822-22">22</div><div class="crayon-num" data-line="crayon-5a103f9eceeba854888822-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9eceeba854888822-24">24</div><div class="crayon-num" data-line="crayon-5a103f9eceeba854888822-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9eceeba854888822-26">26</div><div class="crayon-num" data-line="crayon-5a103f9eceeba854888822-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9eceeba854888822-28">28</div><div class="crayon-num" data-line="crayon-5a103f9eceeba854888822-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9eceeba854888822-30">30</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a103f9eceeba854888822-1"><span class="crayon-o">&lt;</span><span class="crayon-o">!</span><span class="crayon-e">DOCTYPE </span><span class="crayon-v">html</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9eceeba854888822-2"><span class="crayon-o">&lt;</span><span class="crayon-e">html </span><span class="crayon-v">ng</span><span class="crayon-o">-</span><span class="crayon-v">app</span><span class="crayon-o">=</span><span class="crayon-s">"ngclient"</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-5a103f9eceeba854888822-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9eceeba854888822-4"><span class="crayon-o">&lt;</span><span class="crayon-v">head</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-5a103f9eceeba854888822-5"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-v">title</span><span class="crayon-o">&gt;</span><span class="crayon-v">ngClient</span><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-v">title</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9eceeba854888822-6">&nbsp;</div><div class="crayon-line" id="crayon-5a103f9eceeba854888822-7"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">link </span><span class="crayon-v">rel</span><span class="crayon-o">=</span><span class="crayon-s">"stylesheet"</span><span class="crayon-h"> </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"text/css"</span><span class="crayon-h"> </span><span class="crayon-v">href</span><span class="crayon-o">=</span><span class="crayon-s">"libs/bootstrap/dist/css/bootstrap.min.css"</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9eceeba854888822-8"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">link </span><span class="crayon-v">rel</span><span class="crayon-o">=</span><span class="crayon-s">"stylesheet"</span><span class="crayon-h"> </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"text/css"</span><span class="crayon-h"> </span><span class="crayon-v">href</span><span class="crayon-o">=</span><span class="crayon-s">"css/app.css"</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-5a103f9eceeba854888822-9">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9eceeba854888822-10"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-ta">&lt;script </span><span class="crayon-e">type</span><span class="crayon-o">=</span><span class="crayon-s">"text/javascript"</span><span class="crayon-h"> </span><span class="crayon-e">src</span><span class="crayon-o">=</span><span class="crayon-s">"libs/angular/angular.min.js"</span><span class="crayon-o">&gt;</span><span class="crayon-ta">&lt;/script&gt;</span></div><div class="crayon-line" id="crayon-5a103f9eceeba854888822-11"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-ta">&lt;script </span><span class="crayon-e">type</span><span class="crayon-o">=</span><span class="crayon-s">"text/javascript"</span><span class="crayon-h"> </span><span class="crayon-e">src</span><span class="crayon-o">=</span><span class="crayon-s">"libs/angular-route/angular-route.min.js"</span><span class="crayon-o">&gt;</span><span class="crayon-ta">&lt;/script&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9eceeba854888822-12">&nbsp;</div><div class="crayon-line" id="crayon-5a103f9eceeba854888822-13"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-ta">&lt;script </span><span class="crayon-e">type</span><span class="crayon-o">=</span><span class="crayon-s">"text/javascript"</span><span class="crayon-h"> </span><span class="crayon-e">src</span><span class="crayon-o">=</span><span class="crayon-s">"js/app.js"</span><span class="crayon-o">&gt;</span><span class="crayon-ta">&lt;/script&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9eceeba854888822-14"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-ta">&lt;script </span><span class="crayon-e">type</span><span class="crayon-o">=</span><span class="crayon-s">"text/javascript"</span><span class="crayon-h"> </span><span class="crayon-e">src</span><span class="crayon-o">=</span><span class="crayon-s">"js/factory.js"</span><span class="crayon-o">&gt;</span><span class="crayon-ta">&lt;/script&gt;</span></div><div class="crayon-line" id="crayon-5a103f9eceeba854888822-15"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-ta">&lt;script </span><span class="crayon-e">type</span><span class="crayon-o">=</span><span class="crayon-s">"text/javascript"</span><span class="crayon-h"> </span><span class="crayon-e">src</span><span class="crayon-o">=</span><span class="crayon-s">"js/filters.js"</span><span class="crayon-o">&gt;</span><span class="crayon-ta">&lt;/script&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9eceeba854888822-16"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-ta">&lt;script </span><span class="crayon-e">type</span><span class="crayon-o">=</span><span class="crayon-s">"text/javascript"</span><span class="crayon-h"> </span><span class="crayon-e">src</span><span class="crayon-o">=</span><span class="crayon-s">"js/directives.js"</span><span class="crayon-o">&gt;</span><span class="crayon-ta">&lt;/script&gt;</span></div><div class="crayon-line" id="crayon-5a103f9eceeba854888822-17"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-ta">&lt;script </span><span class="crayon-e">type</span><span class="crayon-o">=</span><span class="crayon-s">"text/javascript"</span><span class="crayon-h"> </span><span class="crayon-e">src</span><span class="crayon-o">=</span><span class="crayon-s">"js/controllers.js"</span><span class="crayon-o">&gt;</span><span class="crayon-ta">&lt;/script&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9eceeba854888822-18">&nbsp;</div><div class="crayon-line" id="crayon-5a103f9eceeba854888822-19"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-ta">&lt;script </span><span class="crayon-e">type</span><span class="crayon-o">=</span><span class="crayon-s">"text/javascript"</span><span class="crayon-h"> </span><span class="crayon-e">src</span><span class="crayon-o">=</span><span class="crayon-s">"js/auth/auth.factory.js"</span><span class="crayon-o">&gt;</span><span class="crayon-ta">&lt;/script&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9eceeba854888822-20"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-ta">&lt;script </span><span class="crayon-e">type</span><span class="crayon-o">=</span><span class="crayon-s">"text/javascript"</span><span class="crayon-h"> </span><span class="crayon-e">src</span><span class="crayon-o">=</span><span class="crayon-s">"js/auth/auth.controller.js"</span><span class="crayon-o">&gt;</span><span class="crayon-ta">&lt;/script&gt;</span></div><div class="crayon-line" id="crayon-5a103f9eceeba854888822-21">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9eceeba854888822-22"><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-v">head</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-5a103f9eceeba854888822-23">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9eceeba854888822-24"><span class="crayon-o">&lt;</span><span class="crayon-v">body</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-5a103f9eceeba854888822-25"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">div </span><span class="crayon-v">ng</span><span class="crayon-o">-</span><span class="crayon-v">include</span><span class="crayon-o">=</span><span class="crayon-s">"'partials/header.html'"</span><span class="crayon-o">&gt;</span><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-v">div</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9eceeba854888822-26"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">div </span><span class="crayon-t">class</span><span class="crayon-o">=</span><span class="crayon-s">"container"</span><span class="crayon-h"> </span><span class="crayon-v">ng</span><span class="crayon-o">-</span><span class="crayon-v">view</span><span class="crayon-o">&gt;</span><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-v">div</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-5a103f9eceeba854888822-27"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">div </span><span class="crayon-v">ng</span><span class="crayon-o">-</span><span class="crayon-v">include</span><span class="crayon-o">=</span><span class="crayon-s">"'partials/footer.html'"</span><span class="crayon-o">&gt;</span><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-v">div</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9eceeba854888822-28"><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-v">body</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-5a103f9eceeba854888822-29">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9eceeba854888822-30"><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-v">html</span><span class="crayon-o">&gt;</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0109 seconds] -->
<p>That is it. Back to browser (<em>with 
<span id="crayon-5a103f9eceec3719607887" class="crayon-syntax crayon-syntax-inline  crayon-theme-arduino-ide crayon-theme-arduino-ide-inline crayon-font-droid-sans-mono" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">gulp</span></span></span> command </em><em>running in the background</em>) and navigate to 
<span id="crayon-5a103f9eceec9249757625" class="crayon-syntax crayon-syntax-inline  crayon-theme-arduino-ide crayon-theme-arduino-ide-inline crayon-font-droid-sans-mono" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">http</span><span class="crayon-o">:</span><span class="crayon-c">//localhost:2772</span></span></span>. You should see a login page</p>
<p>Click on Submit and you should see the home page. Now click on logout and you should be logged out. Log back in and click on Page 3 (Sample Factory) link in the menu. Now, you should see a list of products from the REST endpoint.</p>
<p><a href="http://i0.wp.com/thejackalofjavascript.com/wp-content/uploads/2014/09/Screen-Shot-2014-09-22-at-9.02.40-am.png" data-rel="lightbox-6" title=""><img class="size-medium wp-image-2102 aligncenter" src="http://i0.wp.com/thejackalofjavascript.com/wp-content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="http://i1.wp.com/thejackalofjavascript.com/wp-content/uploads/2014/09/Screen-Shot-2014-09-22-at-9.02.40-am-451x104.png?resize=451%2C104" alt="Screen Shot 2014-09-22 at 9.02.40 am" data-recalc-dims="1" /><noscript><img class="size-medium wp-image-2102 aligncenter" src="http://i1.wp.com/thejackalofjavascript.com/wp-content/uploads/2014/09/Screen-Shot-2014-09-22-at-9.02.40-am-451x104.png?resize=451%2C104" alt="Screen Shot 2014-09-22 at 9.02.40 am" data-recalc-dims="1" /></noscript></a></p>
<p>Simple, easy, secure and scalable architecture for your awesome apps!</p>
<hr />
<p>Thanks for reading! Do comment.<br />
@arvindr21</p>
<!-- Simple Share Buttons Adder (6.1.5) simplesharebuttons.com --><div class="ssba ssba-wrap"><div style="text-align:left"><a href="http://twitter.com/share?url=./architecting-a-restful-node-js-app/&amp;text=Architecting+a+Secure+RESTful+Node.js+app+From+The+Jackal+of+Javascript+by+%40arvindr21" onclick="__gaTracker('send', 'event', 'outbound-article', 'http://twitter.com/share?url=./architecting-a-restful-node-js-app/&amp;text=Architecting+a+Secure+RESTful+Node.js+app+From+The+Jackal+of+Javascript+by+%40arvindr21', '');" data-site="" class="ssba_twitter_share"   target="_blank"  rel="nofollow"><img src="http://i0.wp.com/thejackalofjavascript.com/wp-content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="http://i2.wp.com/thejackalofjavascript.com/wp-content/plugins/simple-share-buttons-adder/buttons/somacro/twitter.png?w=646" title="Twitter" class="ssba ssba-img" alt="Tweet about this on Twitter" data-recalc-dims="1" /><noscript><img src="http://i2.wp.com/thejackalofjavascript.com/wp-content/plugins/simple-share-buttons-adder/buttons/somacro/twitter.png?w=646" title="Twitter" class="ssba ssba-img" alt="Tweet about this on Twitter" data-recalc-dims="1" /></noscript></a><a href="http://www.linkedin.com/shareArticle?mini=true&amp;url=./architecting-a-restful-node-js-app/" onclick="__gaTracker('send', 'event', 'outbound-article', 'http://www.linkedin.com/shareArticle?mini=true&amp;url=./architecting-a-restful-node-js-app/', '');" data-site="linkedin" class="ssba_linkedin_share ssba_share_link"   target="_blank"  rel="nofollow"><img src="http://i0.wp.com/thejackalofjavascript.com/wp-content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="http://i1.wp.com/thejackalofjavascript.com/wp-content/plugins/simple-share-buttons-adder/buttons/somacro/linkedin.png?w=646" title="LinkedIn" class="ssba ssba-img" alt="Share on LinkedIn" data-recalc-dims="1" /><noscript><img src="http://i1.wp.com/thejackalofjavascript.com/wp-content/plugins/simple-share-buttons-adder/buttons/somacro/linkedin.png?w=646" title="LinkedIn" class="ssba ssba-img" alt="Share on LinkedIn" data-recalc-dims="1" /></noscript></a><span class="ssba_sharecount">48</span><a href="https://plus.google.com/share?url=./architecting-a-restful-node-js-app/" onclick="__gaTracker('send', 'event', 'outbound-article', 'https://plus.google.com/share?url=./architecting-a-restful-node-js-app/', '');" data-site="" class="ssba_google_share"   target="_blank"  rel="nofollow"><img src="http://i0.wp.com/thejackalofjavascript.com/wp-content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="http://i2.wp.com/thejackalofjavascript.com/wp-content/plugins/simple-share-buttons-adder/buttons/somacro/google.png?w=646" title="Google+" class="ssba ssba-img" alt="Share on Google+" data-recalc-dims="1" /><noscript><img src="http://i2.wp.com/thejackalofjavascript.com/wp-content/plugins/simple-share-buttons-adder/buttons/somacro/google.png?w=646" title="Google+" class="ssba ssba-img" alt="Share on Google+" data-recalc-dims="1" /></noscript></a><span class="ssba_sharecount">0</span><a href="http://reddit.com/submit?url=./architecting-a-restful-node-js-app/&amp;title=Architecting a Secure RESTful Node.js app" onclick="__gaTracker('send', 'event', 'outbound-article', 'http://reddit.com/submit?url=./architecting-a-restful-node-js-app/&amp;title=Architecting a Secure RESTful Node.js app', '');" data-site="reddit" class="ssba_reddit_share"   target="_blank"  rel="nofollow"><img src="http://i0.wp.com/thejackalofjavascript.com/wp-content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="http://i0.wp.com/thejackalofjavascript.com/wp-content/plugins/simple-share-buttons-adder/buttons/somacro/reddit.png?w=646" title="Reddit" class="ssba ssba-img" alt="Share on Reddit" data-recalc-dims="1" /><noscript><img src="http://i0.wp.com/thejackalofjavascript.com/wp-content/plugins/simple-share-buttons-adder/buttons/somacro/reddit.png?w=646" title="Reddit" class="ssba ssba-img" alt="Share on Reddit" data-recalc-dims="1" /></noscript></a><span class="ssba_sharecount">0</span><a href="https://bufferapp.com/add?url=./architecting-a-restful-node-js-app/&amp;text=From The Jackal of Javascript Architecting a Secure RESTful Node.js app" onclick="__gaTracker('send', 'event', 'outbound-article', 'https://bufferapp.com/add?url=./architecting-a-restful-node-js-app/&amp;text=From The Jackal of Javascript Architecting a Secure RESTful Node.js app', '');" data-site="buffer" class="ssba_buffer_share"   target="_blank"  rel="nofollow"><img src="http://i0.wp.com/thejackalofjavascript.com/wp-content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="http://i1.wp.com/thejackalofjavascript.com/wp-content/plugins/simple-share-buttons-adder/buttons/somacro/buffer.png?w=646" title="Buffer" class="ssba ssba-img" alt="Buffer this page" data-recalc-dims="1" /><noscript><img src="http://i1.wp.com/thejackalofjavascript.com/wp-content/plugins/simple-share-buttons-adder/buttons/somacro/buffer.png?w=646" title="Buffer" class="ssba ssba-img" alt="Buffer this page" data-recalc-dims="1" /></noscript></a><a href="https://flattr.com/submit/auto?user_id=arvindr21&amp;title=Architecting a Secure RESTful Node.js app&amp;url=https://flattr.com/profile/arvindr21" onclick="__gaTracker('send', 'event', 'outbound-article', 'https://flattr.com/submit/auto?user_id=arvindr21&amp;title=Architecting a Secure RESTful Node.js app&amp;url=https://flattr.com/profile/arvindr21', '');" data-site="flattr" class="ssba_flattr_share"   target="_blank"  rel="nofollow"><img src="http://i0.wp.com/thejackalofjavascript.com/wp-content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="http://i0.wp.com/thejackalofjavascript.com/wp-content/plugins/simple-share-buttons-adder/buttons/somacro/flattr.png?w=646" title="Flattr" class="ssba ssba-img" alt="Flattr the author" data-recalc-dims="1" /><noscript><img src="http://i0.wp.com/thejackalofjavascript.com/wp-content/plugins/simple-share-buttons-adder/buttons/somacro/flattr.png?w=646" title="Flattr" class="ssba ssba-img" alt="Flattr the author" data-recalc-dims="1" /></noscript></a><a data-site="email" class="ssba_email_share" href="./cdn-cgi/l/email-protection/index.html#83bcf0f6e1e9e6e0f7bec2f1e0ebeaf7e6e0f7eaede4a3e2a3d0e6e0f6f1e6a3d1c6d0d7e5f6efa3cdece7e6ade9f0a3e2f3f3a5e2eef3b8e1ece7fabec5f1eceea3d7ebe6a3c9e2e0e8e2efa3ece5a3c9e2f5e2f0e0f1eaf3f7a6b1b3ebf7f7f3b9acacf7ebe6e9e2e0e8e2efece5e9e2f5e2f0e0f1eaf3f7ade0eceeace2f1e0ebeaf7e6e0f7eaede4aee2aef1e6f0f7e5f6efaeedece7e6aee9f0aee2f3f3ac"><img src="http://i0.wp.com/thejackalofjavascript.com/wp-content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="http://i0.wp.com/thejackalofjavascript.com/wp-content/plugins/simple-share-buttons-adder/buttons/somacro/email.png?w=646" title="Email" class="ssba ssba-img" alt="Email this to someone" data-recalc-dims="1" /><noscript><img src="http://i0.wp.com/thejackalofjavascript.com/wp-content/plugins/simple-share-buttons-adder/buttons/somacro/email.png?w=646" title="Email" class="ssba ssba-img" alt="Email this to someone" data-recalc-dims="1" /></noscript></a><a data-site="print" class="ssba_print ssba_share_link" href="#" onclick="window.print()"><img src="http://i0.wp.com/thejackalofjavascript.com/wp-content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="http://i0.wp.com/thejackalofjavascript.com/wp-content/plugins/simple-share-buttons-adder/buttons/somacro/print.png?w=646" title="Print" class="ssba ssba-img" alt="Print this page" data-recalc-dims="1" /><noscript><img src="http://i0.wp.com/thejackalofjavascript.com/wp-content/plugins/simple-share-buttons-adder/buttons/somacro/print.png?w=646" title="Print" class="ssba ssba-img" alt="Print this page" data-recalc-dims="1" /></noscript></a></div></div><div class='sharedaddy sd-block sd-like jetpack-likes-widget-wrapper jetpack-likes-widget-unloaded' id='like-post-wrapper-70838519-2043-5a103f9fa0192' data-src='//widgets.wp.com/likes/#blog_id=70838519&amp;post_id=2043&amp;origin=thejackalofjavascript.com&amp;obj_id=70838519-2043-5a103f9fa0192' data-name='like-post-frame-70838519-2043-5a103f9fa0192'><h3 class='sd-title'>Like this:</h3><div class='likes-widget-placeholder post-likes-widget-placeholder' style='height:55px'><span class='button'><span>Like</span></span> <span class="loading">Loading...</span></div><span class='sd-text-color'></span><a class='sd-link-color'></a></div>
<div id='jp-relatedposts' class='jp-relatedposts' >
<h3 class="jp-relatedposts-headline"><em>Related</em></h3>
</div>
<div class="entry-content">
</div><!-- .entry-content -->
<footer class="entry-meta">
<span class="post-date"><a href="./index.html" title="9:38 am" rel="bookmark"><time class="entry-date" datetime="2014-09-22T09:38:15+00:00">September 22, 2014</time></a></span><span class="byline"><span class="author vcard"><a class="url fn n" href="./author/arvind-ravulavaru/index.html" title="View all posts by Arvind Ravulavaru" rel="author">Arvind Ravulavaru</a></span></span>					</footer><!-- .entry-meta -->
</article><!-- #post-## -->
<nav class="navigation post-navigation" role="navigation">
<h1 class="screen-reader-text">Post navigation</h1>
<div class="nav-links">
<div class="nav-previous"><a href="./maintaining-a-private-npm-registry/index.html" rel="prev"><span class="meta-nav screen-reader-text">&larr;</span></a></div><div class="nav-next"><a href="./ionic-twilio-and-node-scheduler-part-2/index.html" rel="next"><span class="meta-nav screen-reader-text">&rarr;</span></a></div>		</div><!-- .nav-links -->
</nav><!-- .navigation -->
<div id="disqus_thread">
<div id="dsq-content">
<div class="navigation">
<div class="nav-previous">
<span class="meta-nav">&larr;</span>&nbsp;
<a href="./comment-page-1/index.html#comments" >Older Comments</a>                </div>
<div class="nav-next">
&nbsp;<span class="meta-nav">&rarr;</span>
</div>
</div> <!-- .navigation -->
<ul id="dsq-comments">
<li class="comment even thread-even depth-1" id="dsq-comment-3398">
<div id="dsq-comment-header-3398" class="dsq-comment-header">
<cite id="dsq-cite-3398">
<span id="dsq-author-user-3398">Stephen</span>
</cite>
</div>
<div id="dsq-comment-body-3398" class="dsq-comment-body">
<div id="dsq-comment-message-3398" class="dsq-comment-message"><p>Hi Arvind, there&#8217;s an error on your website stopping the second half of the tutorial from loading</p>
</div>
</div>
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="dsq-comment-3380">
<div id="dsq-comment-header-3380" class="dsq-comment-header">
<cite id="dsq-cite-3380">
http://shitgotdeep.appspot.com/                <span id="dsq-author-user-3380">Rizwan Riyaz Patel</span>
</cite>
</div>
<div id="dsq-comment-body-3380" class="dsq-comment-body">
<div id="dsq-comment-message-3380" class="dsq-comment-message"><p>i want my apis and webapp in same project rather than deloy on server on different ports any pointers on that !<br />
<a href="https://stackoverflow.com/questions/44098162/segregation-of-multiple-routes-for-pages-and-apis-with-jwt-using-express-in-node" onclick="__gaTracker('send', 'event', 'outbound-comment', 'https://stackoverflow.com/questions/44098162/segregation-of-multiple-routes-for-pages-and-apis-with-jwt-using-express-in-node', 'https://stackoverflow.com/questions/44098162/segregation-of-multiple-routes-for-pages-and-apis-with-jwt-using-express-in-node');" rel="nofollow">https://stackoverflow.com/questions/44098162/segregation-of-multiple-routes-for-pages-and-apis-with-jwt-using-express-in-node</a></p>
</div>
</div>
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="dsq-comment-3377">
<div id="dsq-comment-header-3377" class="dsq-comment-header">
<cite id="dsq-cite-3377">
<span id="dsq-author-user-3377">Yusril Herliansyah</span>
</cite>
</div>
<div id="dsq-comment-body-3377" class="dsq-comment-body">
<div id="dsq-comment-message-3377" class="dsq-comment-message"><p>That&#8217;s cool</p>
</div>
</div>
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="dsq-comment-3343">
<div id="dsq-comment-header-3343" class="dsq-comment-header">
<cite id="dsq-cite-3343">
<span id="dsq-author-user-3343">jitesh</span>
</cite>
</div>
<div id="dsq-comment-body-3343" class="dsq-comment-body">
<div id="dsq-comment-message-3343" class="dsq-comment-message"><p>Awesome tutorial to learn <img src="./wp-includes/images/smilies/simple-smile.png" alt=":)" class="wp-smiley" style="height: 1em; max-height: 1em;" /> Grasp the idea, many thanks</p>
</div>
</div>
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="dsq-comment-3338">
<div id="dsq-comment-header-3338" class="dsq-comment-header">
<cite id="dsq-cite-3338">
http://1598.zz.vc                <span id="dsq-author-user-3338">Divyanshu Singh Pathania</span>
</cite>
</div>
<div id="dsq-comment-body-3338" class="dsq-comment-body">
<div id="dsq-comment-message-3338" class="dsq-comment-message"><p>After logging in if close the tab and open the same url in new tab , i have to login again . If i use $window.localStorage then can i change this behaviour ?</p>
</div>
</div>
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="dsq-comment-3318">
<div id="dsq-comment-header-3318" class="dsq-comment-header">
<cite id="dsq-cite-3318">
<span id="dsq-author-user-3318">Hope</span>
</cite>
</div>
<div id="dsq-comment-body-3318" class="dsq-comment-body">
<div id="dsq-comment-message-3318" class="dsq-comment-message"><p>It is GREAT!<br />
Thank you)</p>
</div>
</div>
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="dsq-comment-3307">
<div id="dsq-comment-header-3307" class="dsq-comment-header">
<cite id="dsq-cite-3307">
<span id="dsq-author-user-3307">Subhendu Mahanta</span>
</cite>
</div>
<div id="dsq-comment-body-3307" class="dsq-comment-body">
<div id="dsq-comment-message-3307" class="dsq-comment-message"><p>I am using nodeclipse eclipse plugin &amp; Postman chrome app to try your code.When trying the url <a href="http://localhost:3000/api/v1/products" onclick="__gaTracker('send', 'event', 'outbound-comment', 'http://localhost:3000/api/v1/products', 'http://localhost:3000/api/v1/products');" rel="nofollow">http://localhost:3000/api/v1/products</a> with 3 headers Content-Type, x-access-token,x-key i am getting this error:<br />
Error: Not Found<br />
at C:Usersmahantasneonworkspacemyrestappserverserver.js:37:13<br />
at Layer.handle [as handle_request] (C:Usersmahantasneonworkspacemyrestappservernode_modulesexpresslibrouterlayer.js:95:5)<br />
at trim_prefix (C:Usersmahantasneonworkspacemyrestappservernode_modulesexpresslibrouterindex.js:312:13)<br />
at C:Usersmahantasneonworkspacemyrestappservernode_modulesexpresslibrouterindex.js:280:7<br />
at Function.process_params (C:Usersmahantasneonworkspacemyrestappservernode_modulesexpresslibrouterindex.js:330:12)<br />
at next (C:Usersmahantasneonworkspacemyrestappservernode_modulesexpresslibrouterindex.js:271:10)<br />
at C:Usersmahantasneonworkspacemyrestappservernode_modulesexpresslibrouterindex.js:618:15<br />
at next (C:Usersmahantasneonworkspacemyrestappservernode_modulesexpresslibrouterindex.js:256:14)<br />
at Function.handle (C:Usersmahantasneonworkspacemyrestappservernode_modulesexpresslibrouterindex.js:176:3)<br />
at router (C:Usersmahantasneonworkspacemyrestappservernode_modulesexpresslibrouterindex.js:46:12)<br />
What I am doing wrong?</p>
</div>
</div>
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="dsq-comment-3291">
<div id="dsq-comment-header-3291" class="dsq-comment-header">
<cite id="dsq-cite-3291">
<span id="dsq-author-user-3291">Richard Lopes</span>
</cite>
</div>
<div id="dsq-comment-body-3291" class="dsq-comment-body">
<div id="dsq-comment-message-3291" class="dsq-comment-message"><p>Does invalid routes ask for token? It should happen?</p>
</div>
</div>
<ul class="children">
<li class="comment even depth-2" id="dsq-comment-3292">
<div id="dsq-comment-header-3292" class="dsq-comment-header">
<cite id="dsq-cite-3292">
./                <span id="dsq-author-user-3292">Arvind Ravulavaru</span>
</cite>
</div>
<div id="dsq-comment-body-3292" class="dsq-comment-body">
<div id="dsq-comment-message-3292" class="dsq-comment-message"><p>What exactly do you mean by an invalid route?</p>
<p>In the above setup, we are validating token on specific routes like</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div id="crayon-5a103f9ed1c94797377586" class="crayon-syntax crayon-theme-arduino-ide crayon-font-droid-sans-mono crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
app.all('/api/v1/*', [require('./middlewares/validateRequest')]);</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums" data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a103f9ed1c94797377586-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a103f9ed1c94797377586-1"><span class="crayon-v">app</span><span class="crayon-sy">.</span><span class="crayon-e">all</span><span class="crayon-sy">(</span><span class="crayon-s">'/api/v1/*'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-e">require</span><span class="crayon-sy">(</span><span class="crayon-s">'./middlewares/validateRequest'</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0011 seconds] -->
<p>Here, you can provide a URL pattern, to match your needs.</p>
</div>
</div>
<ul class="children">
<li class="comment odd alt depth-3" id="dsq-comment-3294">
<div id="dsq-comment-header-3294" class="dsq-comment-header">
<cite id="dsq-cite-3294">
<span id="dsq-author-user-3294">Richard Lopes</span>
</cite>
</div>
<div id="dsq-comment-body-3294" class="dsq-comment-body">
<div id="dsq-comment-message-3294" class="dsq-comment-message"><p>/api/v1/monkeys</p>
<p>Is this routes valid? No <img src="./wp-includes/images/smilies/simple-smile.png" alt=":)" class="wp-smiley" style="height: 1em; max-height: 1em;" /></p>
<p>But when I try to access it, I will receive a message that will request a token. Right?</p>
<p>A token should be asken only if a route exists&#8230; Right?</p>
</div>
</div>
<ul class="children">
<li class="comment even depth-4" id="dsq-comment-3295">
<div id="dsq-comment-header-3295" class="dsq-comment-header">
<cite id="dsq-cite-3295">
./                <span id="dsq-author-user-3295">Arvind Ravulavaru</span>
</cite>
</div>
<div id="dsq-comment-body-3295" class="dsq-comment-body">
<div id="dsq-comment-message-3295" class="dsq-comment-message"><p>Not necessarily. It&#8217;s up to you on how you  want your app to behave. If you want api/v1/monkeys to be valid you can make it valid, if you don&#8217;t, you don&#8217;t. </p>
<p>Generally in a zoo app, that is a valid end point <img src="./wp-includes/images/smilies/simple-smile.png" alt=":)" class="wp-smiley" style="height: 1em; max-height: 1em;" /> </p>
</div>
</div>
<ul class="children">
<li class="comment odd alt depth-5" id="dsq-comment-3296">
<div id="dsq-comment-header-3296" class="dsq-comment-header">
<cite id="dsq-cite-3296">
<span id="dsq-author-user-3296">Richard Lopes</span>
</cite>
</div>
<div id="dsq-comment-body-3296" class="dsq-comment-body">
<div id="dsq-comment-message-3296" class="dsq-comment-message"><p>Sure. But on that context, how can I return a <code>404</code> if a route doesn&#8217;t exist and return &#8220;Invalid token&#8221; if a token isn&#8217;t supplied?</p>
</div>
</div>
</li><!-- #comment-## -->
<li class="comment even depth-5" id="dsq-comment-3297">
<div id="dsq-comment-header-3297" class="dsq-comment-header">
<cite id="dsq-cite-3297">
./                <span id="dsq-author-user-3297">Arvind Ravulavaru</span>
</cite>
</div>
<div id="dsq-comment-body-3297" class="dsq-comment-body">
<div id="dsq-comment-message-3297" class="dsq-comment-message"><p>Take a look at <a href="https://expressjs.com/en/guide/routing.html" onclick="__gaTracker('send', 'event', 'outbound-comment', 'https://expressjs.com/en/guide/routing.html', 'express routing');" rel="nofollow">express routing</a>. If the route pattern you define does match the available routes, it would automatically take the request to a 404. This line</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div id="crayon-5a103f9ed19b2991005281" class="crayon-syntax crayon-theme-arduino-ide crayon-font-droid-sans-mono crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
app.use('/', require('./routes'))</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums" data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a103f9ed19b2991005281-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a103f9ed19b2991005281-1"><span class="crayon-v">app</span><span class="crayon-sy">.</span><span class="crayon-st">use</span><span class="crayon-sy">(</span><span class="crayon-s">'/'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">require</span><span class="crayon-sy">(</span><span class="crayon-s">'./routes'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0007 seconds] -->
<p></p>
<p>If you still want to process each incoming URL yourself, you can always do something like this</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div id="crayon-5a103f9ed19c1023626663" class="crayon-syntax crayon-theme-arduino-ide crayon-font-droid-sans-mono crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
app.all('/*', function(req, res, next) {
var token = (req.body &amp;&amp; req.body.access_token) || (req.query &amp;&amp; req.query.access_token) || req.headers['x-access-token'];
if (invalidCondition) { // this condition can be to check for a token or anything you would like a request to adhere to
return res.status(404).end();
} else {
next();
}
});
</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums" data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a103f9ed19c1023626663-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ed19c1023626663-2">2</div><div class="crayon-num" data-line="crayon-5a103f9ed19c1023626663-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ed19c1023626663-4">4</div><div class="crayon-num" data-line="crayon-5a103f9ed19c1023626663-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ed19c1023626663-6">6</div><div class="crayon-num" data-line="crayon-5a103f9ed19c1023626663-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ed19c1023626663-8">8</div><div class="crayon-num" data-line="crayon-5a103f9ed19c1023626663-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ed19c1023626663-10">10</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a103f9ed19c1023626663-1">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ed19c1023626663-2"><span class="crayon-v">app</span><span class="crayon-sy">.</span><span class="crayon-e">all</span><span class="crayon-sy">(</span><span class="crayon-s">'/*'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-v">req</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">res</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">next</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a103f9ed19c1023626663-3"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">token</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">req</span><span class="crayon-sy">.</span><span class="crayon-v">body</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-v">req</span><span class="crayon-sy">.</span><span class="crayon-v">body</span><span class="crayon-sy">.</span><span class="crayon-v">access_token</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">||</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">req</span><span class="crayon-sy">.</span><span class="crayon-v">query</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-v">req</span><span class="crayon-sy">.</span><span class="crayon-v">query</span><span class="crayon-sy">.</span><span class="crayon-v">access_token</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">||</span><span class="crayon-h"> </span><span class="crayon-v">req</span><span class="crayon-sy">.</span><span class="crayon-v">headers</span><span class="crayon-sy">[</span><span class="crayon-s">'x-access-token'</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ed19c1023626663-4"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">invalidCondition</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-h"> </span><span class="crayon-c">// this condition can be to check for a token or anything you would like a request to adhere to</span></div><div class="crayon-line" id="crayon-5a103f9ed19c1023626663-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">res</span><span class="crayon-sy">.</span><span class="crayon-e">status</span><span class="crayon-sy">(</span><span class="crayon-cn">404</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-st">end</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ed19c1023626663-6"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a103f9ed19c1023626663-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">next</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ed19c1023626663-8"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5a103f9ed19c1023626663-9"><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ed19c1023626663-10">&nbsp;</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0046 seconds] -->
<p></p>
</div>
</div>
</li><!-- #comment-## -->
<li class="comment odd alt depth-5" id="dsq-comment-3298">
<div id="dsq-comment-header-3298" class="dsq-comment-header">
<cite id="dsq-cite-3298">
<span id="dsq-author-user-3298">Richard Lopes</span>
</cite>
</div>
<div id="dsq-comment-body-3298" class="dsq-comment-body">
<div id="dsq-comment-message-3298" class="dsq-comment-message"><p>This code makes all requests, /*, ask for a token, Including unregistered routes! That&#8217;s my point. Is there any way to check if a route is registered and then if that route is registered, ask for a token?</p>
</div>
</div>
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="dsq-comment-3275">
<div id="dsq-comment-header-3275" class="dsq-comment-header">
<cite id="dsq-cite-3275">
<span id="dsq-author-user-3275">Dave Morris</span>
</cite>
</div>
<div id="dsq-comment-body-3275" class="dsq-comment-body">
<div id="dsq-comment-message-3275" class="dsq-comment-message"><p>Thank you, great post!!!</p>
</div>
</div>
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="dsq-comment-3201">
<div id="dsq-comment-header-3201" class="dsq-comment-header">
<cite id="dsq-cite-3201">
http://kolyjjj.github.io                <span id="dsq-author-user-3201">koly</span>
</cite>
</div>
<div id="dsq-comment-body-3201" class="dsq-comment-body">
<div id="dsq-comment-message-3201" class="dsq-comment-message"><p>when you log out on the front end, you just delete the session storage token and there is no request to the backend. So this is just a logout on the front end. After the log out, the user can still use the previous token, is this ok?</p>
</div>
</div>
<ul class="children">
<li class="comment even depth-2" id="dsq-comment-3293">
<div id="dsq-comment-header-3293" class="dsq-comment-header">
<cite id="dsq-cite-3293">
./                <span id="dsq-author-user-3293">Arvind Ravulavaru</span>
</cite>
</div>
<div id="dsq-comment-body-3293" class="dsq-comment-body">
<div id="dsq-comment-message-3293" class="dsq-comment-message"><p>Yes, once you delete the session storage, the token is lost, and that acts as log out. And yes, the user can copy the token from session storage and then add it back manually after deleting the token from session storage. As long as the token is valid (Expiry or Role Validation), the incoming request will be valid.</p>
</div>
</div>
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="dsq-comment-3197">
<div id="dsq-comment-header-3197" class="dsq-comment-header">
<cite id="dsq-cite-3197">
<span id="dsq-author-user-3197">Omkar</span>
</cite>
</div>
<div id="dsq-comment-body-3197" class="dsq-comment-body">
<div id="dsq-comment-message-3197" class="dsq-comment-message"><p>Excellent Tutorial&#8230;However we can make it more loosely coupled &#8230;&#8230;kinda tightly coupled right now&#8230; divide everything into modules</p>
</div>
</div>
<ul class="children">
<li class="comment even depth-2" id="dsq-comment-3198">
<div id="dsq-comment-header-3198" class="dsq-comment-header">
<cite id="dsq-cite-3198">
./                <span id="dsq-author-user-3198">Arvind Ravulavaru</span>
</cite>
</div>
<div id="dsq-comment-body-3198" class="dsq-comment-body">
<div id="dsq-comment-message-3198" class="dsq-comment-message"><p>Can you elaborate?</p>
</div>
</div>
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="dsq-comment-3188">
<div id="dsq-comment-header-3188" class="dsq-comment-header">
<cite id="dsq-cite-3188">
<span id="dsq-author-user-3188">WonderHeart</span>
</cite>
</div>
<div id="dsq-comment-body-3188" class="dsq-comment-body">
<div id="dsq-comment-message-3188" class="dsq-comment-message"><p>Thanks for the detailed article. I have one query though- For the first<br />
time user signs up with his user credentials. Where are these<br />
credentials stored initially? are they encrypted and stored in database?<br />
I am<br />
asking this because, i want to know how the server knows to validate the<br />
user whether he is logged with correct password or username. He should<br />
be validated against something, right?</p>
</div>
</div>
<ul class="children">
<li class="comment even depth-2" id="dsq-comment-3189">
<div id="dsq-comment-header-3189" class="dsq-comment-header">
<cite id="dsq-cite-3189">
./                <span id="dsq-author-user-3189">Arvind Ravulavaru</span>
</cite>
</div>
<div id="dsq-comment-body-3189" class="dsq-comment-body">
<div id="dsq-comment-message-3189" class="dsq-comment-message"><p>Yes,  you need to have a sign up page for on boarding the user. </p>
</div>
</div>
<ul class="children">
<li class="comment odd alt depth-3" id="dsq-comment-3190">
<div id="dsq-comment-header-3190" class="dsq-comment-header">
<cite id="dsq-cite-3190">
<span id="dsq-author-user-3190">WonderHeart</span>
</cite>
</div>
<div id="dsq-comment-body-3190" class="dsq-comment-body">
<div id="dsq-comment-message-3190" class="dsq-comment-message"><p>ok, so where are these credentials stored initially?I am just trying to connect the first validation process..</p>
</div>
</div>
<ul class="children">
<li class="comment even depth-4" id="dsq-comment-3191">
<div id="dsq-comment-header-3191" class="dsq-comment-header">
<cite id="dsq-cite-3191">
./                <span id="dsq-author-user-3191">Arvind Ravulavaru</span>
</cite>
</div>
<div id="dsq-comment-body-3191" class="dsq-comment-body">
<div id="dsq-comment-message-3191" class="dsq-comment-message"><p>Its hardcoded for this example : <a href="https://github.com/arvindr21/myRESTApp/blob/master/server/routes/auth.js#L43" onclick="__gaTracker('send', 'event', 'outbound-comment', 'https://github.com/arvindr21/myRESTApp/blob/master/server/routes/auth.js#L43', 'https://github.com/arvindr21/myRESTApp/blob/master/server/routes/auth.js#L43');" rel="nofollow">https://github.com/arvindr21/myRESTApp/blob/master/server/routes/auth.js#L43</a></p>
</div>
</div>
<ul class="children">
<li class="comment odd alt depth-5" id="dsq-comment-3193">
<div id="dsq-comment-header-3193" class="dsq-comment-header">
<cite id="dsq-cite-3193">
<span id="dsq-author-user-3193">WonderHeart</span>
</cite>
</div>
<div id="dsq-comment-body-3193" class="dsq-comment-body">
<div id="dsq-comment-message-3193" class="dsq-comment-message"><p>Thanks!</p>
</div>
</div>
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="dsq-comment-3184">
<div id="dsq-comment-header-3184" class="dsq-comment-header">
<cite id="dsq-cite-3184">
<span id="dsq-author-user-3184">Віктор Борщов</span>
</cite>
</div>
<div id="dsq-comment-body-3184" class="dsq-comment-body">
<div id="dsq-comment-message-3184" class="dsq-comment-message"><p>Thank you for a great tutorial!<br />
I have a problem. Here <a href="https://bitbucket.org/snippets/vborshchov/bKbap" onclick="__gaTracker('send', 'event', 'outbound-comment', 'https://bitbucket.org/snippets/vborshchov/bKbap', 'https://bitbucket.org/snippets/vborshchov/bKbap');" rel="nofollow">https://bitbucket.org/snippets/vborshchov/bKbap</a> I have a code with changes in validate function. And I cannot login to my app, every time I get response with message &#8220;Invalid credentials&#8221;. I have discovered  that line 2 executes after lines 4-19. How can I change the execution order?</p>
</div>
</div>
<ul class="children">
<li class="comment odd alt depth-2" id="dsq-comment-3192">
<div id="dsq-comment-header-3192" class="dsq-comment-header">
<cite id="dsq-cite-3192">
./                <span id="dsq-author-user-3192">Arvind Ravulavaru</span>
</cite>
</div>
<div id="dsq-comment-body-3192" class="dsq-comment-body">
<div id="dsq-comment-message-3192" class="dsq-comment-message"><p>You are mixing sync with async. </p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div id="crayon-5a103f9ed2105314373499" class="crayon-syntax crayon-theme-arduino-ide crayon-font-droid-sans-mono crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
auth.validate(username, password, function(err, dbUserObj){
if (err || !dbUserObj) { // If authentication fails, we send a 401 back
res.status(401);
res.json({
"status": 401,
"message": "Invalid credentials"
});
return;
}
if (dbUserObj) {
// If authentication is success, we will generate a token
// and dispatch it to the client
res.json(genToken(dbUserObj));
}
});
</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums" data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a103f9ed2105314373499-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ed2105314373499-2">2</div><div class="crayon-num" data-line="crayon-5a103f9ed2105314373499-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ed2105314373499-4">4</div><div class="crayon-num" data-line="crayon-5a103f9ed2105314373499-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ed2105314373499-6">6</div><div class="crayon-num" data-line="crayon-5a103f9ed2105314373499-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ed2105314373499-8">8</div><div class="crayon-num" data-line="crayon-5a103f9ed2105314373499-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ed2105314373499-10">10</div><div class="crayon-num" data-line="crayon-5a103f9ed2105314373499-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ed2105314373499-12">12</div><div class="crayon-num" data-line="crayon-5a103f9ed2105314373499-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ed2105314373499-14">14</div><div class="crayon-num" data-line="crayon-5a103f9ed2105314373499-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ed2105314373499-16">16</div><div class="crayon-num" data-line="crayon-5a103f9ed2105314373499-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ed2105314373499-18">18</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a103f9ed2105314373499-1">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ed2105314373499-2"><span class="crayon-h"> </span><span class="crayon-v">auth</span><span class="crayon-sy">.</span><span class="crayon-e">validate</span><span class="crayon-sy">(</span><span class="crayon-v">username</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">password</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-v">err</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dbUserObj</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a103f9ed2105314373499-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">err</span><span class="crayon-h"> </span><span class="crayon-o">||</span><span class="crayon-h"> </span><span class="crayon-o">!</span><span class="crayon-v">dbUserObj</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-h"> </span><span class="crayon-c">// If authentication fails, we send a 401 back</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ed2105314373499-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">res</span><span class="crayon-sy">.</span><span class="crayon-e">status</span><span class="crayon-sy">(</span><span class="crayon-cn">401</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a103f9ed2105314373499-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">res</span><span class="crayon-sy">.</span><span class="crayon-e">json</span><span class="crayon-sy">(</span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ed2105314373499-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"status"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">401</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5a103f9ed2105314373499-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"message"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"Invalid credentials"</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ed2105314373499-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a103f9ed2105314373499-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ed2105314373499-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5a103f9ed2105314373499-11">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ed2105314373499-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">dbUserObj</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a103f9ed2105314373499-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// If authentication is success, we will generate a token</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ed2105314373499-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// and dispatch it to the client</span></div><div class="crayon-line" id="crayon-5a103f9ed2105314373499-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">res</span><span class="crayon-sy">.</span><span class="crayon-e">json</span><span class="crayon-sy">(</span><span class="crayon-e">genToken</span><span class="crayon-sy">(</span><span class="crayon-v">dbUserObj</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ed2105314373499-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5a103f9ed2105314373499-17"><span class="crayon-h"> </span><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ed2105314373499-18">&nbsp;</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0037 seconds] -->
<p>and your validate function would be</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div id="crayon-5a103f9ed210e446014898" class="crayon-syntax crayon-theme-arduino-ide crayon-font-droid-sans-mono crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
validate: function(username, password, callback) {
var dbUserObj;
User.findOne({ name: username }, function(err, user) {
if (user) {
user.comparePassword(password, function(err, isMatch) {
if (isMatch) {
dbUserObj = {
name: user.name,
admin: user.admin
};
}
callback(err, dbUserObj);
});
}
});
}
</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums" data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a103f9ed210e446014898-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ed210e446014898-2">2</div><div class="crayon-num" data-line="crayon-5a103f9ed210e446014898-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ed210e446014898-4">4</div><div class="crayon-num" data-line="crayon-5a103f9ed210e446014898-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ed210e446014898-6">6</div><div class="crayon-num" data-line="crayon-5a103f9ed210e446014898-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ed210e446014898-8">8</div><div class="crayon-num" data-line="crayon-5a103f9ed210e446014898-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ed210e446014898-10">10</div><div class="crayon-num" data-line="crayon-5a103f9ed210e446014898-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ed210e446014898-12">12</div><div class="crayon-num" data-line="crayon-5a103f9ed210e446014898-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ed210e446014898-14">14</div><div class="crayon-num" data-line="crayon-5a103f9ed210e446014898-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ed210e446014898-16">16</div><div class="crayon-num" data-line="crayon-5a103f9ed210e446014898-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a103f9ed210e446014898-18">18</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a103f9ed210e446014898-1">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ed210e446014898-2"><span class="crayon-v">validate</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-v">username</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">password</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">callback</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a103f9ed210e446014898-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">dbUserObj</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ed210e446014898-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">User</span><span class="crayon-sy">.</span><span class="crayon-e">findOne</span><span class="crayon-sy">(</span><span class="crayon-sy">{</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">username</span><span class="crayon-h"> </span><span class="crayon-sy">}</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-v">err</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">user</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a103f9ed210e446014898-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">user</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ed210e446014898-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">user</span><span class="crayon-sy">.</span><span class="crayon-e">comparePassword</span><span class="crayon-sy">(</span><span class="crayon-v">password</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-v">err</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">isMatch</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a103f9ed210e446014898-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">isMatch</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ed210e446014898-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">dbUserObj</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a103f9ed210e446014898-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">name</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">user</span><span class="crayon-sy">.</span><span class="crayon-v">name</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ed210e446014898-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">admin</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">user</span><span class="crayon-sy">.</span><span class="crayon-i">admin</span></div><div class="crayon-line" id="crayon-5a103f9ed210e446014898-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ed210e446014898-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5a103f9ed210e446014898-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">callback</span><span class="crayon-sy">(</span><span class="crayon-v">err</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dbUserObj</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ed210e446014898-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a103f9ed210e446014898-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ed210e446014898-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a103f9ed210e446014898-17"><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a103f9ed210e446014898-18">&nbsp;</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0075 seconds] -->
<p></p>
<p>Pls. understand the difference between async and sync before you start building an application with security in Nodejs : <a href="http://stackoverflow.com/q/27659116/1015046" onclick="__gaTracker('send', 'event', 'outbound-comment', 'http://stackoverflow.com/q/27659116/1015046', 'http://stackoverflow.com/q/27659116/1015046');" rel="nofollow">http://stackoverflow.com/q/27659116/1015046</a></p>
</div>
</div>
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="dsq-comment-3183">
<div id="dsq-comment-header-3183" class="dsq-comment-header">
<cite id="dsq-cite-3183">
<span id="dsq-author-user-3183">JUNIOR FERREIRA</span>
</cite>
</div>
<div id="dsq-comment-body-3183" class="dsq-comment-body">
<div id="dsq-comment-message-3183" class="dsq-comment-message"><p>I did not like , lacked access to MongoDB is here my criticism !</p>
</div>
</div>
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="dsq-comment-3138">
<div id="dsq-comment-header-3138" class="dsq-comment-header">
<cite id="dsq-cite-3138">
<span id="dsq-author-user-3138">Yves Dufour</span>
</cite>
</div>
<div id="dsq-comment-body-3138" class="dsq-comment-body">
<div id="dsq-comment-message-3138" class="dsq-comment-message"><p>Hi Arvind</p>
<p>Thanks for this clear article&#8230;</p>
<p>I run all the steps ..; server is running fine, I can test it with curl request..</p>
<p>basic generated Anguler app is also running fine..</p>
<p>however after performing all file modifications , and requesting again <a href="http://localhost:2772/" onclick="__gaTracker('send', 'event', 'outbound-comment', 'http://localhost:2772', 'http://localhost:2772');" rel="nofollow">http://localhost:2772</a> I don&#8217;t get the login page&#8230;</p>
<p>only a blank page </p>
<p>source code of the   page is </p>
<p>Did I miss any important update ?</p>
<p>yves</p>
</div>
</div>
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="dsq-comment-3116">
<div id="dsq-comment-header-3116" class="dsq-comment-header">
<cite id="dsq-cite-3116">
<span id="dsq-author-user-3116">Marco Solari</span>
</cite>
</div>
<div id="dsq-comment-body-3116" class="dsq-comment-body">
<div id="dsq-comment-message-3116" class="dsq-comment-message"><p>Did you voluntarily use <code>$window.sessionStorage</code> instead of <code>$window.localStorage</code> ?<br />
I&#8217;d expect to be always logged in &#8211; even after closing and reopening the browser (or session) &#8211; at least until JWT expires&#8230; Am I wrong? I don&#8217;t understand what&#8217;s the advantage to specify a 7-days expiration time for tokens, if you have to re log in everytime you access the site&#8230; I&#8217;d espect a behavour like <code>google.com</code>, where you stay logged across sessions for some weeks&#8230;</p>
</div>
</div>
<ul class="children">
<li class="comment odd alt depth-2" id="dsq-comment-3337">
<div id="dsq-comment-header-3337" class="dsq-comment-header">
<cite id="dsq-cite-3337">
http://1598.zz.vc                <span id="dsq-author-user-3337">Divyanshu Singh Pathania</span>
</cite>
</div>
<div id="dsq-comment-body-3337" class="dsq-comment-body">
<div id="dsq-comment-message-3337" class="dsq-comment-message"><p>after logging in if close the tab and open the same url in new tab , i have to login again . If i use $window.localStorage then can i change this behaviour ?</p>
</div>
</div>
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="dsq-comment-3112">
<div id="dsq-comment-header-3112" class="dsq-comment-header">
<cite id="dsq-cite-3112">
<span id="dsq-author-user-3112">Harshad</span>
</cite>
</div>
<div id="dsq-comment-body-3112" class="dsq-comment-body">
<div id="dsq-comment-message-3112" class="dsq-comment-message"><p>JWT now trims the expiry token </p>
<p>Instead of 1420636467027 now you get 1420636467 in &#8220;exp&#8221;.</p>
<p>Also there is no need to manually check token expiry. JWT err can be made useof here.</p>
<p>  return jwt.verify(token, config.secret, function (err, decoded) {</p>
<p>      if(err){</p>
<p>        if(err.name == &#8220;TokenExpiredError&#8221;){</p>
<p>          return res.status(400).json({ error: &#8220;Token expired&#8221; })</p>
<p>        }else if(err.name == &#8220;JsonWebTokenError&#8221;){</p>
<p>          return res.status(401).json({ error: &#8220;Invalid Token&#8221; })</p>
<p>        }</p>
<p>      }else if(decoded){</p>
<p>        next();</p>
<p>      }</p>
<p>    });</p>
</div>
</div>
<ul class="children">
<li class="comment odd alt depth-2" id="dsq-comment-3121">
<div id="dsq-comment-header-3121" class="dsq-comment-header">
<cite id="dsq-cite-3121">
<span id="dsq-author-user-3121">Marco Solari</span>
</cite>
</div>
<div id="dsq-comment-body-3121" class="dsq-comment-body">
<div id="dsq-comment-message-3121" class="dsq-comment-message"><p>Which JWT module are you speaking of?<br />
<code>jwt-simple</code> ( <a href="https://github.com/hokaccha/node-jwt-simple" onclick="__gaTracker('send', 'event', 'outbound-comment', 'https://github.com/hokaccha/node-jwt-simple', 'https://github.com/hokaccha/node-jwt-simple');" rel="nofollow">https://github.com/hokaccha/node-jwt-simple</a> ) does not export <code>verify</code>&#8230; <img src="./wp-includes/images/smilies/frownie.png" alt=":-(" class="wp-smiley" style="height: 1em; max-height: 1em;" /></p>
</div>
</div>
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="dsq-comment-3107">
<div id="dsq-comment-header-3107" class="dsq-comment-header">
<cite id="dsq-cite-3107">
<span id="dsq-author-user-3107">Luis Florez</span>
</cite>
</div>
<div id="dsq-comment-body-3107" class="dsq-comment-body">
<div id="dsq-comment-message-3107" class="dsq-comment-message"><p>Hello Arvin.</p>
<p>Great article, thanks for sharing your knowledge. </p>
<p>Just one question, my collapsed menu is no showing when I click it, any ideas why this might be happening?</p>
<p>the normal menu shows and works perfect.</p>
<p>Thanks!!</p>
</div>
</div>
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="dsq-comment-3068">
<div id="dsq-comment-header-3068" class="dsq-comment-header">
<cite id="dsq-cite-3068">
<span id="dsq-author-user-3068">jnuc093</span>
</cite>
</div>
<div id="dsq-comment-body-3068" class="dsq-comment-body">
<div id="dsq-comment-message-3068" class="dsq-comment-message"><p>I tested successful by command line curl.<br />
is this right test by Postman?</p>
</div>
</div>
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="dsq-comment-3063">
<div id="dsq-comment-header-3063" class="dsq-comment-header">
<cite id="dsq-cite-3063">
https://franciskim.co                <span id="dsq-author-user-3063">Francis Kim</span>
</cite>
</div>
<div id="dsq-comment-body-3063" class="dsq-comment-body">
<div id="dsq-comment-message-3063" class="dsq-comment-message"><p>Excellent article &#8211; thanks so much.</p>
</div>
</div>
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="dsq-comment-2994">
<div id="dsq-comment-header-2994" class="dsq-comment-header">
<cite id="dsq-cite-2994">
<span id="dsq-author-user-2994">Roemer Blom</span>
</cite>
</div>
<div id="dsq-comment-body-2994" class="dsq-comment-body">
<div id="dsq-comment-message-2994" class="dsq-comment-message"><p>How could I make it so that only registered users can login, because at the moment I&#8217;m able to login just by entering something in the input fields.</p>
</div>
</div>
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="dsq-comment-2990">
<div id="dsq-comment-header-2990" class="dsq-comment-header">
<cite id="dsq-cite-2990">
<span id="dsq-author-user-2990">jf pwork</span>
</cite>
</div>
<div id="dsq-comment-body-2990" class="dsq-comment-body">
<div id="dsq-comment-message-2990" class="dsq-comment-message"><p>Hello &amp; Thanks,</p>
<p>as a window follower (;-( got that&#8230; </p>
<p>$ npm i -g gulp slush slush-ng<br />
[OK]</p>
<p>Hope it could help you</p>
<p>Best regards<br />
&#8212;-&gt;</p>
<p><a href="./cdn-cgi/l/email-protection/index.html" class="__cf_email__" data-cfemail="1d455d44">[email&#160;protected]</a> /cygdrive/c/a/b/_c/d/e/f/g/ngClient<br />
$ slush ng<br />
C:UsersXAppDataRoamingnpmnode_modulesslush-ngslushfile.js:35<br />
userName: format(user.name) || osUserName,<br />
^<br />
TypeError: Cannot read property &#8216;name&#8217; of undefined<br />
at C:UsersXAppDataRoamingnpmnode_modulesslush-ngslushfile.js:35:26<br />
at Object. (C:UsersXAppDataRoamingnpmnode_modulesslush-ngslushfile.js:38:3)<br />
at Module._compile (module.js:460:26)<br />
at Object.Module._extensions..js (module.js:478:10)<br />
at Module.load (module.js:355:32)<br />
at Function.Module._load (module.js:310:12)<br />
at Module.require (module.js:365:17)<br />
at require (module.js:384:17)<br />
at Liftoff.handleArguments (C:UsersXAppDataRoamingnpmnode_modulesslushbinslush.js:90:3)<br />
at Liftoff.launch (C:UsersXAppDataRoamingnpmnode_modulesslushnode_modulesliftoffindex.js:153:6)</p>
<p><a href="./cdn-cgi/l/email-protection/index.html" class="__cf_email__" data-cfemail="1d455d44">[email&#160;protected]</a> /cygdrive/c/a/b/_c/d/e/f/g/ngClient<br />
$ node -v<br />
v0.12.7<br />
$ gulp -v<br />
CLI version 3.9.0<br />
$ npm-v<br />
2.11.3</p>
</div>
</div>
<ul class="children">
<li class="comment odd alt depth-2" id="dsq-comment-2991">
<div id="dsq-comment-header-2991" class="dsq-comment-header">
<cite id="dsq-cite-2991">
<span id="dsq-author-user-2991">jf pwork</span>
</cite>
</div>
<div id="dsq-comment-body-2991" class="dsq-comment-body">
<div id="dsq-comment-message-2991" class="dsq-comment-message"><p>error come from the fact that no username and email are set globaly into .gitconfig<br />
$ git config -global user.name = &#8220;yourname&#8221;<br />
$ git config -global user.email = &#8220;<a href="./cdn-cgi/l/email-protection/index.html" class="__cf_email__" data-cfemail="9ce5f3e9eef2fdf1f9dcfff3f1ecfdf2e5b2fff3f1">[email&#160;protected]</a>&#8221;</p>
</div>
</div>
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="dsq-comment-2950">
<div id="dsq-comment-header-2950" class="dsq-comment-header">
<cite id="dsq-cite-2950">
<span id="dsq-author-user-2950">Priti</span>
</cite>
</div>
<div id="dsq-comment-body-2950" class="dsq-comment-body">
<div id="dsq-comment-message-2950" class="dsq-comment-message"><p>can you plz explain ?</p>
<p>for what purpose we will install </p>
<p>gulp, slush and slush-ng globally.</p>
</div>
</div>
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="dsq-comment-2949">
<div id="dsq-comment-header-2949" class="dsq-comment-header">
<cite id="dsq-cite-2949">
<span id="dsq-author-user-2949">Priti</span>
</cite>
</div>
<div id="dsq-comment-body-2949" class="dsq-comment-body">
<div id="dsq-comment-message-2949" class="dsq-comment-message"><p>How will it work with jade</p>
</div>
</div>
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="dsq-comment-2940">
<div id="dsq-comment-header-2940" class="dsq-comment-header">
<cite id="dsq-cite-2940">
<span id="dsq-author-user-2940">david lopes</span>
</cite>
</div>
<div id="dsq-comment-body-2940" class="dsq-comment-body">
<div id="dsq-comment-message-2940" class="dsq-comment-message"><p>Thx guy, I was in trouble about angularJs token-base auth, your front-end solution is mind blowing, thx a lot!</p>
</div>
</div>
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="dsq-comment-2924">
<div id="dsq-comment-header-2924" class="dsq-comment-header">
<cite id="dsq-cite-2924">
<span id="dsq-author-user-2924">wilsonfpz</span>
</cite>
</div>
<div id="dsq-comment-body-2924" class="dsq-comment-body">
<div id="dsq-comment-message-2924" class="dsq-comment-message"><p>Nice article, could you explain why not just return config but  return config || $q.when(config); ? thanks.</p>
</div>
</div>
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="dsq-comment-2920">
<div id="dsq-comment-header-2920" class="dsq-comment-header">
<cite id="dsq-cite-2920">
<span id="dsq-author-user-2920">Mohsin</span>
</cite>
</div>
<div id="dsq-comment-body-2920" class="dsq-comment-body">
<div id="dsq-comment-message-2920" class="dsq-comment-message"><p>Hi, Thanks for the post,</p>
<p>When i run the following command getting following error,  anything am i missing?</p>
<p>curl –data “{”username” : ”<a href="./cdn-cgi/l/email-protection/index.html" class="__cf_email__" data-cfemail="29485b5f40474d694450485959074a4644">[email&#160;protected]</a>”, ”password” : ”pass123”}” -H “content-type:application/json” <a href="http://localhost:3000/login" onclick="__gaTracker('send', 'event', 'outbound-comment', 'http://localhost:3000/login', 'http://localhost:3000/login');" rel="nofollow">http://localhost:3000/login</a></p>
<p>curl: (7) Failed connect to –data:80; Operation timed out</p>
<p>curl: (3) [globbing] unmatched brace at pos 19</p>
<p>curl: (7) Failed connect to :80; Connection refused</p>
<p>curl: (7) Failed connect to myapp.com”,:80; Operation timed out</p>
</div>
</div>
<ul class="children">
<li class="comment odd alt depth-2" id="dsq-comment-2925">
<div id="dsq-comment-header-2925" class="dsq-comment-header">
<cite id="dsq-cite-2925">
<span id="dsq-author-user-2925">Gareth Patterson</span>
</cite>
</div>
<div id="dsq-comment-body-2925" class="dsq-comment-body">
<div id="dsq-comment-message-2925" class="dsq-comment-message"><p>I&#8217;m seeing same issues with curl and -data&#8230; it seems to be putting the options after the host.  Put the URL immediately after curl and then &#8211;data, -H etc</p>
</div>
</div>
</li><!-- #comment-## -->
<li class="comment even depth-2" id="dsq-comment-2926">
<div id="dsq-comment-header-2926" class="dsq-comment-header">
<cite id="dsq-cite-2926">
<span id="dsq-author-user-2926">Gareth Patterson</span>
</cite>
</div>
<div id="dsq-comment-body-2926" class="dsq-comment-body">
<div id="dsq-comment-message-2926" class="dsq-comment-message"><p>Never mind&#8230; I&#8217;m wrong&#8230; I just used Postman instead&#8230; it works fine.  (REST browser plugin)</p>
</div>
</div>
<ul class="children">
<li class="comment odd alt depth-3" id="dsq-comment-3095">
<div id="dsq-comment-header-3095" class="dsq-comment-header">
<cite id="dsq-cite-3095">
<span id="dsq-author-user-3095">Jaden Ng</span>
</cite>
</div>
<div id="dsq-comment-body-3095" class="dsq-comment-body">
<div id="dsq-comment-message-3095" class="dsq-comment-message"><p>Hi,</p>
<p>May I know how to use Postman for the login session. Thanks <img src="./wp-includes/images/smilies/simple-smile.png" alt=":)" class="wp-smiley" style="height: 1em; max-height: 1em;" /></p>
</div>
</div>
<ul class="children">
<li class="comment even depth-4" id="dsq-comment-3096">
<div id="dsq-comment-header-3096" class="dsq-comment-header">
<cite id="dsq-cite-3096">
./                <span id="dsq-author-user-3096">Arvind Ravulavaru</span>
</cite>
</div>
<div id="dsq-comment-body-3096" class="dsq-comment-body">
<div id="dsq-comment-message-3096" class="dsq-comment-message"><p>Take a look at <a href="https://youtu.be/JZP2ose-OBQ" onclick="__gaTracker('send', 'event', 'outbound-comment', 'https://youtu.be/JZP2ose-OBQ', 'https://youtu.be/JZP2ose-OBQ');" rel="nofollow">https://youtu.be/JZP2ose-OBQ</a> you can search on YouTube for more. </p>
</div>
</div>
<ul class="children">
<li class="comment odd alt depth-5" id="dsq-comment-3097">
<div id="dsq-comment-header-3097" class="dsq-comment-header">
<cite id="dsq-cite-3097">
<span id="dsq-author-user-3097">Jaden Ng</span>
</cite>
</div>
<div id="dsq-comment-body-3097" class="dsq-comment-body">
<div id="dsq-comment-message-3097" class="dsq-comment-message"><p>Hi,</p>
<p>I followed the video but still encountered problem <img src="./wp-includes/images/smilies/frownie.png" alt=":(" class="wp-smiley" style="height: 1em; max-height: 1em;" /></p>
</div>
</div>
</li><!-- #comment-## -->
<li class="comment even depth-5" id="dsq-comment-3098">
<div id="dsq-comment-header-3098" class="dsq-comment-header">
<cite id="dsq-cite-3098">
./                <span id="dsq-author-user-3098">Arvind Ravulavaru</span>
</cite>
</div>
<div id="dsq-comment-body-3098" class="dsq-comment-body">
<div id="dsq-comment-message-3098" class="dsq-comment-message"><p>Try a raw request. With content type as application/json. And in the raw data can be a JSON like </p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div id="crayon-5a103f9ed2856163032474" class="crayon-syntax crayon-theme-arduino-ide crayon-font-droid-sans-mono crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
{username : arvind@myapp.com, password : pass123}</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums" data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a103f9ed2856163032474-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a103f9ed2856163032474-1"><span class="crayon-sy">{</span><span class="crayon-v">username</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">arvind</span><span class="crayon-sy">@</span><span class="crayon-v">myapp</span><span class="crayon-sy">.</span><span class="crayon-v">com</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">password</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">pass123</span><span class="crayon-sy">}</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0008 seconds] -->
<p></p>
</div>
</div>
</li><!-- #comment-## -->
<li class="comment odd alt depth-5" id="dsq-comment-3099">
<div id="dsq-comment-header-3099" class="dsq-comment-header">
<cite id="dsq-cite-3099">
<span id="dsq-author-user-3099">Jaden Ng</span>
</cite>
</div>
<div id="dsq-comment-body-3099" class="dsq-comment-body">
<div id="dsq-comment-message-3099" class="dsq-comment-message"><p>Hi,</p>
<p>It works now.</p>
<p>I tried raw request(JSON) with the following data,</p>
<p>{&#8220;username&#8221;:&#8221;<a href="./cdn-cgi/l/email-protection/index.html" class="__cf_email__" data-cfemail="e1809397888f85a18c98809191cf828e8c">[email&#160;protected]</a>&#8221;, &#8220;password&#8221;:&#8221;pass123&#8243;}</p>
</div>
</div>
</li><!-- #comment-## -->
<li class="comment even depth-5" id="dsq-comment-3105">
<div id="dsq-comment-header-3105" class="dsq-comment-header">
<cite id="dsq-cite-3105">
<span id="dsq-author-user-3105">Jaden Ng</span>
</cite>
</div>
<div id="dsq-comment-body-3105" class="dsq-comment-body">
<div id="dsq-comment-message-3105" class="dsq-comment-message"><p>Hi Arvind,</p>
<p>May I know how to use POSTMAN to fetch product by using token and key. How to fill the information into POSTMAN. Thanks</p>
</div>
</div>
</li><!-- #comment-## -->
<li class="comment odd alt depth-5" id="dsq-comment-3287">
<div id="dsq-comment-header-3287" class="dsq-comment-header">
<cite id="dsq-cite-3287">
<span id="dsq-author-user-3287">sanjay singh bisht</span>
</cite>
</div>
<div id="dsq-comment-body-3287" class="dsq-comment-body">
<div id="dsq-comment-message-3287" class="dsq-comment-message"><p>hey check it out.</p>
</div>
</div>
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even depth-2" id="dsq-comment-2931">
<div id="dsq-comment-header-2931" class="dsq-comment-header">
<cite id="dsq-cite-2931">
<span id="dsq-author-user-2931">HBI de SF</span>
</cite>
</div>
<div id="dsq-comment-body-2931" class="dsq-comment-body">
<div id="dsq-comment-message-2931" class="dsq-comment-message"><p>beware of the following font problems that will result in CURL command errors:<br />
&#8211; straight quotes (&#8220;&#8221;) that appear as awful smart quotes (“”)<br />
&#8211; double dash (&#8211;) that appear as an extended dash (–)</p>
<p>Here is the remedy:<br />
&#8211; paste code into Notepad<br />
&#8211; CTRL+H: find “ and replace with &#8221;<br />
&#8211; CTRL+H: find ” and replace with &#8221;<br />
&#8211; CTRL+H: find – and replace with &#8212;</p>
</div>
</div>
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="dsq-comment-2889">
<div id="dsq-comment-header-2889" class="dsq-comment-header">
<cite id="dsq-cite-2889">
<span id="dsq-author-user-2889">Hermes Sánchez</span>
</cite>
</div>
<div id="dsq-comment-body-2889" class="dsq-comment-body">
<div id="dsq-comment-message-2889" class="dsq-comment-message"><p>Help me please!, In my application I have token-based security setup. However, ANGULAR-FILE-UPLOAD doesn&#8217;t use $http and instead relies on XHR (think it is so). How would I go about intercepting an XHR request or just specifying headers to be send with the upload request? Thanks in advance. <img src="./wp-includes/images/smilies/frownie.png" alt=":(" class="wp-smiley" style="height: 1em; max-height: 1em;" /></p>
</div>
</div>
<ul class="children">
<li class="comment even depth-2" id="dsq-comment-2890">
<div id="dsq-comment-header-2890" class="dsq-comment-header">
<cite id="dsq-cite-2890">
./                <span id="dsq-author-user-2890">Arvind Ravulavaru</span>
</cite>
</div>
<div id="dsq-comment-body-2890" class="dsq-comment-body">
<div id="dsq-comment-message-2890" class="dsq-comment-message"><p>Take a look at <a href="https://github.com/nervgh/angular-file-upload/issues/486" onclick="__gaTracker('send', 'event', 'outbound-comment', 'https://github.com/nervgh/angular-file-upload/issues/486', 'https://github.com/nervgh/angular-file-upload/issues/486');" rel="nofollow">https://github.com/nervgh/angular-file-upload/issues/486</a></p>
</div>
</div>
<ul class="children">
<li class="comment odd alt depth-3" id="dsq-comment-2891">
<div id="dsq-comment-header-2891" class="dsq-comment-header">
<cite id="dsq-cite-2891">
<span id="dsq-author-user-2891">Hermes Sánchez</span>
</cite>
</div>
<div id="dsq-comment-body-2891" class="dsq-comment-body">
<div id="dsq-comment-message-2891" class="dsq-comment-message"><p>Thanks friend! <img src="./wp-includes/images/smilies/simple-smile.png" alt=":)" class="wp-smiley" style="height: 1em; max-height: 1em;" /></p>
</div>
</div>
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="dsq-comment-2845">
<div id="dsq-comment-header-2845" class="dsq-comment-header">
<cite id="dsq-cite-2845">
<span id="dsq-author-user-2845">Hermes Sánchez</span>
</cite>
</div>
<div id="dsq-comment-body-2845" class="dsq-comment-body">
<div id="dsq-comment-message-2845" class="dsq-comment-message"><p>Excelente articulo, un aporte importante. Muchisimas gracias por compartir sus conocimientos.</p>
</div>
</div>
<ul class="children">
<li class="comment odd alt depth-2" id="dsq-comment-2846">
<div id="dsq-comment-header-2846" class="dsq-comment-header">
<cite id="dsq-cite-2846">
./                <span id="dsq-author-user-2846">Arvind Ravulavaru</span>
</cite>
</div>
<div id="dsq-comment-body-2846" class="dsq-comment-body">
<div id="dsq-comment-message-2846" class="dsq-comment-message"><p>Thanks. </p>
</div>
</div>
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="dsq-comment-2842">
<div id="dsq-comment-header-2842" class="dsq-comment-header">
<cite id="dsq-cite-2842">
<span id="dsq-author-user-2842">Edisqus</span>
</cite>
</div>
<div id="dsq-comment-body-2842" class="dsq-comment-body">
<div id="dsq-comment-message-2842" class="dsq-comment-message"><p>&#8220;Extra.. Extra.. Read all about&#8221; &#8211; also, I think you too like The Who.</p>
</div>
</div>
<ul class="children">
<li class="comment odd alt depth-2" id="dsq-comment-2875">
<div id="dsq-comment-header-2875" class="dsq-comment-header">
<cite id="dsq-cite-2875">
./                <span id="dsq-author-user-2875">Arvind Ravulavaru</span>
</cite>
</div>
<div id="dsq-comment-body-2875" class="dsq-comment-body">
<div id="dsq-comment-message-2875" class="dsq-comment-message"><p>LOL!</p>
</div>
</div>
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="dsq-comment-2838">
<div id="dsq-comment-header-2838" class="dsq-comment-header">
<cite id="dsq-cite-2838">
<span id="dsq-author-user-2838">Edisqus</span>
</cite>
</div>
<div id="dsq-comment-body-2838" class="dsq-comment-body">
<div id="dsq-comment-message-2838" class="dsq-comment-message"><p>One may have to give full control permissions to certain directories in order for files to be saved. Thanks a lot!</p>
</div>
</div>
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="dsq-comment-2790">
<div id="dsq-comment-header-2790" class="dsq-comment-header">
<cite id="dsq-cite-2790">
<span id="dsq-author-user-2790">김영덕</span>
</cite>
</div>
<div id="dsq-comment-body-2790" class="dsq-comment-body">
<div id="dsq-comment-message-2790" class="dsq-comment-message"><p>Thanks for AMAZING article Arvind!  It&#8217;s really Awesome but, I have some questions.<br />
What does &#8220;delete this.user;&#8221; mean in AuthenticationFactory. I think function &#8220;check&#8221; is a method so it will be bind with &#8216;auth&#8217; object. But, there is no &#8216;user&#8217; property in &#8216;auth&#8217; Object. Can you explain it?<br />
Also, in &#8216;UserAuthFactory&#8217;  (delete AuthenticationFactory.user, delete AuthenticationFactory.userRole)<br />
I can&#8217;t figure out what is &#8220;user&#8221; and &#8220;userRole&#8221; properties. There are no such properties in AuthenticationFactory.</p>
</div>
</div>
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="dsq-comment-2775">
<div id="dsq-comment-header-2775" class="dsq-comment-header">
<cite id="dsq-cite-2775">
<span id="dsq-author-user-2775">Andres</span>
</cite>
</div>
<div id="dsq-comment-body-2775" class="dsq-comment-body">
<div id="dsq-comment-message-2775" class="dsq-comment-message"><p>I write localhost:2772 get some idea blank page I am doing wrong ?</p>
</div>
</div>
<ul class="children">
<li class="comment odd alt depth-2" id="dsq-comment-2776">
<div id="dsq-comment-header-2776" class="dsq-comment-header">
<cite id="dsq-cite-2776">
./                <span id="dsq-author-user-2776">Arvind Ravulavaru</span>
</cite>
</div>
<div id="dsq-comment-body-2776" class="dsq-comment-body">
<div id="dsq-comment-message-2776" class="dsq-comment-message"><p>Thanks Andres, does you / route dispatch a page? </p>
</div>
</div>
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul>
<div class="navigation">
<div class="nav-previous">
<span class="meta-nav">&larr;</span>
&nbsp;<a href="./comment-page-1/index.html#comments" >Older Comments</a>                </div>
<div class="nav-next">
&nbsp;<span class="meta-nav">&rarr;</span>
</div>
</div><!-- .navigation -->
</div>
</div>
<script src="./cdn-cgi/scripts/0e574bed/cloudflare-static/email-decode.min.js"></script><script type="text/javascript">
var disqus_url = './architecting-a-restful-node-js-app/';
var disqus_identifier = '2043 ./?p=2043';
var disqus_container_id = 'disqus_thread';
var disqus_shortname = 'thejackalofjavascriptcom';
var disqus_title = "Architecting a Secure RESTful Node.js app";
var disqus_config_custom = window.disqus_config;
var disqus_config = function () {
/*
All currently supported events:
onReady: fires when everything is ready,
onNewComment: fires when a new comment is posted,
onIdentify: fires when user is authenticated
*/
this.language = '';
this.callbacks.onReady.push(function () {
// sync comments in the background so we don't block the page
var script = document.createElement('script');
script.async = true;
script.src = '?cf_action=sync_comments&post_id=2043';
var firstScript = document.getElementsByTagName('script')[0];
firstScript.parentNode.insertBefore(script, firstScript);
});
if (disqus_config_custom) {
disqus_config_custom.call(this);
}
};
(function() {
var dsq = document.createElement('script'); dsq.type = 'text/javascript';
dsq.async = true;
dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>
</main><!-- #main -->
</div><!-- #primary -->
<div id="secondary" class="widget-area" role="complementary">
<aside id="search-2" class="widget widget_search"><form role="search" method="get" class="search-form" action="./index.html">
<label>
<span class="screen-reader-text">Search for:</span>
<input type="search" class="search-field" placeholder="Search &hellip;" value="" name="s">
</label>
<input type="submit" class="search-submit" value="Search">
</form>
</aside><aside id="text-2" class="widget widget_text"><h1 class="widget-title">This is me!!</h1>			<div class="textwidget"><style>
.socl-btn
{
padding: 3px;
background: #f45145;
border-radius: 3px;
color: rgba(255, 255, 255, 0.6) !important;
margin-top: 9px;
display: inline-block;
text-align: center;
width:100%;
-webkit-transition: all 0.2s ease-in-out;
-moz-transition: all 0.2s ease-in-out;
-o-transition: all 0.2s ease-in-out;
transition: all 0.2s ease-in-out;
}
.socl-btn:hover{
color:#fff !important;
}
.lkdin{
background-image: url(./wp-content/uploads/2014/08/l.png);
background-repeat: no-repeat;
background-position: left;
}
.gplus{
background-image: url(./wp-content/uploads/2014/08/g.png);
background-repeat: no-repeat;
background-position: left;
}
.mongodir{
background-image: url(./wp-content/uploads/2014/08/m.png);
background-repeat: no-repeat;
background-position: left;
}
.sitept{
background-image: url(./wp-content/uploads/2014/08/s.png);
background-repeat: no-repeat;
background-position: left;
}
</style>
<img src="./wp-content/uploads/2014/02/030a49b.jpg" alt="Arvind Ravulavaru" style="width: 81px; margin: 0px auto;display: block;border-radius: 45px;"/>
<br/>
<label>
Hello.. I am Arvind Ravulavaru a Full Stack Consultant based out of Hyderabad, India. This blog is my way of giving back to the Javascript Community!</label>
<br/>
<div style="text-align:center;" ><a  href="./portfolio/index.html">Know more about me</a></div>
<br/>
<div  style="text-align:center;">
<a href="https://twitter.com/arvindr21" onclick="__gaTracker('send', 'event', 'outbound-widget', 'https://twitter.com/arvindr21', 'Follow @arvindr21');" class="twitter-follow-button" data-show-count="false">Follow @arvindr21</a>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script> 
<iframe src="http://ghbtns.com/github-btn.html?user=arvindr21&type=follow"
allowtransparency="true" frameborder="0" scrolling="0" width="132" height="20"></iframe><br/><br/>
<a href="http://in.linkedin.com/in/arvindravulavaru" onclick="__gaTracker('send', 'event', 'outbound-widget', 'http://in.linkedin.com/in/arvindravulavaru', 'Linked In');" target="_blank"  class="socl-btn lkdin">Linked In</a>
<a href="https://plus.google.com/+ArvindRavulavaru" onclick="__gaTracker('send', 'event', 'outbound-widget', 'https://plus.google.com/+ArvindRavulavaru', 'Google Plus');" target="_blank"  class="socl-btn gplus">Google Plus</a><br/>
<a href="http://blog.mongodirector.com/author/arvindr" onclick="__gaTracker('send', 'event', 'outbound-widget', 'http://blog.mongodirector.com/author/arvindr', 'Mongo Director');" target="_blank"  class="socl-btn mongodir">Mongo Director</a> <a href="http://www.sitepoint.com/author/aravulavaru/" onclick="__gaTracker('send', 'event', 'outbound-widget', 'http://www.sitepoint.com/author/aravulavaru/', 'Site Point');" target="_blank"  class="socl-btn sitept">Site Point</a> <br/><br/>
<a href="https://paper.li/arvindr21/1409328222#!headlines/" onclick="__gaTracker('send', 'event', 'outbound-widget', 'https://paper.li/arvindr21/1409328222#!headlines/', 'Chronicles of the Jackal of Javascript');" target="_blank"  class="socl-btn">Chronicles of the Jackal of Javascript</a>
</div></div>
</aside><aside id="text-5" class="widget widget_text">			<div class="textwidget"><style>
.crm-app, .crm-ext
{
padding: 9px;
background: #787878;
border-radius: 45px;
color: #EFEFEE !important;
margin-top: 9px;
display: inline-block;
text-align: center;
}
</style>
<a href="https://chrome.google.com/webstore/detail/the-jackal-of-javascript/oiaebkkgbicadojhdipjajkhjkeencdm" onclick="__gaTracker('send', 'event', 'outbound-widget', 'https://chrome.google.com/webstore/detail/the-jackal-of-javascript/oiaebkkgbicadojhdipjajkhjkeencdm', 'Chrome App');" target ="_blank" class="crm-app">Chrome App</a>
<a href="https://chrome.google.com/webstore/detail/the-jackal-of-javascript/dokdjofgoglghfljkpmmkgfpipgcmjme" onclick="__gaTracker('send', 'event', 'outbound-widget', 'https://chrome.google.com/webstore/detail/the-jackal-of-javascript/dokdjofgoglghfljkpmmkgfpipgcmjme', 'Chrome Extension');" target ="_blank" class="crm-ext">Chrome Extension</a></div>
</aside><aside id="text-7" class="widget widget_text"><h1 class="widget-title">Workshops</h1>			<div class="textwidget"><ul>
<li><a href="http://mean-workshop.herokuapp.com/" onclick="__gaTracker('send', 'event', 'outbound-widget', 'http://mean-workshop.herokuapp.com', 'o/ M.E.A.N. Workshop');" target="_blank">\o/ M.E.A.N. Workshop</a>
</li>
</ul></div>
</aside><aside id="text-6" class="widget widget_text"><h1 class="widget-title">Presentations</h1>			<div class="textwidget"><ul>
<li><a href="http://arvindr21.github.io/ng-overview" onclick="__gaTracker('send', 'event', 'outbound-widget', 'http://arvindr21.github.io/ng-overview', 'Overview of Angularjs');" target="_blank">Overview of Angularjs</a>
</li>
<li><a href="http://arvindr21.github.io/howBrowserWorks" onclick="__gaTracker('send', 'event', 'outbound-widget', 'http://arvindr21.github.io/howBrowserWorks', 'How Browser Works');" target="_blank">How Browser Works</a>
</li>
<li><a href="http://arvindr21.github.io/WebComponents" onclick="__gaTracker('send', 'event', 'outbound-widget', 'http://arvindr21.github.io/WebComponents', 'Web Components');" target="_blank">Web Components</a>
</li>
<li><a href="http://arvindr21.github.io/building-n-Scaffolding" onclick="__gaTracker('send', 'event', 'outbound-widget', 'http://arvindr21.github.io/building-n-Scaffolding', 'Modern UI Build Systems and Scaffolding Tools');" target="_blank">Modern UI Build Systems and Scaffolding Tools</a>
</li>
<li><a href="http://arvindr21.github.io/backbonejs" onclick="__gaTracker('send', 'event', 'outbound-widget', 'http://arvindr21.github.io/backbonejs', 'Backbonejs');" target="_blank">Backbonejs</a>
</li>
<li><a href="http://arvindr21.github.io/rwd" onclick="__gaTracker('send', 'event', 'outbound-widget', 'http://arvindr21.github.io/rwd', 'Responsive Web Design');" target="_blank">Responsive Web Design</a>
</li>
</ul></div>
</aside><aside id="text-3" class="widget widget_text"><h1 class="widget-title">Projects</h1>			<div class="textwidget"><ul><li><a href="./rotten-tomatoes-jquery-rest-client/index.html" target="_blank">Rotten Tomatoes jQuery Rest Client</a>
</li>
<li>
<a href="./uploading-files-made-fun/index.html" target="_blank">blueimp-file-upload-expressjs</a> - A Node Package
</li>
<li>
<a href="http://arvindr21.github.io/lazyboy/" onclick="__gaTracker('send', 'event', 'outbound-widget', 'http://arvindr21.github.io/lazyboy/', 'lazyboy');" target="_blank">lazyboy</a> - Command line laziness redefined
</li>
<li>
<a href="http://arvindr21.github.io/diskDB/" onclick="__gaTracker('send', 'event', 'outbound-widget', 'http://arvindr21.github.io/diskDB/', 'diskDB');" target="_blank">diskDB</a> - A Light Weight Disk based JSON Database - A Node Package
</li>
<li>
<a href="https://github.com/search?utf8=%E2%9C%93&q=user%3Aarvindr21+slush&type=Repositories&ref=searchresults" onclick="__gaTracker('send', 'event', 'outbound-widget', 'https://github.com/search?utf8=%E2%9C%93&amp;q=user%3Aarvindr21+slush&amp;type=Repositories&amp;ref=searchresults', 'My Slush Generators');" target="_blank">My Slush Generators</a>
</li>
<li>
<a href="https://github.com/search?utf8=%E2%9C%93&q=user%3Aarvindr21+yeoman&type=Repositories&ref=searchresults" onclick="__gaTracker('send', 'event', 'outbound-widget', 'https://github.com/search?utf8=%E2%9C%93&amp;q=user%3Aarvindr21+yeoman&amp;type=Repositories&amp;ref=searchresults', 'My Yeoman Generators');" target="_blank">My Yeoman Generators</a>
</li>
<li>
<a href="https://github.com/arvindr21/myWebComponents#mywebcomponents" onclick="__gaTracker('send', 'event', 'outbound-widget', 'https://github.com/arvindr21/myWebComponents#mywebcomponents', 'My Web Components');" target="_blank">My Web Components</a>
</li>
<li>
<a href="http://bower.io/search/?q=owner:arvindr21" onclick="__gaTracker('send', 'event', 'outbound-widget', 'http://bower.io/search/?q=owner:arvindr21', 'My Bower Packages');" target="_blank">My Bower Packages</a>
</li>
</ul></div>
</aside><aside id="latestseries-2" class="widget widget_latestseries"><h1 class="widget-title">Series</h1>			<ul>
<div class="latest-series"><ul><li><a href="./series/a-reminder-app/index.html" class="series-145" title="Ionic, Twilio and Node Scheduler – A Reminder App">Ionic, Twilio and Node Scheduler – A Reminder App</a></li><li><a href="./series/node-webkit-apps/index.html" class="series-150" title="Node Webkit Apps">Node Webkit Apps</a></li><li><a href="./series/rpi/index.html" class="series-148" title="Raspberry Pi">Raspberry Pi</a></li></ul></div>			</ul>
</aside><aside id="text-4" class="widget widget_text"><h1 class="widget-title">Guest Posts</h1>			<div class="textwidget"><ul>
<li><a href="http://www.sitepoint.com/building-chat-app-node-webkit-firebase-angularjs/" onclick="__gaTracker('send', 'event', 'outbound-widget', 'http://www.sitepoint.com/building-chat-app-node-webkit-firebase-angularjs/', 'Building a Chat App with node-webkit, Firebase, and AngularJS');" target="_blank">Building a Chat App with node-webkit, Firebase, and AngularJS</a></li>
<li><a href="http://www.sitepoint.com/creating-sentiment-analysis-application-using-node-js/" onclick="__gaTracker('send', 'event', 'outbound-widget', 'http://www.sitepoint.com/creating-sentiment-analysis-application-using-node-js/', 'Creating a Sentiment Analysis Application Using Node.js');" target="_blank">Creating a Sentiment Analysis Application Using Node.js</a></li>
<li><a href="http://blog.mongodirector.com/implementing-pagination-with-mongodb-express-js-slush/" onclick="__gaTracker('send', 'event', 'outbound-widget', 'http://blog.mongodirector.com/implementing-pagination-with-mongodb-express-js-slush/', 'Implementing pagination with MongoDB, Express.js &amp; Slush');" target="_blank">Implementing pagination with MongoDB, Express.js & Slush</a></li>
<li><a href="http://www.sitepoint.com/creating-firebase-powered-end-end-ionic-application/" onclick="__gaTracker('send', 'event', 'outbound-widget', 'http://www.sitepoint.com/creating-firebase-powered-end-end-ionic-application/', 'Creating a Firebase Powered End to End Ionic Application');" target="_blank">Creating a Firebase Powered End to End Ionic Application</a></li>
<li><a href="http://blog.mongodirector.com/getting-started-with-mongodb-and-mongoose/" onclick="__gaTracker('send', 'event', 'outbound-widget', 'http://blog.mongodirector.com/getting-started-with-mongodb-and-mongoose/', 'Getting started with MongoDB and Mongoose');" target="_blank">Getting started with MongoDB and Mongoose</a></li>
<li><a href="http://blog.mongodirector.com/yeoman-mongoose-and-mongodb/" onclick="__gaTracker('send', 'event', 'outbound-widget', 'http://blog.mongodirector.com/yeoman-mongoose-and-mongodb/', 'Yeoman, Mongoose and MongoDB');" target="_blank">Yeoman, Mongoose and MongoDB</a></li>
</ul></div>
</aside><aside id="views-2" class="widget widget_views"><h1 class="widget-title">Top5 Posts</h1><ul>
<li><a href="./index.html"  title="Architecting a Secure RESTful Node.js app">Architecting a Secure RESTful Node.js app</a> - 215,317 views</li><li><a href="./getting-started-with-angular-2-0/index.html"  title="Getting Started with Angular 2.0">Getting Started with Angular 2.0</a> - 177,582 views</li><li><a href="./developing-a-mean-app-with-angular-2-0/index.html"  title="Developing a MEAN app with Angular 2.0">Developing a MEAN app with Angular 2.0</a> - 149,712 views</li><li><a href="./getting-started-with-node-webkit-apps/index.html"  title="Node Webkit &ndash; Build Desktop Apps with Node and Web Technologies">Node Webkit &ndash; Build Desktop Apps with Node and Web Technologies</a> - 93,571 views</li><li><a href="./rpi-live-streaming/index.html"  title="Raspberry Pi, Camera and Node.js &ndash; Live Streaming with Websockets #IoT">Raspberry Pi, Camera and Node.js &ndash; Live Streaming with Websockets #IoT</a> - 91,974 views</li></ul>
</aside>		<aside id="recent-posts-2" class="widget widget_recent_entries">		<h1 class="widget-title">Recent Posts</h1>		<ul>
<li>
<a href="./learning-ionic/index.html">Learning Ionic</a>
</li>
<li>
<a href="./electron-wordpress-angular-material-an-offline-viewer/index.html">Electron, WordPress &#038; Angular Material &#8211; An Offline Viewer</a>
</li>
<li>
<a href="./developing-a-mean-app-with-angular-2-0/index.html">Developing a MEAN app with Angular 2.0</a>
</li>
<li>
<a href="./pushbots-and-cordova/index.html">Pushbots and Cordova &#8211; Easy Push Notifications for your app</a>
</li>
<li>
<a href="./getting-started-with-client-side-storage/index.html">Getting Started with Client Side Storage</a>
</li>
</ul>
</aside><aside id="categories-2" class="widget widget_categories"><h1 class="widget-title">Categories</h1>		<ul>
<li class="cat-item cat-item-141"><a href="./architecture/index.html" >Architecture</a> (8)
</li>
<li class="cat-item cat-item-3"><a href="./css/index.html" >CSS</a> (9)
<ul class='children'>
<li class="cat-item cat-item-5"><a href="./css/css3/index.html" >CSS3</a> (6)
</li>
<li class="cat-item cat-item-26"><a href="./css/less/index.html" >LESS</a> (3)
</li>
<li class="cat-item cat-item-55"><a href="./css/sass/index.html" >SASS</a> (1)
</li>
</ul>
</li>
<li class="cat-item cat-item-117"><a href="./database/index.html" >Database</a> (17)
<ul class='children'>
<li class="cat-item cat-item-136"><a href="./database/disk-db/index.html" >Disk DB</a> (6)
</li>
<li class="cat-item cat-item-131"><a href="./database/firebase/index.html" >Firebase</a> (4)
</li>
<li class="cat-item cat-item-118"><a href="./database/mongodb/index.html" >MongoDB</a> (8)
<ul class='children'>
<li class="cat-item cat-item-119"><a href="./database/mongodb/mongolab/index.html" >MongoLab</a> (3)
</li>
<li class="cat-item cat-item-123"><a href="./database/mongodb/monk/index.html" >Monk</a> (1)
</li>
</ul>
</li>
</ul>
</li>
<li class="cat-item cat-item-125"><a href="./deployments/index.html" >Deployments</a> (4)
<ul class='children'>
<li class="cat-item cat-item-126"><a href="./deployments/heroku/index.html" >Heroku</a> (2)
</li>
</ul>
</li>
<li class="cat-item cat-item-135"><a href="./desktop-apps/index.html" >Desktop Apps</a> (8)
</li>
<li class="cat-item cat-item-155"><a href="./dna-analysis/index.html" >DNA Analysis</a> (1)
</li>
<li class="cat-item cat-item-112"><a href="./es6/index.html" >ECMAScript 6</a> (3)
</li>
<li class="cat-item cat-item-162"><a href="./electron-atom-shell/index.html" >Electron (atom shell)</a> (1)
</li>
<li class="cat-item cat-item-25"><a href="./frameworks/index.html" >Frameworks</a> (42)
<ul class='children'>
<li class="cat-item cat-item-160"><a href="./frameworks/angular-2-0/index.html" >Angular 2.0</a> (2)
</li>
<li class="cat-item cat-item-108"><a href="./frameworks/angularjs/index.html" >Angularjs</a> (21)
</li>
<li class="cat-item cat-item-132"><a href="./frameworks/backbonejs/index.html" >Backbonejs</a> (1)
</li>
<li class="cat-item cat-item-105"><a href="./frameworks/bootstrap/index.html" >Bootstrap</a> (9)
</li>
<li class="cat-item cat-item-159"><a href="./frameworks/emberjs/index.html" >Emberjs</a> (1)
</li>
<li class="cat-item cat-item-56"><a href="./frameworks/foundation/index.html" >Foundation</a> (3)
</li>
<li class="cat-item cat-item-110"><a href="./frameworks/framework7/index.html" >Framework7</a> (1)
</li>
<li class="cat-item cat-item-107"><a href="./frameworks/ionic/index.html" >Ionic</a> (11)
</li>
<li class="cat-item cat-item-157"><a href="./frameworks/lumx/index.html" >Lumx</a> (1)
</li>
<li class="cat-item cat-item-138"><a href="./frameworks/mean/index.html" >MEAN</a> (4)
</li>
<li class="cat-item cat-item-116"><a href="./frameworks/meteorjs/index.html" >Meteorjs</a> (1)
</li>
<li class="cat-item cat-item-122"><a href="./frameworks/onsen-ui/index.html" >Onsen UI</a> (2)
</li>
</ul>
</li>
<li class="cat-item cat-item-101"><a href="./git/index.html" >Git</a> (12)
<ul class='children'>
<li class="cat-item cat-item-102"><a href="./git/github/index.html" >GitHub</a> (10)
</li>
</ul>
</li>
<li class="cat-item cat-item-2"><a href="./html/index.html" >HTML</a> (22)
<ul class='children'>
<li class="cat-item cat-item-4"><a href="./html/html5/index.html" >HTML5</a> (21)
<ul class='children'>
<li class="cat-item cat-item-158"><a href="./html/html5/webrtc/index.html" >WebRTC</a> (1)
</li>
<li class="cat-item cat-item-106"><a href="./html/html5/websockets/index.html" >WebSockets</a> (6)
</li>
</ul>
</li>
</ul>
</li>
<li class="cat-item cat-item-137"><a href="./intels-app-ui/index.html" >Intel&#039;s App UI</a> (1)
</li>
<li class="cat-item cat-item-143"><a href="./iot/index.html" >IoT</a> (6)
</li>
<li class="cat-item cat-item-1"><a href="./javascript/index.html" >Javascript</a> (75)
<ul class='children'>
<li class="cat-item cat-item-6"><a href="./javascript/jquery/index.html" >jQuery</a> (14)
</li>
</ul>
</li>
<li class="cat-item cat-item-151"><a href="./material-design/index.html" >Material Design</a> (3)
</li>
<li class="cat-item cat-item-99"><a href="./mobile/index.html" >Mobile</a> (21)
<ul class='children'>
<li class="cat-item cat-item-103"><a href="./mobile/android/index.html" >Android</a> (15)
</li>
<li class="cat-item cat-item-113"><a href="./mobile/firefox-os/index.html" >Firefox OS</a> (2)
</li>
<li class="cat-item cat-item-104"><a href="./mobile/ios/index.html" >iOS</a> (11)
</li>
<li class="cat-item cat-item-100"><a href="./mobile/phonegap/index.html" >PhoneGap</a> (16)
</li>
</ul>
</li>
<li class="cat-item cat-item-149"><a href="./mqtt/index.html" >MQTT</a> (1)
</li>
<li class="cat-item cat-item-163"><a href="./my-books/index.html" >My Books</a> (1)
</li>
<li class="cat-item cat-item-45"><a href="./node/index.html" >Node</a> (60)
<ul class='children'>
<li class="cat-item cat-item-152"><a href="./node/cli/index.html" >CLI</a> (3)
</li>
<li class="cat-item cat-item-121"><a href="./node/expressjs/index.html" >Expressjs</a> (18)
</li>
<li class="cat-item cat-item-156"><a href="./node/genome/index.html" >Genome</a> (1)
</li>
<li class="cat-item cat-item-62"><a href="./node/grunt/index.html" >Grunt</a> (8)
</li>
<li class="cat-item cat-item-124"><a href="./node/koa/index.html" >Koa</a> (1)
</li>
<li class="cat-item cat-item-134"><a href="./node/node-webkit/index.html" >Node Webkit</a> (7)
</li>
<li class="cat-item cat-item-54"><a href="./node/npm/index.html" >NPM</a> (15)
</li>
<li class="cat-item cat-item-120"><a href="./node/restify/index.html" >Restify</a> (3)
</li>
</ul>
</li>
<li class="cat-item cat-item-161"><a href="./push-notifications/index.html" >Push Notifications</a> (1)
</li>
<li class="cat-item cat-item-59"><a href="./quick-and-dirty/index.html" >Quick and Dirty</a> (42)
</li>
<li class="cat-item cat-item-142"><a href="./raspberry-pi/index.html" >Raspberry Pi</a> (9)
</li>
<li class="cat-item cat-item-60"><a href="./setup/index.html" >Setup</a> (60)
</li>
<li class="cat-item cat-item-61"><a href="./testing/index.html" >Testing</a> (5)
<ul class='children'>
<li class="cat-item cat-item-129"><a href="./testing/jasmine/index.html" >Jasmine</a> (1)
</li>
<li class="cat-item cat-item-128"><a href="./testing/protractor/index.html" >Protractor</a> (1)
</li>
<li class="cat-item cat-item-98"><a href="./testing/test-automation/index.html" >Test Automation</a> (1)
</li>
<li class="cat-item cat-item-41"><a href="./testing/tdd/index.html" >Test Driven Developement</a> (2)
</li>
</ul>
</li>
<li class="cat-item cat-item-139"><a href="./third-party-products/index.html" >Third Party Products</a> (4)
<ul class='children'>
<li class="cat-item cat-item-140"><a href="./third-party-products/twilio/index.html" >Twilio</a> (4)
</li>
</ul>
</li>
<li class="cat-item cat-item-58"><a href="./tutorial/index.html" >Tutorial</a> (79)
</li>
<li class="cat-item cat-item-130"><a href="./performance-analysis/index.html" >UI Performance</a> (1)
</li>
<li class="cat-item cat-item-109"><a href="./web-components/index.html" >Web Components</a> (3)
</li>
<li class="cat-item cat-item-133"><a href="./google-web-starter-kit/index.html" >Web Starter Kit</a> (1)
</li>
</ul>
</aside><aside id="archives-2" class="widget widget_archive"><h1 class="widget-title">Archives</h1>		<ul>
<li><a href='./2015/07/index.html'>July 2015</a></li>
<li><a href='./2015/05/index.html'>May 2015</a></li>
<li><a href='./2015/04/index.html'>April 2015</a></li>
<li><a href='./2015/03/index.html'>March 2015</a></li>
<li><a href='./2015/02/index.html'>February 2015</a></li>
<li><a href='./2015/01/index.html'>January 2015</a></li>
<li><a href='./2014/12/index.html'>December 2014</a></li>
<li><a href='./2014/11/index.html'>November 2014</a></li>
<li><a href='./2014/10/index.html'>October 2014</a></li>
<li><a href='./2014/09/index.html'>September 2014</a></li>
<li><a href='./2014/08/index.html'>August 2014</a></li>
<li><a href='./2014/07/index.html'>July 2014</a></li>
<li><a href='./2014/06/index.html'>June 2014</a></li>
<li><a href='./2014/05/index.html'>May 2014</a></li>
<li><a href='./2014/04/index.html'>April 2014</a></li>
<li><a href='./2014/03/index.html'>March 2014</a></li>
<li><a href='./2014/02/index.html'>February 2014</a></li>
</ul>
</aside><aside id="wysija-3" class="widget widget_wysija"><h1 class="widget-title">Inform me about new posts</h1><div class="widget_wysija_cont"><div id="msg-form-wysija-3" class="wysija-msg ajax"></div><form id="form-wysija-3" method="post" action="#wysija" class="widget_wysija">
<p class="wysija-paragraph">
<label>Email <span class="wysija-required">*</span></label>
<input type="text" name="wysija[user][email]" class="wysija-input validate[required,custom[email]]" title="Email"  value="" />
<span class="abs-req">
<input type="text" name="wysija[user][abs][email]" class="wysija-input validated[abs][email]" value="" />
</span>
</p>
<input class="wysija-submit wysija-submit-field" type="submit" value="Subscribe!" />
<input type="hidden" name="form_id" value="1" />
<input type="hidden" name="action" value="save" />
<input type="hidden" name="controller" value="subscribers" />
<input type="hidden" value="1" name="wysija-page" />
<input type="hidden" name="wysija[user_list][list_ids]" value="3" />
</form></div></aside>	</div><!-- #secondary -->
	<script>
var _prum = [['id', '544090ababe53d0e3e76d6ce'],
['mark', 'firstbyte', (new Date()).getTime()]];
(function() {
var s = document.getElementsByTagName('script')[0]
, p = document.createElement('script');
p.async = 'async';
p.src = '//rum-static.pingdom.net/prum.min.js';
s.parentNode.insertBefore(p, s);
})();
</script>
</div><!-- #content -->
<footer id="colophon" class="site-footer" role="contentinfo">
<div class="site-info">
All Rights Reserved
<span class="sep"> | </span>
The Jackal of Javascript
</div><!-- .site-info -->
<div class="rnd-circle" style="background: black;width: 10px;height: 10px;border-radius: 50%;"></div>
</footer><!-- #colophon -->
</div><!-- #page -->
<script type='text/javascript'><!--
var seriesdropdown = document.getElementById("orgseries_dropdown");
if (seriesdropdown) {
function onSeriesChange() {
if ( seriesdropdown.options[seriesdropdown.selectedIndex].value != ( 0 || -1 ) ) {
location.href = "./series/"+seriesdropdown.options[seriesdropdown.selectedIndex].value;
}
}
seriesdropdown.onchange = onSeriesChange;
}
--></script>
<script type="text/javascript">
// <![CDATA[
var disqus_shortname = 'thejackalofjavascriptcom';
(function () {
var nodes = document.getElementsByTagName('span');
for (var i = 0, url; i < nodes.length; i++) {
if (nodes[i].className.indexOf('dsq-postid') != -1) {
nodes[i].parentNode.setAttribute('data-disqus-identifier', nodes[i].getAttribute('data-dsqidentifier'));
url = nodes[i].parentNode.href.split('#', 1);
if (url.length == 1) { url = url[0]; }
else { url = url[1]; }
nodes[i].parentNode.href = url + '#disqus_thread';
}
}
var s = document.createElement('script'); 
s.async = true;
s.type = 'text/javascript';
s.src = '//' + disqus_shortname + '.disqus.com/count.js';
(document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
}());
// ]]>
</script>
<div class="scroll-back-to-top-wrapper">
<span class="scroll-back-to-top-inner">
<i class="fa fa-2x fa-arrow-circle-up"></i>
</span>
</div>
<style type="text/css">
#wpfront-notification-bar 
{
background: #242d36;
background: -moz-linear-gradient(top, #242d36 0%, #242d36 100%);
background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,#242d36), color-stop(100%,#242d36));
background: -webkit-linear-gradient(top, #242d36 0%,#242d36 100%);
background: -o-linear-gradient(top, #242d36 0%,#242d36 100%);
background: -ms-linear-gradient(top, #242d36 0%,#242d36 100%);
background: linear-gradient(to bottom, #242d36 0%, #242d36 100%);
filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#242d36', endColorstr='#242d36',GradientType=0 );
}
#wpfront-notification-bar div.wpfront-message
{
color: #ffffff;
}
#wpfront-notification-bar a.wpfront-button
{
background: #f45145;
background: -moz-linear-gradient(top, #f45145 0%, #f45145 100%);
background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,#f45145), color-stop(100%,#f45145));
background: -webkit-linear-gradient(top, #f45145 0%,#f45145 100%);
background: -o-linear-gradient(top, #f45145 0%,#f45145 100%);
background: -ms-linear-gradient(top, #f45145 0%,#f45145 100%);
background: linear-gradient(to bottom, #f45145 0%, #f45145 100%);
filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#f45145', endColorstr='#f45145',GradientType=0 );
color: #ffffff;
}
#wpfront-notification-bar-open-button
{
background-color: #00b7ea;
}
#wpfront-notification-bar  div.wpfront-close 
{
border: 1px solid #555555;
background-color: #555555;
color: #000000;
}
#wpfront-notification-bar  div.wpfront-close:hover 
{
border: 1px solid #aaaaaa;
background-color: #aaaaaa;
}
</style>
<div id="wpfront-notification-bar-spacer"  style="display: none;">
<div id="wpfront-notification-bar-open-button" class="top wpfront-bottom-shadow"></div>
<div id="wpfront-notification-bar" class="wpfront-fixed">
<div class="wpfront-close">X</div>
<table border="0" cellspacing="0" cellpadding="0">
<tr>
<td>
<div class="wpfront-message">
Learn your way around Ionic framework. Check out Learning Ionic!                     </div>
<div>
<a class="wpfront-button" href="https://www.packtpub.com/application-development/learning-ionic/?utm_source=Jkthejackalofjavascript&utm_medium=referral&utm_campaign=1783552603"  target="_blank" >Buy</a>
</div>
</td>
</tr>
</table>
</div>
</div>
<style type="text/css">
.wpfront-message{line-height:27px; vertical-align:baseline !important;}</style>
<script type="text/javascript">if(typeof wpfront_notification_bar == "function") wpfront_notification_bar({"position":1,"height":0,"fixed_position":"on","animate_delay":0.5,"close_button":true,"button_action_close_bar":false,"auto_close_after":0,"display_after":1,"is_admin_bar_showing":false,"display_open_button":false,"keep_closed":"on","keep_closed_for":1,"position_offset":0,"display_scroll":"on","display_scroll_offset":100});</script><script type='text/javascript' src='./wp-content/plugins/jetpack/modules/photon/photon.js'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var scrollBackToTop = {"scrollDuration":"500","fadeDuration":"0.5"};
/* ]]> */
</script>
<script type='text/javascript' src='./wp-content/plugins/scroll-back-to-top/assets/js/scroll-back-to-top.js'></script>
<script type='text/javascript' src='./wp-content/plugins/simple-share-buttons-adder/js/ssba.min.js'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var viewsCacheL10n = {"admin_ajax_url":".\/wp-admin\/admin-ajax.php","post_id":"2043"};
/* ]]> */
</script>
<script type='text/javascript' src='./wp-content/plugins/wp-postviews/postviews-cache.js'></script>
<script type='text/javascript' src='http://s0.wp.com/wp-content/js/devicepx-jetpack.js'></script>
<script type='text/javascript' src='./wp-content/themes/sorbet/js/menus.js'></script>
<script type='text/javascript' src='./wp-content/themes/sorbet/js/skip-link-focus-fix.js'></script>
<script type='text/javascript' src='./wp-includes/js/comment-reply.min.js'></script>
<script type='text/javascript' src='./wp-content/plugins/lazy-load/js/jquery.sonar.min.js'></script>
<script type='text/javascript' src='./wp-content/plugins/lazy-load/js/lazy-load.js'></script>
<script type='text/javascript' src='./wp-content/plugins/jetpack/_inc/postmessage.js'></script>
<script type='text/javascript' src='./wp-content/plugins/jetpack/_inc/jquery.jetpack-resize.js'></script>
<script type='text/javascript' src='./wp-content/plugins/jetpack/_inc/jquery.inview.js'></script>
<script type='text/javascript' src='./wp-content/plugins/jetpack/modules/likes/queuehandler.js'></script>
<script type='text/javascript' src='./wp-content/plugins/wysija-newsletters/js/validate/languages/jquery.validationEngine-en.js'></script>
<script type='text/javascript' src='./wp-content/plugins/wysija-newsletters/js/validate/jquery.validationEngine.js'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wysijaAJAX = {"action":"wysija_ajax","controller":"subscribers","ajaxurl":".\/wp-admin\/admin-ajax.php","loadingTrans":"Loading...","is_rtl":""};
var wysijaAJAX = {"action":"wysija_ajax","controller":"subscribers","ajaxurl":".\/wp-admin\/admin-ajax.php","loadingTrans":"Loading...","is_rtl":""};
/* ]]> */
</script>
<script type='text/javascript' src='./wp-content/plugins/wysija-newsletters/js/front-subscribers.js'></script>
<iframe src='http://widgets.wp.com/likes/master.html?ver=20141028#ver=20141028' scrolling='no' id='likes-master' name='likes-master' style='display:none;'></iframe>
<div id='likes-other-gravatars'><div class="likes-text"><span>%d</span> bloggers like this:</div><ul class="wpl-avatars sd-like-gravatars"></ul></div>
<script type="text/javascript">
jQuery.noConflict();
(function( $ ) {
$(function() {
// More code using $ as alias to jQuery
$("area[href*=#],a[href*=#]:not([href=#]):not([href^='#tab']):not([href^='#quicktab']):not([href^='#pane'])").click(function() {
if (location.pathname.replace(/^\//,'') == this.pathname.replace(/^\//,'') && location.hostname == this.hostname) {
var target = $(this.hash);
target = target.length ? target : $('[name=' + this.hash.slice(1) +']');
if (target.length) {
$('html,body').animate({
scrollTop: target.offset().top - 20  
},900 ,'easeOutQuint');
return false;
}
}
});
});
})(jQuery);	
</script>				
<script type='text/javascript' src='http://stats.wp.com/e-201746.js' async defer></script>
<script type='text/javascript'>
_stq = window._stq || [];
_stq.push([ 'view', {v:'ext',j:'1:3.7',blog:'70838519',post:'2043',tz:'5.5',srv:'thejackalofjavascript.com'} ]);
_stq.push([ 'clickTrackerInit', '70838519', '2043' ]);
</script>
<div id="upprev_box"><h6>Read previous post:</h6><div class="upprev_excerpt"><h5><a href="./maintaining-a-private-npm-registry/index.html" rel="Architecting a Secure RESTful Node.js app">Maintaining a Private NPM registry for your Organization with Sinopia</a></h5><p>Maintaining a Private NPM registry with Sinopia In this post, we will take a quick dig at setting up our...</p></div><a id="upprev_close" href="#" rel="close">Close</a></div><script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-47881846-1', 'auto');
ga('send', 'pageview');
</script>
<a style="display:none;" href="http://www.alexa.com/siteinfo/./"><script type="text/javascript" src="http://xslt.alexa.com/site_stats/js/t/a?url=./"></script></a>
</body>
</html><script>if(document.getElementById('to-contents') == null){ } else {var a = document.getElementById('to-contents').getElementsByTagName('a'); for(var i=0; i< a.length;i++){var b = a[i].getAttribute('href').split('#');if(b.length >=2)a[i].setAttribute('href', '#'+b[1]);}}</script>
<script>if(typeof jQuery == 'function'){jQuery('.widgetGuts.shortcode h3').html('Inform Me About New Posts')}</script><!-- WP Fastest Cache file was created in 6.06580281258 seconds, on 18-11-17 14:11:48 -->