<!DOCTYPE html>
<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="alexaVerifyID" content="tHZTfJpU56tqERN4vjth74jHqBM"/>
<link rel="profile" href="http://gmpg.org/xfn/11">
<link rel="pingback" href="./../../xmlrpc.php">
<link href='http://fonts.googleapis.com/css?family=Exo+2' rel='stylesheet' type='text/css'>
<link rel="shortcut icon" href="./../../wp-content/uploads/2014/02/favicon.ico" type="image/x-icon">
<meta name="keywords" content="Javascript, HTML5, CSS3, ES6, Ecmascript, Hybrid Apps, Mobile Web Development, Desktop Apps, Apps, Arvind R, Arvind Ravulavaru, The Jackal of Javascript">
<link rel="icon" href="./../../wp-content/uploads/2014/02/favicon.ico" type="image/x-icon">
<link href='http://fonts.googleapis.com/css?family=Open+Sans:400italic,400,600' rel='stylesheet' type='text/css'>
<!-- Performance scores of this site is tuned by WP Performance Score Booster plugin v1.5 - http://wordpress.org/plugins/wp-performance-score-booster -->
<!-- Jetpack Site Verification Tags -->
<meta name="google-site-verification" content="1QBi99oBZzn4xisTyRUgPd4BXjQ-6Tu09iK6V_bviIY" />
<meta name="msvalidate.01" content="33E048D3C4E943B6450230EA909E12C6" />
<meta name="p:domain_verify" content="662a829c1b5ccc13015f1cc5d00ec7e4" />

<!-- This site is optimized with the Yoast SEO plugin v3.1 - https://yoast.com/wordpress/plugins/seo/ -->
<title>Re-Architecting a Firebase app to work with Node.js and MongoDB | The Jackal of Javascript</title>
<meta name="description" content="In the last few days, I have see people worrying about two major problems. One of which is what is going to happen when Angular 2.0 releases and next one i"/>
<meta name="robots" content="noodp"/>
<link rel="canonical" href="./../index.html" />
<link rel="publisher" href="https://plus.google.com/ArvindRavulavaru"/>
<meta property="og:locale" content="en_US" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Re-Architecting a Firebase app to work with Node.js and MongoDB | The Jackal of Javascript" />
<meta property="og:description" content="In the last few days, I have see people worrying about two major problems. One of which is what is going to happen when Angular 2.0 releases and next one i" />
<meta property="og:url" content="./re-architecting-a-firebase-app-in-node/" />
<meta property="og:site_name" content="The Jackal of Javascript" />
<meta property="article:publisher" content="https://www.facebook.com/arvindravulavaru" />
<meta property="article:section" content="Architecture" />
<meta property="article:published_time" content="2014-12-12T22:40:09+05:30" />
<meta property="article:modified_time" content="2014-12-16T00:59:08+05:30" />
<meta property="og:updated_time" content="2014-12-16T00:59:08+05:30" />
<meta property="og:image" content="./wp-content/uploads/2014/12/fb_rearch-451x300.png" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:description" content="In the last few days, I have see people worrying about two major problems. One of which is what is going to happen when Angular 2.0 releases and next one i" />
<meta name="twitter:title" content="Re-Architecting a Firebase app to work with Node.js and MongoDB | The Jackal of Javascript" />
<meta name="twitter:site" content="@arvindr21" />
<meta name="twitter:image" content="./wp-content/uploads/2014/12/fb_rearch-451x300.png" />
<meta name="twitter:creator" content="@arvindr21" />
<!-- / Yoast SEO plugin. -->

		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"http:\/\/s.w.org\/images\/core\/emoji\/72x72\/","ext":".png","source":{"concatemoji":".\/wp-includes\/js\/wp-emoji-release.min.js"}};
			!function(a,b,c){function d(a){var c=b.createElement("canvas"),d=c.getContext&&c.getContext("2d");return d&&d.fillText?(d.textBaseline="top",d.font="600 32px Arial","flag"===a?(d.fillText(String.fromCharCode(55356,56812,55356,56807),0,0),c.toDataURL().length>3e3):(d.fillText(String.fromCharCode(55357,56835),0,0),0!==d.getImageData(16,16,1,1).data[0])):!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g;c.supports={simple:d("simple"),flag:d("flag")},c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.simple&&c.supports.flag||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel='stylesheet' id='savrix-style.css-css'  href='./../../wp-content/plugins/savrix-android-market/savrix-style-only-play.css' type='text/css' media='all' />
<link rel='stylesheet' id='validate-engine-css-css'  href='./../../wp-content/plugins/wysija-newsletters/css/validationEngine.jquery.css' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-css'  href='./../../wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-theme-arduino-ide-css'  href='./../../wp-content/plugins/crayon-syntax-highlighter/themes/arduino-ide/arduino-ide.css' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-font-droid-sans-mono-css'  href='./../../wp-content/plugins/crayon-syntax-highlighter/fonts/droid-sans-mono.css' type='text/css' media='all' />
<link rel='stylesheet' id='orgseries-default-css-css'  href='./../../wp-content/plugins/organize-series/orgSeries.css' type='text/css' media='all' />
<link rel='stylesheet' id='responsive-lightbox-prettyphoto-css'  href='./../../wp-content/plugins/responsive-lightbox/assets/prettyphoto/css/prettyPhoto.css' type='text/css' media='all' />
<link rel='stylesheet' id='font-awesome-css'  href='//netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.css' type='text/css' media='screen' />
<link rel='stylesheet' id='ssbaFont-css'  href='//fonts.googleapis.com/css?family=Indie+Flower&#038;ver=4.2.16' type='text/css' media='all' />
<link rel='stylesheet' id='wpfront-notification-bar-css'  href='./../../wp-content/plugins/wpfront-notification-bar/css/wpfront-notification-bar.css' type='text/css' media='all' />
<link rel='stylesheet' id='sorbet-style-css'  href='./../../wp-content/themes/sorbet/style.css' type='text/css' media='all' />
<link rel='stylesheet' id='sorbet-source-sans-pro-css'  href='http://fonts.googleapis.com/css?family=Source+Sans+Pro%3A300%2C400%2C700%2C300italic%2C400italic%2C700italic&#038;subset=latin%2Clatin-ext&#038;ver=4.2.16' type='text/css' media='all' />
<link rel='stylesheet' id='sorbet-pt-serif-css'  href='http://fonts.googleapis.com/css?family=PT+Serif%3A400%2C700%2C400italic%2C700italic&#038;subset=latin%2Clatin-ext&#038;ver=4.2.16' type='text/css' media='all' />
<link rel='stylesheet' id='sorbet-genericons-css'  href='./../../wp-content/themes/sorbet/genericons/genericons.css' type='text/css' media='all' />
<link rel='stylesheet' id='easy_table_style-css'  href='./../../wp-content/plugins/easy-table/themes/default/style.css' type='text/css' media='all' />
<link rel='stylesheet' id='upprev-css-css'  href='./../../wp-content/plugins/upprev/styles/upprev.css' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack_css-css'  href='./../../wp-content/plugins/jetpack/css/jetpack.css' type='text/css' media='all' />
<!-- This site uses the Google Analytics by Yoast plugin v5.4.6 - Universal enabled - https://yoast.com/wordpress/plugins/google-analytics/ -->
<script type="text/javascript">
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
		(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
		m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','//www.google-analytics.com/analytics.js','__gaTracker');

	__gaTracker('create', 'UA-47881846-1', 'auto');
	__gaTracker('set', 'forceSSL', true);
	__gaTracker('require', 'displayfeatures');
	__gaTracker('send','pageview');

</script>
<!-- / Google Analytics by Yoast -->
<script type="text/javascript">
var iworks_upprev = { animation: 'flyout', position: 'right', offset_percent: 75, offset_element: '#comments', css_width: 360, css_side: 5, compare: 'simple', url_new_window: 0, ga_track_views: 1, ga_track_clicks: 1, ga_opt_noninteraction: 1, title: 'Re-Architecting a Firebase app to work with Node.js and MongoDB' };
</script>
<script type='text/javascript' src='./../../wp-includes/js/jquery/jquery.js'></script>
<script type='text/javascript' src='./../../wp-includes/js/jquery/jquery-migrate.min.js'></script>
<script type='text/javascript' src='./../../wp-content/plugins/jetpack/modules/related-posts/related-posts.js'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":".\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type='text/javascript' src='./../../wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js'></script>
<script type='text/javascript' src='./../../wp-content/plugins/responsive-lightbox/assets/prettyphoto/js/jquery.prettyPhoto.js'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var rlArgs = {"script":"prettyphoto","selector":"lightbox","customEvents":"","activeGalleries":"1","animationSpeed":"normal","slideshow":"0","slideshowDelay":"5000","slideshowAutoplay":"0","opacity":"0.75","showTitle":"1","allowResize":"1","allowExpand":"1","width":"1080","height":"720","separator":"\/","theme":"pp_default","horizontalPadding":"20","hideFlash":"0","wmode":"opaque","videoAutoplay":"0","modal":"0","deeplinking":"0","overlayGallery":"1","keyboardShortcuts":"1","social":"0"};
/* ]]> */
</script>
<script type='text/javascript' src='./../../wp-content/plugins/responsive-lightbox/js/front.js'></script>
<script type='text/javascript' src='./../../wp-content/plugins/wpfront-notification-bar/jquery-plugins/jquery.c.js'></script>
<script type='text/javascript' src='./../../wp-content/plugins/wpfront-notification-bar/js/wpfront-notification-bar.js'></script>
<script type='text/javascript' src='./../../wp-content/plugins/upprev/scripts/upprev.js'></script>
<script type='text/javascript' src='//cdnjs.cloudflare.com/ajax/libs/jquery-easing/1.3/jquery.easing.min.js'></script>
<meta name="generator" content="WordPress 4.2.16" />

<style>
.scroll-back-to-top-wrapper {
    position: fixed;
	opacity: 0;
	visibility: hidden;
	overflow: hidden;
	text-align: center;
	z-index: 99999999;
    background-color: #777777;
	color: #eeeeee;
	width: 50px;
	height: 48px;
	line-height: 48px;
	right: 30px;
	bottom: 30px;
	padding-top: 2px;
	border-top-left-radius: 10px;
	border-top-right-radius: 10px;
	border-bottom-right-radius: 10px;
	border-bottom-left-radius: 10px;
	-webkit-transition: all 0.5s ease-in-out;
	-moz-transition: all 0.5s ease-in-out;
	-ms-transition: all 0.5s ease-in-out;
	-o-transition: all 0.5s ease-in-out;
	transition: all 0.5s ease-in-out;
}
.scroll-back-to-top-wrapper:hover {
	background-color: #888888;
  color: #eeeeee;
}
.scroll-back-to-top-wrapper.show {
    visibility:visible;
    cursor:pointer;
	opacity: 1.0;
}
.scroll-back-to-top-wrapper i.fa {
	line-height: inherit;
}
.scroll-back-to-top-wrapper .fa-lg {
	vertical-align: 0;
}
</style><style type="text/css">	.ssba {
									
									
									
									
								}
								.ssba img
								{
									width: 35px !important;
									padding: 6px;
									border:  0;
									box-shadow: none !important;
									display: inline !important;
									vertical-align: middle;
								}
								.ssba, .ssba a
								{
									text-decoration:none;
									border:0;
									background: none;
									font-family: Indie Flower;
									font-size: 	20px;
									
									
								}.ssba_sharecount:after, .ssba_sharecount:before {
									right: 100%;
									border: solid transparent;
									content: " ";
									height: 0;
									width: 0;
									position: absolute;
									pointer-events: none;
								}
								.ssba_sharecount:after {
									border-color: rgba(224, 221, 221, 0);
									border-right-color: #f5f5f5;
									border-width: 5px;
									top: 50%;
									margin-top: -5px;
								}
								.ssba_sharecount:before {
									border-color: rgba(85, 94, 88, 0);
									border-right-color: #e0dddd;
									border-width: 6px;
									top: 50%;
									margin-top: -6px;
								}
								.ssba_sharecount {
									font: 11px Arial, Helvetica, sans-serif;

									padding: 5px;
									-khtml-border-radius: 6px;
									-o-border-radius: 6px;
									-webkit-border-radius: 6px;
									-moz-border-radius: 6px;
									border-radius: 6px;
									position: relative;
									border: 1px solid #e0dddd;color: #555e58;
										background: #ffffff;
									}
									.ssba_sharecount:after {
										border-right-color: #ffffff;
									}</style><style id="popup-maker-themes"  type="text/css">/* Popup Theme 2995: Default Theme */
.popmake-overlay.theme-2995, .popmake-overlay.theme-default-theme { background-color: rgba( 255, 255, 255, 1 ) } 
.popmake.theme-2995, .popmake.theme-default-theme { padding: 18px; border-radius: 0px; border: 1px none #000000; box-shadow: 1px 1px 3px 0px rgba( 2, 2, 2, 0.23 ); background-color: rgba( 249, 249, 249, 1 ) } 
.popmake.theme-2995 .popmake-title, .popmake.theme-default-theme .popmake-title { color: #000000; text-align: left; text-shadow: 0px 0px 0px rgba( 2, 2, 2, 0.23 ); font-family: inherit; font-weight: inherit; font-size: 32px; font-style: normal; line-height: 36px } 
.popmake.theme-2995 .popmake-content, .popmake.theme-default-theme .popmake-content { color: #8c8c8c; font-family: inherit; font-weight: inherit; font-style: normal } 
.popmake.theme-2995 > .popmake-close, .popmake.theme-default-theme > .popmake-close { height: 20px; width: 20px; left: auto; right: 0px; bottom: auto; top: 0px; padding: 8px; color: #ffffff; font-family: inherit; font-weight: inherit; font-size: 12px; font-style: normal; line-height: 14px; border: 1px none #ffffff; border-radius: 0px; box-shadow: 0px 0px 0px 0px rgba( 2, 2, 2, 0.23 ); text-shadow: 0px 0px 0px rgba( 0, 0, 0, 0.23 ); background-color: rgba( 0, 183, 205, 1 ) } 
</style>
<link rel='dns-prefetch' href='//i0.wp.com'>
<link rel='dns-prefetch' href='//i1.wp.com'>
<link rel='dns-prefetch' href='//i2.wp.com'>
<link rel='dns-prefetch' href='//widgets.wp.com'>
<link rel='dns-prefetch' href='//s0.wp.com'>
<link rel='dns-prefetch' href='//0.gravatar.com'>
<link rel='dns-prefetch' href='//1.gravatar.com'>
<link rel='dns-prefetch' href='//2.gravatar.com'>
<style type="text/css">
#upprev_box{bottom:5px;width:360px;right:5px;display:block;right:-415px;display:block;}
 </style>
</head>

<body class="single single-post postid-2567 single-format-standard right-sidebar">
<div id="page" class="hfeed site">
		<header id="masthead" class="site-header" role="banner">
				<div class="site-header-wrapper">
			<div class="site-branding">
				<h1 class="site-title"><a href="./../../index.html" rel="home">The Jackal of Javascript</a></h1>
				<h2 class="site-description">Knowing is different &amp; Doing is different</h2>
			</div>

			<div class="toggles">
				<div id="menu-toggle" class="toggle active" title="Menu"><span class="screen-reader-text">Menu</span></div>
												<div id="search-toggle" class="toggle" title="Search"><span class="screen-reader-text">Search</span></div>
			</div>
		</div>
	</header><!-- #masthead -->
	<div id="menu-toggle-nav" class="panel">
		<nav id="site-navigation" class="main-navigation" role="navigation">
			<a class="skip-link screen-reader-text" href="#content">Skip to content</a>

			<div class="menu-main-container"><ul id="menu-main" class="menu"><li id="menu-item-2579" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-2579"><a href="./../../index.html">Home</a></li>
<li id="menu-item-2595" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-2595"><a href="./../../portfolio/index.html">About  me</a></li>
<li id="menu-item-2580" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2580"><a href="./../../history-of-the-web/index.html">History of the Web</a></li>
<li id="menu-item-2726" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2726"><a href="./../../javascript-101/index.html">Javascript 101</a></li>
<li id="menu-item-2581" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2581"><a href="./../../contact-request/index.html">Request</a></li>
</ul></div>		</nav><!-- #site-navigation -->
	</div>
			<div id="search-toggle-nav" class="panel">
		<div class="search-wrapper">
			<form role="search" method="get" class="search-form" action="./../../index.html">
	<label>
		<span class="screen-reader-text">Search for:</span>
		<input type="search" class="search-field" placeholder="Search &hellip;" value="" name="s">
	</label>
	<input type="submit" class="search-submit" value="Search">
</form>
		</div>
	</div>
	<div id="content" class="site-content">
	<div id="primary" class="content-area">
		<main id="main" class="site-main" role="main">

											
			
<article id="post-2567" class="post-2567 post type-post status-publish format-standard hentry category-architecture category-database category-expressjs category-firebase category-html5 category-javascript category-mongodb category-mongolab category-node category-setup category-tutorial category-websockets">
	<header class="entry-header">
				<h1 class="entry-title">Re-Architecting a Firebase app to work with Node.js and MongoDB</h1>	</header><!-- .entry-header -->

	<div class="entry-content">
		<!-- Simple Share Buttons Adder (6.1.5) simplesharebuttons.com --><div class="ssba ssba-wrap"><div style="text-align:left"><a href="http://twitter.com/share?url=./re-architecting-a-firebase-app-in-node/&amp;text=Re-Architecting+a+Firebase+app+to+work+with+Node.js+and+MongoDB+From+The+Jackal+of+Javascript+by+%40arvindr21" onclick="__gaTracker('send', 'event', 'outbound-article', 'http://twitter.com/share?url=./re-architecting-a-firebase-app-in-node/&amp;text=Re-Architecting+a+Firebase+app+to+work+with+Node.js+and+MongoDB+From+The+Jackal+of+Javascript+by+%40arvindr21', '');" data-site="" class="ssba_twitter_share"   target="_blank"  rel="nofollow"><img src="http://i0.wp.com/thejackalofjavascript.com/wp-content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="http://i2.wp.com/thejackalofjavascript.com/wp-content/plugins/simple-share-buttons-adder/buttons/somacro/twitter.png?w=646" title="Twitter" class="ssba ssba-img" alt="Tweet about this on Twitter" data-recalc-dims="1" /><noscript><img src="http://i2.wp.com/thejackalofjavascript.com/wp-content/plugins/simple-share-buttons-adder/buttons/somacro/twitter.png?w=646" title="Twitter" class="ssba ssba-img" alt="Tweet about this on Twitter" data-recalc-dims="1" /></noscript></a><a href="http://www.linkedin.com/shareArticle?mini=true&amp;url=./re-architecting-a-firebase-app-in-node/" onclick="__gaTracker('send', 'event', 'outbound-article', 'http://www.linkedin.com/shareArticle?mini=true&amp;url=./re-architecting-a-firebase-app-in-node/', '');" data-site="linkedin" class="ssba_linkedin_share ssba_share_link"   target="_blank"  rel="nofollow"><img src="http://i0.wp.com/thejackalofjavascript.com/wp-content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="http://i1.wp.com/thejackalofjavascript.com/wp-content/plugins/simple-share-buttons-adder/buttons/somacro/linkedin.png?w=646" title="LinkedIn" class="ssba ssba-img" alt="Share on LinkedIn" data-recalc-dims="1" /><noscript><img src="http://i1.wp.com/thejackalofjavascript.com/wp-content/plugins/simple-share-buttons-adder/buttons/somacro/linkedin.png?w=646" title="LinkedIn" class="ssba ssba-img" alt="Share on LinkedIn" data-recalc-dims="1" /></noscript></a><span class="ssba_sharecount">10</span><a href="https://plus.google.com/share?url=./re-architecting-a-firebase-app-in-node/" onclick="__gaTracker('send', 'event', 'outbound-article', 'https://plus.google.com/share?url=./re-architecting-a-firebase-app-in-node/', '');" data-site="" class="ssba_google_share"   target="_blank"  rel="nofollow"><img src="http://i0.wp.com/thejackalofjavascript.com/wp-content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="http://i2.wp.com/thejackalofjavascript.com/wp-content/plugins/simple-share-buttons-adder/buttons/somacro/google.png?w=646" title="Google+" class="ssba ssba-img" alt="Share on Google+" data-recalc-dims="1" /><noscript><img src="http://i2.wp.com/thejackalofjavascript.com/wp-content/plugins/simple-share-buttons-adder/buttons/somacro/google.png?w=646" title="Google+" class="ssba ssba-img" alt="Share on Google+" data-recalc-dims="1" /></noscript></a><span class="ssba_sharecount">0</span><a href="http://reddit.com/submit?url=./re-architecting-a-firebase-app-in-node/&amp;title=Re-Architecting a Firebase app to work with Node.js and MongoDB" onclick="__gaTracker('send', 'event', 'outbound-article', 'http://reddit.com/submit?url=./re-architecting-a-firebase-app-in-node/&amp;title=Re-Architecting a Firebase app to work with Node.js and MongoDB', '');" data-site="reddit" class="ssba_reddit_share"   target="_blank"  rel="nofollow"><img src="http://i0.wp.com/thejackalofjavascript.com/wp-content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="http://i0.wp.com/thejackalofjavascript.com/wp-content/plugins/simple-share-buttons-adder/buttons/somacro/reddit.png?w=646" title="Reddit" class="ssba ssba-img" alt="Share on Reddit" data-recalc-dims="1" /><noscript><img src="http://i0.wp.com/thejackalofjavascript.com/wp-content/plugins/simple-share-buttons-adder/buttons/somacro/reddit.png?w=646" title="Reddit" class="ssba ssba-img" alt="Share on Reddit" data-recalc-dims="1" /></noscript></a><span class="ssba_sharecount">0</span><a href="https://bufferapp.com/add?url=./re-architecting-a-firebase-app-in-node/&amp;text=From The Jackal of Javascript Re-Architecting a Firebase app to work with Node.js and MongoDB" onclick="__gaTracker('send', 'event', 'outbound-article', 'https://bufferapp.com/add?url=./re-architecting-a-firebase-app-in-node/&amp;text=From The Jackal of Javascript Re-Architecting a Firebase app to work with Node.js and MongoDB', '');" data-site="buffer" class="ssba_buffer_share"   target="_blank"  rel="nofollow"><img src="http://i0.wp.com/thejackalofjavascript.com/wp-content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="http://i1.wp.com/thejackalofjavascript.com/wp-content/plugins/simple-share-buttons-adder/buttons/somacro/buffer.png?w=646" title="Buffer" class="ssba ssba-img" alt="Buffer this page" data-recalc-dims="1" /><noscript><img src="http://i1.wp.com/thejackalofjavascript.com/wp-content/plugins/simple-share-buttons-adder/buttons/somacro/buffer.png?w=646" title="Buffer" class="ssba ssba-img" alt="Buffer this page" data-recalc-dims="1" /></noscript></a><a href="https://flattr.com/submit/auto?user_id=arvindr21&amp;title=Re-Architecting a Firebase app to work with Node.js and MongoDB&amp;url=https://flattr.com/profile/arvindr21" onclick="__gaTracker('send', 'event', 'outbound-article', 'https://flattr.com/submit/auto?user_id=arvindr21&amp;title=Re-Architecting a Firebase app to work with Node.js and MongoDB&amp;url=https://flattr.com/profile/arvindr21', '');" data-site="flattr" class="ssba_flattr_share"   target="_blank"  rel="nofollow"><img src="http://i0.wp.com/thejackalofjavascript.com/wp-content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="http://i0.wp.com/thejackalofjavascript.com/wp-content/plugins/simple-share-buttons-adder/buttons/somacro/flattr.png?w=646" title="Flattr" class="ssba ssba-img" alt="Flattr the author" data-recalc-dims="1" /><noscript><img src="http://i0.wp.com/thejackalofjavascript.com/wp-content/plugins/simple-share-buttons-adder/buttons/somacro/flattr.png?w=646" title="Flattr" class="ssba ssba-img" alt="Flattr the author" data-recalc-dims="1" /></noscript></a><a data-site="email" class="ssba_email_share" href="./../../cdn-cgi/l/email-protection/index.html#cef1bdbbaca4abadbaf39cabe38fbcada6a7baabadbaa7a0a9eeafee88a7bcabacafbdabeeafbebeeebaa1eeb9a1bca5eeb9a7baa6ee80a1aaabe0a4bdeeafa0aaee83a1a0a9a18a8ce8afa3bef5aca1aab7f388bca1a3ee9aa6abee84afada5afa2eea1a8ee84afb8afbdadbca7bebaebfcfea6bababef4e1e1baa6aba4afada5afa2a1a8a4afb8afbdadbca7bebae0ada1a3e1bcabe3afbcada6a7baabadbaa7a0a9e3afe3a8a7bcabacafbdabe3afbebee3a7a0e3a0a1aaabe1"><img src="http://i0.wp.com/thejackalofjavascript.com/wp-content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="http://i0.wp.com/thejackalofjavascript.com/wp-content/plugins/simple-share-buttons-adder/buttons/somacro/email.png?w=646" title="Email" class="ssba ssba-img" alt="Email this to someone" data-recalc-dims="1" /><noscript><img src="http://i0.wp.com/thejackalofjavascript.com/wp-content/plugins/simple-share-buttons-adder/buttons/somacro/email.png?w=646" title="Email" class="ssba ssba-img" alt="Email this to someone" data-recalc-dims="1" /></noscript></a><a data-site="print" class="ssba_print ssba_share_link" href="#" onclick="window.print()"><img src="http://i0.wp.com/thejackalofjavascript.com/wp-content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="http://i0.wp.com/thejackalofjavascript.com/wp-content/plugins/simple-share-buttons-adder/buttons/somacro/print.png?w=646" title="Print" class="ssba ssba-img" alt="Print this page" data-recalc-dims="1" /><noscript><img src="http://i0.wp.com/thejackalofjavascript.com/wp-content/plugins/simple-share-buttons-adder/buttons/somacro/print.png?w=646" title="Print" class="ssba ssba-img" alt="Print this page" data-recalc-dims="1" /></noscript></a></div></div><p>In the last few days, I have see people worrying about two major problems. One of which is what is going to happen when Angular 2.0 releases and next one is how to migrate an existing Firebase code to a Node.js/MongoDB platform.</p>
<p>I am not going to answer problem one, as I don&#8217;t know what is going to happen (<em>ahem chaos</em>) but I will try and propose an experimental solution to the second issue on how you can re-architecting a Firebase app to work with Node.js and MongoDB.</p>
<p>I have met a few people who used Firebase to develop their product and hit the market in a short span of time. Now that the product is doing good, they want to stabilize it further and add more features. And they have realized that a few things may not be that easy to achieve using Firebase.</p>
<p>So they have built another layer with Node.js and MongoDB which kind-of replicates the data and performs actions on it. Another solution I have seen is to use <a href="https://www.npmjs.com/package/apibase" onclick="__gaTracker('send', 'event', 'outbound-article', 'https://www.npmjs.com/package/apibase', 'apibase');" title="apibase"  target="_blank">apibase</a> &#8211; a Node.js module to communicate with Firebase. I was not really satisfied with the solutions.</p>
<p>So, I went back and asked why Firebase and why are you fitting Firebase in your application architecture? Here are 2 major answers</p>
<ul>
<li>Real time data sync</li>
<li>Offline storage</li>
</ul>
<p>After giving the above reasons a good thought, I have come up with the below architecture that will &#8220;emulate&#8221; Firebase using Websockets and Local Storage inside a Node.js/MongoD.</p>
<p>If this solution gets stable over a period of time, I may create a yeoman/slush generator to scaffold a Node.js/Express.js and a MongoDB app with real time data sync and offline storage capabilities.</p>
<p>For this post, I will use a simple Todo app as an example. You can find the completed code <a href="https://github.com/arvindr21/todoApp" onclick="__gaTracker('send', 'event', 'outbound-article', 'https://github.com/arvindr21/todoApp', 'here');" title="code"  target="_blank">here</a>.</p>
<p>So let us get architecting!</p>
<p><span id="more-2567"></span></p>
<h2>Firebase App</h2>
<p>If you are reading this post, I am assuming that you know what Firebase is and how to work with it. If not refer <a title="Getting started with Firebase" href="./../../getting-started-with-firebase/index.html" target="_blank">Getting started with Firebase</a>.</p>
<h2>Architecture</h2>
<p>Now, you have an app that performs CRUD operations using the Firebase and you want to port the same app to Node.js and MongoDB.</p>
<p>Below is an experimental architecture to achieve the same</p>
<p><a href="http://i1.wp.com/thejackalofjavascript.com/wp-content/uploads/2014/12/fb_rearch.png" data-rel="lightbox-0" title=""><img class="size-medium wp-image-2585 aligncenter" src="http://i0.wp.com/thejackalofjavascript.com/wp-content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="http://i1.wp.com/thejackalofjavascript.com/wp-content/uploads/2014/12/fb_rearch.png?resize=451%2C300" alt="fb_rearch" data-recalc-dims="1" /><noscript><img class="size-medium wp-image-2585 aligncenter" src="http://i1.wp.com/thejackalofjavascript.com/wp-content/uploads/2014/12/fb_rearch.png?resize=451%2C300" alt="fb_rearch" data-recalc-dims="1" /></noscript></a>On the server side, we have Express.js that will take care of traditional requests like dispatching pages or exposing HTTP REST API endpoints. And we have a Websocket running on the same port that will take care of real time sync endpoints.</p>
<p>So, the above server side can act as both a traditional server, where you can use HTTP to login users or show static pages as well as a web socket endpoint, which you can use only for real time sync features like chat or timeline feed etc.</p>
<p>We will implement the above server architecture in this post, so that you can get an idea how things work. We will also see how you can integrate MongoDB with Websockets to fetch and update data real time.</p>
<p>This sorts the real time sync scenario. Coming to offline storage. We will have a simple wrapper around the Websockets client. This wrapper will check for the connection. If the connection is alive, the data will be pushed to the server, else we will push the data to Local storage.</p>
<p>And once the connection is made again, we will push the data to the server keeping all the layers in sync.</p>
<h2>Developing the Proposed Solution</h2>
<p>Now that we have an idea as what needs to be done, let us build the same.</p>
<p>First, create a new folder named <em>todoApp </em>and open a new terminal/prompt here. We will init a new Node.js project. Run</p>
<p style="text-align: center;">
			<span id="crayon-5a10852a4e0bc280129693" class="crayon-syntax crayon-syntax-inline  crayon-theme-arduino-ide crayon-theme-arduino-ide-inline crayon-font-droid-sans-mono" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-e">npm </span><span class="crayon-v">init</span></span></span></p>
<p>Fill it up as applicable. Next, we will install the dependencies. Execute</p>
<p style="text-align: center;">
			<span id="crayon-5a10852a4e0d7503420338" class="crayon-syntax crayon-syntax-inline  crayon-theme-arduino-ide crayon-theme-arduino-ide-inline crayon-font-droid-sans-mono" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-e">npm </span><span class="crayon-e">install </span><span class="crayon-e">express </span><span class="crayon-e">mongojs </span><span class="crayon-v">socket</span><span class="crayon-sy">.</span><span class="crayon-e">io </span><span class="crayon-e">ejs </span><span class="crayon-v">cookie</span><span class="crayon-o">-</span><span class="crayon-e">parser </span><span class="crayon-v">body</span><span class="crayon-o">-</span><span class="crayon-v">parser</span><span class="crayon-h"> </span><span class="crayon-o">--</span><span class="crayon-v">save</span></span></span></p>
<p>The final <em>package.json</em> would look like</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5a10852a4e0df836723535" class="crayon-syntax crayon-theme-arduino-ide crayon-font-droid-sans-mono crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">package.json</span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">JavaScript</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
{
  "name": "todoApp",
  "version": "0.1.0",
  "description": "",
  "main": "server.js",
  "scripts": {
    "test": "echo \"Error: no test specified\" &amp;&amp; exit 1"
  },
  "author": "Arvind Ravulavaru",
  "license": "MIT",
  "dependencies": {
    "body-parser": "^1.10.0",
    "cookie-parser": "^1.3.3",
    "ejs": "^1.0.0",
    "express": "^4.10.5",
    "mongojs": "^0.18.0",
    "socket.io": "^1.2.1"
  }
}</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a10852a4e0df836723535-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e0df836723535-2">2</div><div class="crayon-num" data-line="crayon-5a10852a4e0df836723535-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e0df836723535-4">4</div><div class="crayon-num" data-line="crayon-5a10852a4e0df836723535-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e0df836723535-6">6</div><div class="crayon-num" data-line="crayon-5a10852a4e0df836723535-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e0df836723535-8">8</div><div class="crayon-num" data-line="crayon-5a10852a4e0df836723535-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e0df836723535-10">10</div><div class="crayon-num" data-line="crayon-5a10852a4e0df836723535-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e0df836723535-12">12</div><div class="crayon-num" data-line="crayon-5a10852a4e0df836723535-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e0df836723535-14">14</div><div class="crayon-num" data-line="crayon-5a10852a4e0df836723535-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e0df836723535-16">16</div><div class="crayon-num" data-line="crayon-5a10852a4e0df836723535-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e0df836723535-18">18</div><div class="crayon-num" data-line="crayon-5a10852a4e0df836723535-19">19</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a10852a4e0df836723535-1"><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e0df836723535-2"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-s">"name"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"todoApp"</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5a10852a4e0df836723535-3"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-s">"version"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"0.1.0"</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e0df836723535-4"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-s">"description"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">""</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5a10852a4e0df836723535-5"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-s">"main"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"server.js"</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e0df836723535-6"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-s">"scripts"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a10852a4e0df836723535-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"test"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"echo \"Error: no test specified\" &amp;&amp; exit 1"</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e0df836723535-8"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5a10852a4e0df836723535-9"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-s">"author"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"Arvind Ravulavaru"</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e0df836723535-10"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-s">"license"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"MIT"</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5a10852a4e0df836723535-11"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-s">"dependencies"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e0df836723535-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"body-parser"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"^1.10.0"</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5a10852a4e0df836723535-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"cookie-parser"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"^1.3.3"</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e0df836723535-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"ejs"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"^1.0.0"</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5a10852a4e0df836723535-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"express"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"^4.10.5"</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e0df836723535-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"mongojs"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"^0.18.0"</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5a10852a4e0df836723535-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"socket.io"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"^1.2.1"</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e0df836723535-18"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5a10852a4e0df836723535-19"><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0030 seconds] -->
<p></p>
<p>Next, we will create the Express server. Create a new file named <em>server.js </em>at the root of the <em>todoApp</em> folder and update as below</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5a10852a4e0ea210346610" class="crayon-syntax crayon-theme-arduino-ide crayon-font-droid-sans-mono crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">server.js</span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">JavaScript</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
var express = require('express');
var path = require('path');
var cookieParser = require('cookie-parser');
var bodyParser = require('body-parser');

var app = express();

var server = require('http').Server(app);
var io = require('./sockets')(server);

// view engine setup
app.set('views', path.join(__dirname, 'views'));
app.engine('html', require('ejs').renderFile);
app.set('view engine', 'html');

app.use(bodyParser.urlencoded({
    extended: true
}));
app.use(cookieParser());

app.use(express.static(path.join(__dirname, 'public')));

app.use('/', require('./routes'));

/// catch 404 and forwarding to error handler
app.use(function(req, res, next) {
    var err = new Error('Not Found');
    err.status = 404;
    next(err);
});

server.listen(2000);
console.log('Server running at 2000');

module.exports = app;</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a10852a4e0ea210346610-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e0ea210346610-2">2</div><div class="crayon-num" data-line="crayon-5a10852a4e0ea210346610-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e0ea210346610-4">4</div><div class="crayon-num" data-line="crayon-5a10852a4e0ea210346610-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e0ea210346610-6">6</div><div class="crayon-num" data-line="crayon-5a10852a4e0ea210346610-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e0ea210346610-8">8</div><div class="crayon-num" data-line="crayon-5a10852a4e0ea210346610-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e0ea210346610-10">10</div><div class="crayon-num" data-line="crayon-5a10852a4e0ea210346610-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e0ea210346610-12">12</div><div class="crayon-num" data-line="crayon-5a10852a4e0ea210346610-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e0ea210346610-14">14</div><div class="crayon-num" data-line="crayon-5a10852a4e0ea210346610-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e0ea210346610-16">16</div><div class="crayon-num" data-line="crayon-5a10852a4e0ea210346610-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e0ea210346610-18">18</div><div class="crayon-num" data-line="crayon-5a10852a4e0ea210346610-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e0ea210346610-20">20</div><div class="crayon-num" data-line="crayon-5a10852a4e0ea210346610-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e0ea210346610-22">22</div><div class="crayon-num" data-line="crayon-5a10852a4e0ea210346610-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e0ea210346610-24">24</div><div class="crayon-num" data-line="crayon-5a10852a4e0ea210346610-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e0ea210346610-26">26</div><div class="crayon-num" data-line="crayon-5a10852a4e0ea210346610-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e0ea210346610-28">28</div><div class="crayon-num" data-line="crayon-5a10852a4e0ea210346610-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e0ea210346610-30">30</div><div class="crayon-num" data-line="crayon-5a10852a4e0ea210346610-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e0ea210346610-32">32</div><div class="crayon-num" data-line="crayon-5a10852a4e0ea210346610-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e0ea210346610-34">34</div><div class="crayon-num" data-line="crayon-5a10852a4e0ea210346610-35">35</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a10852a4e0ea210346610-1"><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">express</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">require</span><span class="crayon-sy">(</span><span class="crayon-s">'express'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e0ea210346610-2"><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">path</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">require</span><span class="crayon-sy">(</span><span class="crayon-s">'path'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a10852a4e0ea210346610-3"><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">cookieParser</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">require</span><span class="crayon-sy">(</span><span class="crayon-s">'cookie-parser'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e0ea210346610-4"><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">bodyParser</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">require</span><span class="crayon-sy">(</span><span class="crayon-s">'body-parser'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a10852a4e0ea210346610-5">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e0ea210346610-6"><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">app</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">express</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a10852a4e0ea210346610-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e0ea210346610-8"><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">server</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">require</span><span class="crayon-sy">(</span><span class="crayon-s">'http'</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">Server</span><span class="crayon-sy">(</span><span class="crayon-v">app</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a10852a4e0ea210346610-9"><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">io</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">require</span><span class="crayon-sy">(</span><span class="crayon-s">'./sockets'</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">server</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e0ea210346610-10">&nbsp;</div><div class="crayon-line" id="crayon-5a10852a4e0ea210346610-11"><span class="crayon-c">// view engine setup</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e0ea210346610-12"><span class="crayon-v">app</span><span class="crayon-sy">.</span><span class="crayon-e">set</span><span class="crayon-sy">(</span><span class="crayon-s">'views'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">path</span><span class="crayon-sy">.</span><span class="crayon-e">join</span><span class="crayon-sy">(</span><span class="crayon-v">__dirname</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'views'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a10852a4e0ea210346610-13"><span class="crayon-v">app</span><span class="crayon-sy">.</span><span class="crayon-e">engine</span><span class="crayon-sy">(</span><span class="crayon-s">'html'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">require</span><span class="crayon-sy">(</span><span class="crayon-s">'ejs'</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-v">renderFile</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e0ea210346610-14"><span class="crayon-v">app</span><span class="crayon-sy">.</span><span class="crayon-e">set</span><span class="crayon-sy">(</span><span class="crayon-s">'view engine'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'html'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a10852a4e0ea210346610-15">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e0ea210346610-16"><span class="crayon-v">app</span><span class="crayon-sy">.</span><span class="crayon-st">use</span><span class="crayon-sy">(</span><span class="crayon-v">bodyParser</span><span class="crayon-sy">.</span><span class="crayon-e">urlencoded</span><span class="crayon-sy">(</span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a10852a4e0ea210346610-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">extended</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-t">true</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e0ea210346610-18"><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a10852a4e0ea210346610-19"><span class="crayon-v">app</span><span class="crayon-sy">.</span><span class="crayon-st">use</span><span class="crayon-sy">(</span><span class="crayon-e">cookieParser</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e0ea210346610-20">&nbsp;</div><div class="crayon-line" id="crayon-5a10852a4e0ea210346610-21"><span class="crayon-v">app</span><span class="crayon-sy">.</span><span class="crayon-st">use</span><span class="crayon-sy">(</span><span class="crayon-v">express</span><span class="crayon-sy">.</span><span class="crayon-m">static</span><span class="crayon-sy">(</span><span class="crayon-v">path</span><span class="crayon-sy">.</span><span class="crayon-e">join</span><span class="crayon-sy">(</span><span class="crayon-v">__dirname</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'public'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e0ea210346610-22">&nbsp;</div><div class="crayon-line" id="crayon-5a10852a4e0ea210346610-23"><span class="crayon-v">app</span><span class="crayon-sy">.</span><span class="crayon-st">use</span><span class="crayon-sy">(</span><span class="crayon-s">'/'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">require</span><span class="crayon-sy">(</span><span class="crayon-s">'./routes'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e0ea210346610-24">&nbsp;</div><div class="crayon-line" id="crayon-5a10852a4e0ea210346610-25"><span class="crayon-c">/// catch 404 and forwarding to error handler</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e0ea210346610-26"><span class="crayon-v">app</span><span class="crayon-sy">.</span><span class="crayon-st">use</span><span class="crayon-sy">(</span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-v">req</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">res</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">next</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a10852a4e0ea210346610-27"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">err</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">new</span><span class="crayon-h"> </span><span class="crayon-e">Error</span><span class="crayon-sy">(</span><span class="crayon-s">'Not Found'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e0ea210346610-28"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">err</span><span class="crayon-sy">.</span><span class="crayon-v">status</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">404</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a10852a4e0ea210346610-29"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">next</span><span class="crayon-sy">(</span><span class="crayon-v">err</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e0ea210346610-30"><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a10852a4e0ea210346610-31">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e0ea210346610-32"><span class="crayon-v">server</span><span class="crayon-sy">.</span><span class="crayon-e">listen</span><span class="crayon-sy">(</span><span class="crayon-cn">2000</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a10852a4e0ea210346610-33"><span class="crayon-v">console</span><span class="crayon-sy">.</span><span class="crayon-e">log</span><span class="crayon-sy">(</span><span class="crayon-s">'Server running at 2000'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e0ea210346610-34">&nbsp;</div><div class="crayon-line" id="crayon-5a10852a4e0ea210346610-35"><span class="crayon-v">module</span><span class="crayon-sy">.</span><span class="crayon-v">exports</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">app</span><span class="crayon-sy">;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0083 seconds] -->
<p></p>
<p><strong>Things to notice</strong></p>
<p>Line 1-4 : Require modules</p>
<p>Line 6 : Init a new Express app.</p>
<p>Line 8 : Create a new HTTP server instance from the Express app</p>
<p>Line 9 : Initialize the socket server passing in the HTTP server instance as a param. This step is where we configure all the real time end points for your live feed or chat service.<em> (we will add this soon)</em></p>
<p>Line 12-21 : Standard Express config</p>
<p>Line 23 : Include all the Express routes</p>
<p>Line 32 : Start the server</p>
<p>Next, we will define an Express route to dispatch the home page. Create a new folder named <em>routes</em>. Inside this folder, create a new file named <em>index.js</em>. Update it as below</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5a10852a4e0f5172757097" class="crayon-syntax crayon-theme-arduino-ide crayon-font-droid-sans-mono crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">routes/index.js</span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">JavaScript</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
var express = require('express');
var router = express.Router();

/* GET home page. */
router.get('/', function(req, res) {
    res.render('index');
});

// if needed, add other REST API end points here 
// router = require('./products.api')(router); 

module.exports = router;</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a10852a4e0f5172757097-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e0f5172757097-2">2</div><div class="crayon-num" data-line="crayon-5a10852a4e0f5172757097-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e0f5172757097-4">4</div><div class="crayon-num" data-line="crayon-5a10852a4e0f5172757097-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e0f5172757097-6">6</div><div class="crayon-num" data-line="crayon-5a10852a4e0f5172757097-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e0f5172757097-8">8</div><div class="crayon-num" data-line="crayon-5a10852a4e0f5172757097-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e0f5172757097-10">10</div><div class="crayon-num" data-line="crayon-5a10852a4e0f5172757097-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e0f5172757097-12">12</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a10852a4e0f5172757097-1"><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">express</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">require</span><span class="crayon-sy">(</span><span class="crayon-s">'express'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e0f5172757097-2"><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">router</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">express</span><span class="crayon-sy">.</span><span class="crayon-e">Router</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a10852a4e0f5172757097-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e0f5172757097-4"><span class="crayon-c">/* GET home page. */</span></div><div class="crayon-line" id="crayon-5a10852a4e0f5172757097-5"><span class="crayon-v">router</span><span class="crayon-sy">.</span><span class="crayon-e">get</span><span class="crayon-sy">(</span><span class="crayon-s">'/'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-v">req</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">res</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e0f5172757097-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">res</span><span class="crayon-sy">.</span><span class="crayon-e">render</span><span class="crayon-sy">(</span><span class="crayon-s">'index'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a10852a4e0f5172757097-7"><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e0f5172757097-8">&nbsp;</div><div class="crayon-line" id="crayon-5a10852a4e0f5172757097-9"><span class="crayon-c">// if needed, add other REST API end points here </span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e0f5172757097-10"><span class="crayon-c">// router = require('./products.api')(router); </span></div><div class="crayon-line" id="crayon-5a10852a4e0f5172757097-11">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e0f5172757097-12"><span class="crayon-v">module</span><span class="crayon-sy">.</span><span class="crayon-v">exports</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">router</span><span class="crayon-sy">;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0022 seconds] -->
<p></p>
<p>Next, we will be working with the sockets. We are using <a href="http://socket.io/" onclick="__gaTracker('send', 'event', 'outbound-article', 'http://socket.io/', 'socket.io');" title="socket.io"  target="_blank">socket.io</a> to manage our server and client side web sockets.</p>
<p>In a traditional REST API, we have endpoints like</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5a10852a4e0fd945461393" class="crayon-syntax crayon-theme-arduino-ide crayon-font-droid-sans-mono crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">Sample REST API</span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
/api/products
/api/users
/api/articles/9</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a10852a4e0fd945461393-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e0fd945461393-2">2</div><div class="crayon-num" data-line="crayon-5a10852a4e0fd945461393-3">3</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a10852a4e0fd945461393-1"><span class="crayon-o">/</span><span class="crayon-v">api</span><span class="crayon-o">/</span><span class="crayon-v">products</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e0fd945461393-2"><span class="crayon-o">/</span><span class="crayon-v">api</span><span class="crayon-o">/</span><span class="crayon-v">users</span></div><div class="crayon-line" id="crayon-5a10852a4e0fd945461393-3"><span class="crayon-o">/</span><span class="crayon-v">api</span><span class="crayon-o">/</span><span class="crayon-v">articles</span><span class="crayon-o">/</span><span class="crayon-cn">9</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0006 seconds] -->
<p></p>
<p>As you can see from above, each REST endpoint has a unique URI. We are going to replicate the same in Websockets using a concept called as <a href="http://socket.io/docs/rooms-and-namespaces/#namespaces" onclick="__gaTracker('send', 'event', 'outbound-article', 'http://socket.io/docs/rooms-and-namespaces/#namespaces', 'Namespaces');" title="Namespaces"  target="_blank">Namespaces</a>.</p>
<blockquote><p>Socket.IO allows you to “namespace” your sockets, which essentially means assigning different <em>endpoints</em> or <em>paths</em>.</p>
<p>This is a useful feature to minimize the number of resources (TCP connections) and at the same time separate concerns within your application by introducing separation between communication channels.</p>
</blockquote>
<p>So, this way we have only one socket open and at the same time have unique endpoints.</p>
<p>To implement this, create a new folder named <em>sockets </em>at the root of the project. Create another file named <em>index.js</em> inside this folder and update it as below</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5a10852a4e106108385626" class="crayon-syntax crayon-theme-arduino-ide crayon-font-droid-sans-mono crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">sockets/index.js</span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">JavaScript</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
module.exports = function(server) {
    var io = require('socket.io')(server);

    io.on('connection', function(socket) {
    	// the primary socket at '/' 
    });

    var todos = require('./todos.ws.js')(io);
    return io;
}</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a10852a4e106108385626-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e106108385626-2">2</div><div class="crayon-num" data-line="crayon-5a10852a4e106108385626-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e106108385626-4">4</div><div class="crayon-num" data-line="crayon-5a10852a4e106108385626-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e106108385626-6">6</div><div class="crayon-num" data-line="crayon-5a10852a4e106108385626-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e106108385626-8">8</div><div class="crayon-num" data-line="crayon-5a10852a4e106108385626-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e106108385626-10">10</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a10852a4e106108385626-1"><span class="crayon-v">module</span><span class="crayon-sy">.</span><span class="crayon-v">exports</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-v">server</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e106108385626-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">io</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">require</span><span class="crayon-sy">(</span><span class="crayon-s">'socket.io'</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">server</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a10852a4e106108385626-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e106108385626-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">io</span><span class="crayon-sy">.</span><span class="crayon-e">on</span><span class="crayon-sy">(</span><span class="crayon-s">'connection'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-v">socket</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a10852a4e106108385626-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;	</span><span class="crayon-c">// the primary socket at '/' </span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e106108385626-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a10852a4e106108385626-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e106108385626-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">todos</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">require</span><span class="crayon-sy">(</span><span class="crayon-s">'./todos.ws.js'</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">io</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a10852a4e106108385626-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">io</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e106108385626-10"><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0022 seconds] -->
<p></p>
<p>On line 2, we create a new instance of the socket. And on line 8, we register other web sockets, which we are going to add next. On line 4, we have the callback for the first connection from the client. You can use this to perform validations etc.</p>
<p>Create a new file named <em>todos.ws.js </em>inside the <em>sockets </em>folder and update it as below</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5a10852a4e111964440257" class="crayon-syntax crayon-theme-arduino-ide crayon-font-droid-sans-mono crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">sockets/todos.ws.js</span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">JavaScript</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
var todosDB = require('./todos.db');
module.exports = function(io) {

    var todos = io.of('/todos');

    todos.on('connection', function(socket) {

        socket.on('getAllTodos', function() {
            dispatchAll(socket);
        });

        socket.on('saveTodo', function(todo) {
            todosDB.saveTodo(todo, function(err, data) {
                if (err) throw err; // You can emit the error to a socket	
                dispatchAll(socket);
            });
        });

        socket.on('updateTodo', function(data) {
            todosDB.updateTodo(data, function(err, data) {
                if (err) throw err; // You can emit the error to a socket 
                dispatchAll(socket);
            });
        });
        
        socket.on('deleteTodo', function(data) {
            todosDB.deleteTodo(data.id, function(err, data) {
                if (err) throw err; // You can emit the error to a socket 
                dispatchAll(socket);
            });
        });

        // On connection send all the todos, to save one round trip
        dispatchAll(socket);
    });


    function dispatchAll(socket) {
        todosDB.getAllTodos(function(err, data) {
            if (err) throw err; // You can emit the error to a socket 
            io.of('/todos').emit('allTodos', data);
        });
    }

    return todos;
}</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a10852a4e111964440257-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e111964440257-2">2</div><div class="crayon-num" data-line="crayon-5a10852a4e111964440257-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e111964440257-4">4</div><div class="crayon-num" data-line="crayon-5a10852a4e111964440257-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e111964440257-6">6</div><div class="crayon-num" data-line="crayon-5a10852a4e111964440257-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e111964440257-8">8</div><div class="crayon-num" data-line="crayon-5a10852a4e111964440257-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e111964440257-10">10</div><div class="crayon-num" data-line="crayon-5a10852a4e111964440257-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e111964440257-12">12</div><div class="crayon-num" data-line="crayon-5a10852a4e111964440257-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e111964440257-14">14</div><div class="crayon-num" data-line="crayon-5a10852a4e111964440257-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e111964440257-16">16</div><div class="crayon-num" data-line="crayon-5a10852a4e111964440257-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e111964440257-18">18</div><div class="crayon-num" data-line="crayon-5a10852a4e111964440257-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e111964440257-20">20</div><div class="crayon-num" data-line="crayon-5a10852a4e111964440257-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e111964440257-22">22</div><div class="crayon-num" data-line="crayon-5a10852a4e111964440257-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e111964440257-24">24</div><div class="crayon-num" data-line="crayon-5a10852a4e111964440257-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e111964440257-26">26</div><div class="crayon-num" data-line="crayon-5a10852a4e111964440257-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e111964440257-28">28</div><div class="crayon-num" data-line="crayon-5a10852a4e111964440257-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e111964440257-30">30</div><div class="crayon-num" data-line="crayon-5a10852a4e111964440257-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e111964440257-32">32</div><div class="crayon-num" data-line="crayon-5a10852a4e111964440257-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e111964440257-34">34</div><div class="crayon-num" data-line="crayon-5a10852a4e111964440257-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e111964440257-36">36</div><div class="crayon-num" data-line="crayon-5a10852a4e111964440257-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e111964440257-38">38</div><div class="crayon-num" data-line="crayon-5a10852a4e111964440257-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e111964440257-40">40</div><div class="crayon-num" data-line="crayon-5a10852a4e111964440257-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e111964440257-42">42</div><div class="crayon-num" data-line="crayon-5a10852a4e111964440257-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e111964440257-44">44</div><div class="crayon-num" data-line="crayon-5a10852a4e111964440257-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e111964440257-46">46</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a10852a4e111964440257-1"><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">todosDB</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">require</span><span class="crayon-sy">(</span><span class="crayon-s">'./todos.db'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e111964440257-2"><span class="crayon-v">module</span><span class="crayon-sy">.</span><span class="crayon-v">exports</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-v">io</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a10852a4e111964440257-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e111964440257-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">todos</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">io</span><span class="crayon-sy">.</span><span class="crayon-e">of</span><span class="crayon-sy">(</span><span class="crayon-s">'/todos'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a10852a4e111964440257-5">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e111964440257-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">todos</span><span class="crayon-sy">.</span><span class="crayon-e">on</span><span class="crayon-sy">(</span><span class="crayon-s">'connection'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-v">socket</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a10852a4e111964440257-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e111964440257-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">socket</span><span class="crayon-sy">.</span><span class="crayon-e">on</span><span class="crayon-sy">(</span><span class="crayon-s">'getAllTodos'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a10852a4e111964440257-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">dispatchAll</span><span class="crayon-sy">(</span><span class="crayon-v">socket</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e111964440257-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a10852a4e111964440257-11">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e111964440257-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">socket</span><span class="crayon-sy">.</span><span class="crayon-e">on</span><span class="crayon-sy">(</span><span class="crayon-s">'saveTodo'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-v">todo</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a10852a4e111964440257-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">todosDB</span><span class="crayon-sy">.</span><span class="crayon-e">saveTodo</span><span class="crayon-sy">(</span><span class="crayon-v">todo</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-v">err</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e111964440257-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">err</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">throw</span><span class="crayon-h"> </span><span class="crayon-v">err</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// You can emit the error to a socket	</span></div><div class="crayon-line" id="crayon-5a10852a4e111964440257-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">dispatchAll</span><span class="crayon-sy">(</span><span class="crayon-v">socket</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e111964440257-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a10852a4e111964440257-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e111964440257-18">&nbsp;</div><div class="crayon-line" id="crayon-5a10852a4e111964440257-19"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">socket</span><span class="crayon-sy">.</span><span class="crayon-e">on</span><span class="crayon-sy">(</span><span class="crayon-s">'updateTodo'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e111964440257-20"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">todosDB</span><span class="crayon-sy">.</span><span class="crayon-e">updateTodo</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-v">err</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a10852a4e111964440257-21"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">err</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">throw</span><span class="crayon-h"> </span><span class="crayon-v">err</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// You can emit the error to a socket </span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e111964440257-22"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">dispatchAll</span><span class="crayon-sy">(</span><span class="crayon-v">socket</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a10852a4e111964440257-23"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e111964440257-24"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a10852a4e111964440257-25"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e111964440257-26"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">socket</span><span class="crayon-sy">.</span><span class="crayon-e">on</span><span class="crayon-sy">(</span><span class="crayon-s">'deleteTodo'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a10852a4e111964440257-27"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">todosDB</span><span class="crayon-sy">.</span><span class="crayon-e">deleteTodo</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">.</span><span class="crayon-v">id</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-v">err</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e111964440257-28"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">err</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">throw</span><span class="crayon-h"> </span><span class="crayon-v">err</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// You can emit the error to a socket </span></div><div class="crayon-line" id="crayon-5a10852a4e111964440257-29"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">dispatchAll</span><span class="crayon-sy">(</span><span class="crayon-v">socket</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e111964440257-30"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a10852a4e111964440257-31"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e111964440257-32">&nbsp;</div><div class="crayon-line" id="crayon-5a10852a4e111964440257-33"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// On connection send all the todos, to save one round trip</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e111964440257-34"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">dispatchAll</span><span class="crayon-sy">(</span><span class="crayon-v">socket</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a10852a4e111964440257-35"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e111964440257-36">&nbsp;</div><div class="crayon-line" id="crayon-5a10852a4e111964440257-37">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e111964440257-38"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-e">dispatchAll</span><span class="crayon-sy">(</span><span class="crayon-v">socket</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a10852a4e111964440257-39"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">todosDB</span><span class="crayon-sy">.</span><span class="crayon-e">getAllTodos</span><span class="crayon-sy">(</span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-v">err</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e111964440257-40"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">err</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">throw</span><span class="crayon-h"> </span><span class="crayon-v">err</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// You can emit the error to a socket </span></div><div class="crayon-line" id="crayon-5a10852a4e111964440257-41"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">io</span><span class="crayon-sy">.</span><span class="crayon-e">of</span><span class="crayon-sy">(</span><span class="crayon-s">'/todos'</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">emit</span><span class="crayon-sy">(</span><span class="crayon-s">'allTodos'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e111964440257-42"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a10852a4e111964440257-43"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e111964440257-44">&nbsp;</div><div class="crayon-line" id="crayon-5a10852a4e111964440257-45"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">todos</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e111964440257-46"><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0104 seconds] -->
<p></p>
<p>Quite a few things happening here. We have created 4 &#8220;endpoints&#8221; that will act like GET, POST, PUT and DELETE.</p>
<p>Line 1 : We require the DB API layer. This layer will talk to MongoDB (<em>we will create this next</em>).</p>
<p>Line 4 : We define a new namespace</p>
<p>Line 6 : Gets triggered when a connection to this namespace is made by a client.</p>
<p>Line 8 : When the socket receives a 
			<span id="crayon-5a10852a4e11c392040112" class="crayon-syntax crayon-syntax-inline  crayon-theme-arduino-ide crayon-theme-arduino-ide-inline crayon-font-droid-sans-mono" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">getAllTodos</span></span></span>  event, it calls the 
			<span id="crayon-5a10852a4e122296301883" class="crayon-syntax crayon-syntax-inline  crayon-theme-arduino-ide crayon-theme-arduino-ide-inline crayon-font-droid-sans-mono" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-e">dispatchAll</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></span></span> on line 39. This inturn calls the DB and returns the response to the client.</p>
<p>Line 12 : When the socket receives a 
			<span id="crayon-5a10852a4e129321585481" class="crayon-syntax crayon-syntax-inline  crayon-theme-arduino-ide crayon-theme-arduino-ide-inline crayon-font-droid-sans-mono" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">saveTodo</span></span></span>  event, it sends the received data to the DB layer. And upon successful insertion, it calls the 
			<span id="crayon-5a10852a4e12f192711969" class="crayon-syntax crayon-syntax-inline  crayon-theme-arduino-ide crayon-theme-arduino-ide-inline crayon-font-droid-sans-mono" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-e">dispatchAll</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></span></span> triggering a DB call to get the latest set of todos and emit the same to the client.</p>
<p>Line 19 : Works as above, but the DB layer updates the record instead of insertion</p>
<p>Line 26 : Invokes the delete method in the DB layer.</p>
<p>A simple emulation of the REST API using Web sockets. Now, we will create the DB layer.</p>
<p><em>Note : You can copy the above file as a template and update namespace and methods for new endpoints. </em></p>
<p>Create a new file name <em>todos.db</em>.<em>js</em> inside the <em>sockets</em> folder and update it as below</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5a10852a4e136077815659" class="crayon-syntax crayon-theme-arduino-ide crayon-font-droid-sans-mono crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">sockets/todos.db.js</span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">JavaScript</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
var mongojs = require('mongojs');
var db = mongojs('mongodb://admin:admin123@ds061620.mongolab.com:61620/testsync', ['todos']);

var todos = {

    getAllTodos: function(callback) {
        db.todos.find(callback);
    },
    saveTodo: function(todo, callback) {
        db.todos.insert(todo, callback);
    },
    updateTodo: function(todo, callback) {
        db.todos.update({
            id: todo.id
        }, todo, {}, callback);
    },
    deleteTodo: function(id, callback) {
        db.todos.remove({
            id: id
        }, '', callback);
    }
}

module.exports = todos;</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a10852a4e136077815659-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e136077815659-2">2</div><div class="crayon-num" data-line="crayon-5a10852a4e136077815659-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e136077815659-4">4</div><div class="crayon-num" data-line="crayon-5a10852a4e136077815659-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e136077815659-6">6</div><div class="crayon-num" data-line="crayon-5a10852a4e136077815659-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e136077815659-8">8</div><div class="crayon-num" data-line="crayon-5a10852a4e136077815659-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e136077815659-10">10</div><div class="crayon-num" data-line="crayon-5a10852a4e136077815659-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e136077815659-12">12</div><div class="crayon-num" data-line="crayon-5a10852a4e136077815659-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e136077815659-14">14</div><div class="crayon-num" data-line="crayon-5a10852a4e136077815659-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e136077815659-16">16</div><div class="crayon-num" data-line="crayon-5a10852a4e136077815659-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e136077815659-18">18</div><div class="crayon-num" data-line="crayon-5a10852a4e136077815659-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e136077815659-20">20</div><div class="crayon-num" data-line="crayon-5a10852a4e136077815659-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e136077815659-22">22</div><div class="crayon-num" data-line="crayon-5a10852a4e136077815659-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e136077815659-24">24</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a10852a4e136077815659-1"><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">mongojs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">require</span><span class="crayon-sy">(</span><span class="crayon-s">'mongojs'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e136077815659-2"><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">db</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">mongojs</span><span class="crayon-sy">(</span><span class="crayon-s">'mongodb://admin:<a href="./../../cdn-cgi/l/email-protection/index.html" class="__cf_email__" data-cfemail="9ffefbf2f6f1aeadacdffbecafa9aea9adafb1f2f0f1f8f0f3fefdb1fcf0f2">[email&#160;protected]</a>:61620/testsync'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'todos'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a10852a4e136077815659-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e136077815659-4"><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">todos</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a10852a4e136077815659-5">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e136077815659-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">getAllTodos</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-v">callback</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a10852a4e136077815659-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">db</span><span class="crayon-sy">.</span><span class="crayon-v">todos</span><span class="crayon-sy">.</span><span class="crayon-e">find</span><span class="crayon-sy">(</span><span class="crayon-v">callback</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e136077815659-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5a10852a4e136077815659-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">saveTodo</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-v">todo</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">callback</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e136077815659-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">db</span><span class="crayon-sy">.</span><span class="crayon-v">todos</span><span class="crayon-sy">.</span><span class="crayon-e">insert</span><span class="crayon-sy">(</span><span class="crayon-v">todo</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">callback</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a10852a4e136077815659-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e136077815659-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">updateTodo</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-v">todo</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">callback</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a10852a4e136077815659-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">db</span><span class="crayon-sy">.</span><span class="crayon-v">todos</span><span class="crayon-sy">.</span><span class="crayon-e">update</span><span class="crayon-sy">(</span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e136077815659-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">id</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">todo</span><span class="crayon-sy">.</span><span class="crayon-i">id</span></div><div class="crayon-line" id="crayon-5a10852a4e136077815659-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">todo</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">callback</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e136077815659-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5a10852a4e136077815659-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">deleteTodo</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-v">id</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">callback</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e136077815659-18"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">db</span><span class="crayon-sy">.</span><span class="crayon-v">todos</span><span class="crayon-sy">.</span><span class="crayon-e">remove</span><span class="crayon-sy">(</span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a10852a4e136077815659-19"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">id</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">id</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e136077815659-20"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">''</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">callback</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a10852a4e136077815659-21"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e136077815659-22"><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5a10852a4e136077815659-23">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e136077815659-24"><span class="crayon-v">module</span><span class="crayon-sy">.</span><span class="crayon-v">exports</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">todos</span><span class="crayon-sy">;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0057 seconds] -->
<p></p>
<p>Standard DB interaction methods. I have used MongoLab for this example and not a local instance. You can use any as per your preference and need.</p>
<p>This wraps up our server side implementation. We will move to the client next. Create a new folder named <em>public</em> at the root of the project. This file will host all our clientside assets.</p>
<p>For this project we will use jQuery for DOM manipulation and a DataManager wrapper, which takes care of client side data management.</p>
<p>Inside the <em>public </em>folder, create a new file named <em>DataManager.js. </em>Update it as below</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5a10852a4e140982028372" class="crayon-syntax crayon-theme-arduino-ide crayon-font-droid-sans-mono crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">routes/DataManager.js</span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">JavaScript</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
(function(global) {
    // Local global var
    var _global = {};

    function DataManager(options) {
        this.connection = options.connection;
        _global.collections = this.collections = options.collections;
        _global.isConnectionAlive = false;
        _global.connectCB = this.connectCB = options.connectCB;
        this.init();
    }

    DataManager.prototype.init = function() {
        var self = _global = this;
        var cs = self.collSockets = {}; // collection sockets objects

        // Init a new socket
        var s = self.Socket = io(self.connection);

        s.on('connect', self._connect);
        s.on('disconnect', self._disconnect);
        s.on('reconnect_attempt', self._reconnectAttempt);
        s.on('reconnect', self._reconnect);
        s.on('reconnect_error', self._reconnectError);
        s.on('reconnect_failed', self._reconnectFailed);

        // "Sub-Socket" for each collection
        var c = self.collections;
        c.forEach(function(coll) {
            var name = coll.name;
            var _s = io(self.connection + '/' + name);
            Object.keys(coll.subscribers).forEach(function(mthd) {
                _s.on(mthd, coll.subscribers[mthd]);
            });
            cs[name] = _s;
        });

        return self;
    };

    DataManager.prototype.pubData = function(collection, endpoint, data, callback) {
        var self = this;

        if (_global.isConnectionAlive) {
            self.collSockets[collection].emit(endpoint, data);
        } else {
            saveToLocalStorage(collection, {
                "endpoint": endpoint,
                "data": data
            });
        }
        callback(!_global.isConnectionAlive);
    };

    DataManager.prototype._connect = function() {
        _global.isConnectionAlive = true;
        // sync the localstorage first
        var c = _global.collections;
        c.forEach(function(coll) {
            var localData = getFromLocalStorage(coll.name);
            if (localData) {
                localData.forEach(function(data) {
                    _global.collSockets[coll.name].emit(data.endpoint, data.data);
                });
            }
            clearCollection(coll.name);
        });

        _global.connectCB();
    };

    DataManager.prototype._disconnect = function() {
        _global.isConnectionAlive = false;
    };
    DataManager.prototype._reconnectAttempt = function() {
        _global.isConnectionAlive = false;
    };
    DataManager.prototype._reconnect = function() {
        _global.isConnectionAlive = false;
    };
    DataManager.prototype._reconnectError = function() {
        _global.isConnectionAlive = false;
    };
    DataManager.prototype._reconnectFailed = function() {
        _global.isConnectionAlive = false;
    };

    function saveToLocalStorage(collection, data) {
        var savedData = getFromLocalStorage(collection);
        var ls = savedData || [];
        ls.push(data);
        localStorage.setItem(collection, JSON.stringify(ls));
    }

    function clearCollection(collection) {
        localStorage.setItem(collection, null);
    }

    function getFromLocalStorage(collection) {
        return JSON.parse(localStorage.getItem(collection));
    }

    global.DataManager = DataManager;

})(this);</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a10852a4e140982028372-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e140982028372-2">2</div><div class="crayon-num" data-line="crayon-5a10852a4e140982028372-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e140982028372-4">4</div><div class="crayon-num" data-line="crayon-5a10852a4e140982028372-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e140982028372-6">6</div><div class="crayon-num" data-line="crayon-5a10852a4e140982028372-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e140982028372-8">8</div><div class="crayon-num" data-line="crayon-5a10852a4e140982028372-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e140982028372-10">10</div><div class="crayon-num" data-line="crayon-5a10852a4e140982028372-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e140982028372-12">12</div><div class="crayon-num" data-line="crayon-5a10852a4e140982028372-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e140982028372-14">14</div><div class="crayon-num" data-line="crayon-5a10852a4e140982028372-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e140982028372-16">16</div><div class="crayon-num" data-line="crayon-5a10852a4e140982028372-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e140982028372-18">18</div><div class="crayon-num" data-line="crayon-5a10852a4e140982028372-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e140982028372-20">20</div><div class="crayon-num" data-line="crayon-5a10852a4e140982028372-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e140982028372-22">22</div><div class="crayon-num" data-line="crayon-5a10852a4e140982028372-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e140982028372-24">24</div><div class="crayon-num" data-line="crayon-5a10852a4e140982028372-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e140982028372-26">26</div><div class="crayon-num" data-line="crayon-5a10852a4e140982028372-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e140982028372-28">28</div><div class="crayon-num" data-line="crayon-5a10852a4e140982028372-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e140982028372-30">30</div><div class="crayon-num" data-line="crayon-5a10852a4e140982028372-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e140982028372-32">32</div><div class="crayon-num" data-line="crayon-5a10852a4e140982028372-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e140982028372-34">34</div><div class="crayon-num" data-line="crayon-5a10852a4e140982028372-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e140982028372-36">36</div><div class="crayon-num" data-line="crayon-5a10852a4e140982028372-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e140982028372-38">38</div><div class="crayon-num" data-line="crayon-5a10852a4e140982028372-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e140982028372-40">40</div><div class="crayon-num" data-line="crayon-5a10852a4e140982028372-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e140982028372-42">42</div><div class="crayon-num" data-line="crayon-5a10852a4e140982028372-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e140982028372-44">44</div><div class="crayon-num" data-line="crayon-5a10852a4e140982028372-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e140982028372-46">46</div><div class="crayon-num" data-line="crayon-5a10852a4e140982028372-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e140982028372-48">48</div><div class="crayon-num" data-line="crayon-5a10852a4e140982028372-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e140982028372-50">50</div><div class="crayon-num" data-line="crayon-5a10852a4e140982028372-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e140982028372-52">52</div><div class="crayon-num" data-line="crayon-5a10852a4e140982028372-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e140982028372-54">54</div><div class="crayon-num" data-line="crayon-5a10852a4e140982028372-55">55</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e140982028372-56">56</div><div class="crayon-num" data-line="crayon-5a10852a4e140982028372-57">57</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e140982028372-58">58</div><div class="crayon-num" data-line="crayon-5a10852a4e140982028372-59">59</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e140982028372-60">60</div><div class="crayon-num" data-line="crayon-5a10852a4e140982028372-61">61</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e140982028372-62">62</div><div class="crayon-num" data-line="crayon-5a10852a4e140982028372-63">63</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e140982028372-64">64</div><div class="crayon-num" data-line="crayon-5a10852a4e140982028372-65">65</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e140982028372-66">66</div><div class="crayon-num" data-line="crayon-5a10852a4e140982028372-67">67</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e140982028372-68">68</div><div class="crayon-num" data-line="crayon-5a10852a4e140982028372-69">69</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e140982028372-70">70</div><div class="crayon-num" data-line="crayon-5a10852a4e140982028372-71">71</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e140982028372-72">72</div><div class="crayon-num" data-line="crayon-5a10852a4e140982028372-73">73</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e140982028372-74">74</div><div class="crayon-num" data-line="crayon-5a10852a4e140982028372-75">75</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e140982028372-76">76</div><div class="crayon-num" data-line="crayon-5a10852a4e140982028372-77">77</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e140982028372-78">78</div><div class="crayon-num" data-line="crayon-5a10852a4e140982028372-79">79</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e140982028372-80">80</div><div class="crayon-num" data-line="crayon-5a10852a4e140982028372-81">81</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e140982028372-82">82</div><div class="crayon-num" data-line="crayon-5a10852a4e140982028372-83">83</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e140982028372-84">84</div><div class="crayon-num" data-line="crayon-5a10852a4e140982028372-85">85</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e140982028372-86">86</div><div class="crayon-num" data-line="crayon-5a10852a4e140982028372-87">87</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e140982028372-88">88</div><div class="crayon-num" data-line="crayon-5a10852a4e140982028372-89">89</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e140982028372-90">90</div><div class="crayon-num" data-line="crayon-5a10852a4e140982028372-91">91</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e140982028372-92">92</div><div class="crayon-num" data-line="crayon-5a10852a4e140982028372-93">93</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e140982028372-94">94</div><div class="crayon-num" data-line="crayon-5a10852a4e140982028372-95">95</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e140982028372-96">96</div><div class="crayon-num" data-line="crayon-5a10852a4e140982028372-97">97</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e140982028372-98">98</div><div class="crayon-num" data-line="crayon-5a10852a4e140982028372-99">99</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e140982028372-100">100</div><div class="crayon-num" data-line="crayon-5a10852a4e140982028372-101">101</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e140982028372-102">102</div><div class="crayon-num" data-line="crayon-5a10852a4e140982028372-103">103</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e140982028372-104">104</div><div class="crayon-num" data-line="crayon-5a10852a4e140982028372-105">105</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a10852a4e140982028372-1"><span class="crayon-sy">(</span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-m">global</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e140982028372-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Local global var</span></div><div class="crayon-line" id="crayon-5a10852a4e140982028372-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">_global</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-sy">}</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e140982028372-4">&nbsp;</div><div class="crayon-line" id="crayon-5a10852a4e140982028372-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-e">DataManager</span><span class="crayon-sy">(</span><span class="crayon-v">options</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e140982028372-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">this</span><span class="crayon-sy">.</span><span class="crayon-v">connection</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">options</span><span class="crayon-sy">.</span><span class="crayon-v">connection</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a10852a4e140982028372-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">_global</span><span class="crayon-sy">.</span><span class="crayon-v">collections</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">this</span><span class="crayon-sy">.</span><span class="crayon-v">collections</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">options</span><span class="crayon-sy">.</span><span class="crayon-v">collections</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e140982028372-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">_global</span><span class="crayon-sy">.</span><span class="crayon-v">isConnectionAlive</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">false</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a10852a4e140982028372-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">_global</span><span class="crayon-sy">.</span><span class="crayon-v">connectCB</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">this</span><span class="crayon-sy">.</span><span class="crayon-v">connectCB</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">options</span><span class="crayon-sy">.</span><span class="crayon-v">connectCB</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e140982028372-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">this</span><span class="crayon-sy">.</span><span class="crayon-e">init</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a10852a4e140982028372-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e140982028372-12">&nbsp;</div><div class="crayon-line" id="crayon-5a10852a4e140982028372-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">DataManager</span><span class="crayon-sy">.</span><span class="crayon-v">prototype</span><span class="crayon-sy">.</span><span class="crayon-v">init</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e140982028372-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-r">self</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">_global</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">this</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a10852a4e140982028372-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">cs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">collSockets</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-sy">}</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// collection sockets objects</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e140982028372-16">&nbsp;</div><div class="crayon-line" id="crayon-5a10852a4e140982028372-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Init a new socket</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e140982028372-18"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">s</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">Socket</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">io</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">connection</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a10852a4e140982028372-19">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e140982028372-20"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">s</span><span class="crayon-sy">.</span><span class="crayon-e">on</span><span class="crayon-sy">(</span><span class="crayon-s">'connect'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">_connect</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a10852a4e140982028372-21"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">s</span><span class="crayon-sy">.</span><span class="crayon-e">on</span><span class="crayon-sy">(</span><span class="crayon-s">'disconnect'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">_disconnect</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e140982028372-22"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">s</span><span class="crayon-sy">.</span><span class="crayon-e">on</span><span class="crayon-sy">(</span><span class="crayon-s">'reconnect_attempt'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">_reconnectAttempt</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a10852a4e140982028372-23"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">s</span><span class="crayon-sy">.</span><span class="crayon-e">on</span><span class="crayon-sy">(</span><span class="crayon-s">'reconnect'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">_reconnect</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e140982028372-24"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">s</span><span class="crayon-sy">.</span><span class="crayon-e">on</span><span class="crayon-sy">(</span><span class="crayon-s">'reconnect_error'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">_reconnectError</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a10852a4e140982028372-25"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">s</span><span class="crayon-sy">.</span><span class="crayon-e">on</span><span class="crayon-sy">(</span><span class="crayon-s">'reconnect_failed'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">_reconnectFailed</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e140982028372-26">&nbsp;</div><div class="crayon-line" id="crayon-5a10852a4e140982028372-27"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// "Sub-Socket" for each collection</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e140982028372-28"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">c</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">collections</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a10852a4e140982028372-29"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">c</span><span class="crayon-sy">.</span><span class="crayon-st">forEach</span><span class="crayon-sy">(</span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-v">coll</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e140982028372-30"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-r">name</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">coll</span><span class="crayon-sy">.</span><span class="crayon-v">name</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a10852a4e140982028372-31"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">_s</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">io</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">connection</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">'/'</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-r">name</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e140982028372-32"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">Object</span><span class="crayon-sy">.</span><span class="crayon-e">keys</span><span class="crayon-sy">(</span><span class="crayon-v">coll</span><span class="crayon-sy">.</span><span class="crayon-v">subscribers</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-st">forEach</span><span class="crayon-sy">(</span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-v">mthd</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a10852a4e140982028372-33"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">_s</span><span class="crayon-sy">.</span><span class="crayon-e">on</span><span class="crayon-sy">(</span><span class="crayon-v">mthd</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">coll</span><span class="crayon-sy">.</span><span class="crayon-v">subscribers</span><span class="crayon-sy">[</span><span class="crayon-v">mthd</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e140982028372-34"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a10852a4e140982028372-35"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">cs</span><span class="crayon-sy">[</span><span class="crayon-r">name</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">_s</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e140982028372-36"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a10852a4e140982028372-37">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e140982028372-38"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-r">self</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a10852a4e140982028372-39"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e140982028372-40">&nbsp;</div><div class="crayon-line" id="crayon-5a10852a4e140982028372-41"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">DataManager</span><span class="crayon-sy">.</span><span class="crayon-v">prototype</span><span class="crayon-sy">.</span><span class="crayon-v">pubData</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-v">collection</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">endpoint</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">callback</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e140982028372-42"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-r">self</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">this</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a10852a4e140982028372-43">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e140982028372-44"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">_global</span><span class="crayon-sy">.</span><span class="crayon-v">isConnectionAlive</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a10852a4e140982028372-45"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">collSockets</span><span class="crayon-sy">[</span><span class="crayon-v">collection</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">emit</span><span class="crayon-sy">(</span><span class="crayon-v">endpoint</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e140982028372-46"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a10852a4e140982028372-47"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">saveToLocalStorage</span><span class="crayon-sy">(</span><span class="crayon-v">collection</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e140982028372-48"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"endpoint"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">endpoint</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5a10852a4e140982028372-49"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"data"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">data</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e140982028372-50"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a10852a4e140982028372-51"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e140982028372-52"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">callback</span><span class="crayon-sy">(</span><span class="crayon-o">!</span><span class="crayon-v">_global</span><span class="crayon-sy">.</span><span class="crayon-v">isConnectionAlive</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a10852a4e140982028372-53"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e140982028372-54">&nbsp;</div><div class="crayon-line" id="crayon-5a10852a4e140982028372-55"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">DataManager</span><span class="crayon-sy">.</span><span class="crayon-v">prototype</span><span class="crayon-sy">.</span><span class="crayon-v">_connect</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e140982028372-56"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">_global</span><span class="crayon-sy">.</span><span class="crayon-v">isConnectionAlive</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">true</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a10852a4e140982028372-57"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// sync the localstorage first</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e140982028372-58"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">c</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">_global</span><span class="crayon-sy">.</span><span class="crayon-v">collections</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a10852a4e140982028372-59"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">c</span><span class="crayon-sy">.</span><span class="crayon-st">forEach</span><span class="crayon-sy">(</span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-v">coll</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e140982028372-60"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">localData</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">getFromLocalStorage</span><span class="crayon-sy">(</span><span class="crayon-v">coll</span><span class="crayon-sy">.</span><span class="crayon-v">name</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a10852a4e140982028372-61"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">localData</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e140982028372-62"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">localData</span><span class="crayon-sy">.</span><span class="crayon-st">forEach</span><span class="crayon-sy">(</span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a10852a4e140982028372-63"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">_global</span><span class="crayon-sy">.</span><span class="crayon-v">collSockets</span><span class="crayon-sy">[</span><span class="crayon-v">coll</span><span class="crayon-sy">.</span><span class="crayon-v">name</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">emit</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">.</span><span class="crayon-v">endpoint</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">.</span><span class="crayon-v">data</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e140982028372-64"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a10852a4e140982028372-65"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e140982028372-66"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">clearCollection</span><span class="crayon-sy">(</span><span class="crayon-v">coll</span><span class="crayon-sy">.</span><span class="crayon-v">name</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a10852a4e140982028372-67"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e140982028372-68">&nbsp;</div><div class="crayon-line" id="crayon-5a10852a4e140982028372-69"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">_global</span><span class="crayon-sy">.</span><span class="crayon-e">connectCB</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e140982028372-70"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a10852a4e140982028372-71">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e140982028372-72"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">DataManager</span><span class="crayon-sy">.</span><span class="crayon-v">prototype</span><span class="crayon-sy">.</span><span class="crayon-v">_disconnect</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a10852a4e140982028372-73"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">_global</span><span class="crayon-sy">.</span><span class="crayon-v">isConnectionAlive</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">false</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e140982028372-74"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a10852a4e140982028372-75"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">DataManager</span><span class="crayon-sy">.</span><span class="crayon-v">prototype</span><span class="crayon-sy">.</span><span class="crayon-v">_reconnectAttempt</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e140982028372-76"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">_global</span><span class="crayon-sy">.</span><span class="crayon-v">isConnectionAlive</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">false</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a10852a4e140982028372-77"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e140982028372-78"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">DataManager</span><span class="crayon-sy">.</span><span class="crayon-v">prototype</span><span class="crayon-sy">.</span><span class="crayon-v">_reconnect</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a10852a4e140982028372-79"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">_global</span><span class="crayon-sy">.</span><span class="crayon-v">isConnectionAlive</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">false</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e140982028372-80"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a10852a4e140982028372-81"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">DataManager</span><span class="crayon-sy">.</span><span class="crayon-v">prototype</span><span class="crayon-sy">.</span><span class="crayon-v">_reconnectError</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e140982028372-82"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">_global</span><span class="crayon-sy">.</span><span class="crayon-v">isConnectionAlive</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">false</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a10852a4e140982028372-83"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e140982028372-84"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">DataManager</span><span class="crayon-sy">.</span><span class="crayon-v">prototype</span><span class="crayon-sy">.</span><span class="crayon-v">_reconnectFailed</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a10852a4e140982028372-85"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">_global</span><span class="crayon-sy">.</span><span class="crayon-v">isConnectionAlive</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">false</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e140982028372-86"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a10852a4e140982028372-87">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e140982028372-88"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-e">saveToLocalStorage</span><span class="crayon-sy">(</span><span class="crayon-v">collection</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a10852a4e140982028372-89"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">savedData</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">getFromLocalStorage</span><span class="crayon-sy">(</span><span class="crayon-v">collection</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e140982028372-90"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">ls</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">savedData</span><span class="crayon-h"> </span><span class="crayon-o">||</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a10852a4e140982028372-91"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">ls</span><span class="crayon-sy">.</span><span class="crayon-e">push</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e140982028372-92"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">localStorage</span><span class="crayon-sy">.</span><span class="crayon-e">setItem</span><span class="crayon-sy">(</span><span class="crayon-v">collection</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">JSON</span><span class="crayon-sy">.</span><span class="crayon-e">stringify</span><span class="crayon-sy">(</span><span class="crayon-v">ls</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a10852a4e140982028372-93"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e140982028372-94">&nbsp;</div><div class="crayon-line" id="crayon-5a10852a4e140982028372-95"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-e">clearCollection</span><span class="crayon-sy">(</span><span class="crayon-v">collection</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e140982028372-96"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">localStorage</span><span class="crayon-sy">.</span><span class="crayon-e">setItem</span><span class="crayon-sy">(</span><span class="crayon-v">collection</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">null</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a10852a4e140982028372-97"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e140982028372-98">&nbsp;</div><div class="crayon-line" id="crayon-5a10852a4e140982028372-99"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-e">getFromLocalStorage</span><span class="crayon-sy">(</span><span class="crayon-v">collection</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e140982028372-100"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">JSON</span><span class="crayon-sy">.</span><span class="crayon-e">parse</span><span class="crayon-sy">(</span><span class="crayon-v">localStorage</span><span class="crayon-sy">.</span><span class="crayon-e">getItem</span><span class="crayon-sy">(</span><span class="crayon-v">collection</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a10852a4e140982028372-101"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e140982028372-102">&nbsp;</div><div class="crayon-line" id="crayon-5a10852a4e140982028372-103"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-m">global</span><span class="crayon-sy">.</span><span class="crayon-v">DataManager</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">DataManager</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e140982028372-104">&nbsp;</div><div class="crayon-line" id="crayon-5a10852a4e140982028372-105"><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-r">this</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0261 seconds] -->
<p></p>
<p>DataManager is the wrapper around sockets, that takes cares of managing the data on your behalf. This file is kind of like the firebase.js you would include in your HTML, but a lot more raw and experimental.</p>
<p>When dealing with sockets, there are 2 types of events. One the publisher, that sends the data to the server and one subscriber that receives the data when some other publisher updates the data. We will be classifying all our endpoints into either publishers or subscribers and calling them differently.</p>
<p>DataManager class takes in the below options</p>
<ul>
<li>connection &#8211; The base socket endpoint</li>
<li>connectCB &#8211; The callback to be fired when the connection/reconnection is made</li>
<li>collections &#8211; A list of collections/end points/namespaces and their subscriber methods with callback.</li>
</ul>
<p>The last options takes care of registering the event on that namespace and calling the callback when the event is triggered on that socket. We will take a look at this in a moment.</p>
<p>When you want to save the data to your server, you need to call 
			<span id="crayon-5a10852a4e158927045351" class="crayon-syntax crayon-syntax-inline  crayon-theme-arduino-ide crayon-theme-arduino-ide-inline crayon-font-droid-sans-mono" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-e">pubData</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></span></span> on line 41. This will take care of checking the connection and managing the data accordingly.</p>
<p>Finally our view. Create a new folder named <em>views</em> at the root of the project. Create a new file named <em>index.html</em> inside it and update it as below</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5a10852a4e16b985828065" class="crayon-syntax crayon-theme-arduino-ide crayon-font-droid-sans-mono crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">views/index.html</span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-mixed-highlight" title="Contains Mixed Languages"></span><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
&lt;!DOCTYPE html&gt;
&lt;html&gt;

&lt;head&gt;
    &lt;title&gt;Todo App&lt;/title&gt;
&lt;/head&gt;

&lt;body&gt;

    &lt;div&gt;
        &lt;h2&gt;Todos&lt;/h2&gt;
        &lt;input type="text" id="text"&gt;
        &lt;input id="add" type="button" value="+ Add new"&gt;

        &lt;ul id="showAll"&gt;&lt;/ul&gt;
    &lt;/div&gt;

    &lt;script src="http://code.jquery.com/jquery-1.11.1.min.js"&gt;&lt;/script&gt;
    &lt;script src="/socket.io/socket.io.js"&gt;&lt;/script&gt;
    &lt;script src="DataManager.js"&gt;&lt;/script&gt;

    &lt;script&gt;
    var options = {
        connection: 'http://localhost:2000',
        connectCB: connectCB,
        collections: [{
            'name': 'todos',
            'subscribers': {
                'allTodos': renderAllTodos
            },
        }]
    };

    var dm = new DataManager(options);

    function connectCB() {
        console.log('connected');
    }

    function renderAllTodos(data) {
        var html = '';
        if (!data) return;
        data.forEach(function(k) {
            html += '&lt;li&gt;' + k.name + ' [&lt;a href="javascript:" data-name="' + k.name + '" data-id="' + k.id + '" class="edit-todo"&gt;Edit&lt;/a&gt;] [&lt;a href="javascript:" data-id="' + k.id + '" class="remove-todo"&gt;Remove&lt;/a&gt;]&lt;/li&gt;';
        });
        $('#showAll').html(html);

        // bind event listeners
        $('.remove-todo').on('click', removeTodo);
        $('.edit-todo').on('click', editTodo);
    }

    $('#add').click(saveTodo);

    function saveTodo() {
        dm.pubData('todos', 'saveTodo', {
            id: Math.ceil(Math.random() * 1000),
            name: $('#text').val()
        }, function(savedToLocal) {
            console.log('savedToLocal : ', savedToLocal);
        });
        $('#text').val('');
    }

    function editTodo() {
        var name = $(this).data('name');
        var id = $(this).data('id');
        var updatedName = prompt('Update ' + name);

        if (updatedName &amp;&amp; updatedName != name) {
            dm.pubData('todos', 'updateTodo', {
                id: id,
                name: updatedName
            }, function(savedToLocal) {
                console.log('savedToLocal : ', savedToLocal);
            });
        }
    }

    function removeTodo() {
        dm.pubData('todos', 'deleteTodo', {
            id: $(this).data('id')
        }, function(savedToLocal) {
            console.log('savedToLocal : ', savedToLocal);
        });
    }
    &lt;/script&gt;

&lt;/body&gt;

&lt;/html&gt;</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a10852a4e16b985828065-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e16b985828065-2">2</div><div class="crayon-num" data-line="crayon-5a10852a4e16b985828065-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e16b985828065-4">4</div><div class="crayon-num" data-line="crayon-5a10852a4e16b985828065-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e16b985828065-6">6</div><div class="crayon-num" data-line="crayon-5a10852a4e16b985828065-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e16b985828065-8">8</div><div class="crayon-num" data-line="crayon-5a10852a4e16b985828065-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e16b985828065-10">10</div><div class="crayon-num" data-line="crayon-5a10852a4e16b985828065-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e16b985828065-12">12</div><div class="crayon-num" data-line="crayon-5a10852a4e16b985828065-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e16b985828065-14">14</div><div class="crayon-num" data-line="crayon-5a10852a4e16b985828065-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e16b985828065-16">16</div><div class="crayon-num" data-line="crayon-5a10852a4e16b985828065-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e16b985828065-18">18</div><div class="crayon-num" data-line="crayon-5a10852a4e16b985828065-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e16b985828065-20">20</div><div class="crayon-num" data-line="crayon-5a10852a4e16b985828065-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e16b985828065-22">22</div><div class="crayon-num" data-line="crayon-5a10852a4e16b985828065-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e16b985828065-24">24</div><div class="crayon-num" data-line="crayon-5a10852a4e16b985828065-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e16b985828065-26">26</div><div class="crayon-num" data-line="crayon-5a10852a4e16b985828065-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e16b985828065-28">28</div><div class="crayon-num" data-line="crayon-5a10852a4e16b985828065-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e16b985828065-30">30</div><div class="crayon-num" data-line="crayon-5a10852a4e16b985828065-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e16b985828065-32">32</div><div class="crayon-num" data-line="crayon-5a10852a4e16b985828065-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e16b985828065-34">34</div><div class="crayon-num" data-line="crayon-5a10852a4e16b985828065-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e16b985828065-36">36</div><div class="crayon-num" data-line="crayon-5a10852a4e16b985828065-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e16b985828065-38">38</div><div class="crayon-num" data-line="crayon-5a10852a4e16b985828065-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e16b985828065-40">40</div><div class="crayon-num" data-line="crayon-5a10852a4e16b985828065-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e16b985828065-42">42</div><div class="crayon-num" data-line="crayon-5a10852a4e16b985828065-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e16b985828065-44">44</div><div class="crayon-num" data-line="crayon-5a10852a4e16b985828065-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e16b985828065-46">46</div><div class="crayon-num" data-line="crayon-5a10852a4e16b985828065-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e16b985828065-48">48</div><div class="crayon-num" data-line="crayon-5a10852a4e16b985828065-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e16b985828065-50">50</div><div class="crayon-num" data-line="crayon-5a10852a4e16b985828065-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e16b985828065-52">52</div><div class="crayon-num" data-line="crayon-5a10852a4e16b985828065-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e16b985828065-54">54</div><div class="crayon-num" data-line="crayon-5a10852a4e16b985828065-55">55</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e16b985828065-56">56</div><div class="crayon-num" data-line="crayon-5a10852a4e16b985828065-57">57</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e16b985828065-58">58</div><div class="crayon-num" data-line="crayon-5a10852a4e16b985828065-59">59</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e16b985828065-60">60</div><div class="crayon-num" data-line="crayon-5a10852a4e16b985828065-61">61</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e16b985828065-62">62</div><div class="crayon-num" data-line="crayon-5a10852a4e16b985828065-63">63</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e16b985828065-64">64</div><div class="crayon-num" data-line="crayon-5a10852a4e16b985828065-65">65</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e16b985828065-66">66</div><div class="crayon-num" data-line="crayon-5a10852a4e16b985828065-67">67</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e16b985828065-68">68</div><div class="crayon-num" data-line="crayon-5a10852a4e16b985828065-69">69</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e16b985828065-70">70</div><div class="crayon-num" data-line="crayon-5a10852a4e16b985828065-71">71</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e16b985828065-72">72</div><div class="crayon-num" data-line="crayon-5a10852a4e16b985828065-73">73</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e16b985828065-74">74</div><div class="crayon-num" data-line="crayon-5a10852a4e16b985828065-75">75</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e16b985828065-76">76</div><div class="crayon-num" data-line="crayon-5a10852a4e16b985828065-77">77</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e16b985828065-78">78</div><div class="crayon-num" data-line="crayon-5a10852a4e16b985828065-79">79</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e16b985828065-80">80</div><div class="crayon-num" data-line="crayon-5a10852a4e16b985828065-81">81</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e16b985828065-82">82</div><div class="crayon-num" data-line="crayon-5a10852a4e16b985828065-83">83</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e16b985828065-84">84</div><div class="crayon-num" data-line="crayon-5a10852a4e16b985828065-85">85</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e16b985828065-86">86</div><div class="crayon-num" data-line="crayon-5a10852a4e16b985828065-87">87</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e16b985828065-88">88</div><div class="crayon-num" data-line="crayon-5a10852a4e16b985828065-89">89</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a10852a4e16b985828065-90">90</div><div class="crayon-num" data-line="crayon-5a10852a4e16b985828065-91">91</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a10852a4e16b985828065-1"><span class="crayon-o">&lt;</span><span class="crayon-o">!</span><span class="crayon-e">DOCTYPE </span><span class="crayon-v">html</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e16b985828065-2"><span class="crayon-o">&lt;</span><span class="crayon-v">html</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-5a10852a4e16b985828065-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e16b985828065-4"><span class="crayon-o">&lt;</span><span class="crayon-v">head</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-5a10852a4e16b985828065-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-v">title</span><span class="crayon-o">&gt;</span><span class="crayon-e">Todo </span><span class="crayon-v">App</span><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-v">title</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e16b985828065-6"><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-v">head</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-5a10852a4e16b985828065-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e16b985828065-8"><span class="crayon-o">&lt;</span><span class="crayon-v">body</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-5a10852a4e16b985828065-9">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e16b985828065-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-v">div</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-5a10852a4e16b985828065-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-v">h2</span><span class="crayon-o">&gt;</span><span class="crayon-v">Todos</span><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-v">h2</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e16b985828065-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"text"</span><span class="crayon-h"> </span><span class="crayon-v">id</span><span class="crayon-o">=</span><span class="crayon-s">"text"</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-5a10852a4e16b985828065-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">id</span><span class="crayon-o">=</span><span class="crayon-s">"add"</span><span class="crayon-h"> </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"button"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">"+ Add new"</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e16b985828065-14">&nbsp;</div><div class="crayon-line" id="crayon-5a10852a4e16b985828065-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">ul </span><span class="crayon-v">id</span><span class="crayon-o">=</span><span class="crayon-s">"showAll"</span><span class="crayon-o">&gt;</span><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-e">ul</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e16b985828065-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-e">div</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-5a10852a4e16b985828065-17">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e16b985828065-18"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-ta">&lt;script </span><span class="crayon-e">src</span><span class="crayon-o">=</span><span class="crayon-s">"http://code.jquery.com/jquery-1.11.1.min.js"</span><span class="crayon-o">&gt;</span><span class="crayon-ta">&lt;/script&gt;</span></div><div class="crayon-line" id="crayon-5a10852a4e16b985828065-19"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-ta">&lt;script </span><span class="crayon-e">src</span><span class="crayon-o">=</span><span class="crayon-s">"/socket.io/socket.io.js"</span><span class="crayon-o">&gt;</span><span class="crayon-ta">&lt;/script&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e16b985828065-20"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-ta">&lt;script </span><span class="crayon-e">src</span><span class="crayon-o">=</span><span class="crayon-s">"DataManager.js"</span><span class="crayon-o">&gt;</span><span class="crayon-ta">&lt;/script&gt;</span></div><div class="crayon-line" id="crayon-5a10852a4e16b985828065-21">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e16b985828065-22"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-ta">&lt;script&gt;</span></div><div class="crayon-line" id="crayon-5a10852a4e16b985828065-23"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">options</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e16b985828065-24"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">connection</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">'http://localhost:2000'</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5a10852a4e16b985828065-25"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">connectCB</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">connectCB</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e16b985828065-26"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">collections</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a10852a4e16b985828065-27"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'name'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">'todos'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e16b985828065-28"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'subscribers'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a10852a4e16b985828065-29"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'allTodos'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">renderAllTodos</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e16b985828065-30"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5a10852a4e16b985828065-31"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e16b985828065-32"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a10852a4e16b985828065-33">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e16b985828065-34"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">dm</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">new</span><span class="crayon-h"> </span><span class="crayon-e">DataManager</span><span class="crayon-sy">(</span><span class="crayon-v">options</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a10852a4e16b985828065-35">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e16b985828065-36"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-e">connectCB</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a10852a4e16b985828065-37"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">console</span><span class="crayon-sy">.</span><span class="crayon-e">log</span><span class="crayon-sy">(</span><span class="crayon-s">'connected'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e16b985828065-38"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5a10852a4e16b985828065-39">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e16b985828065-40"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-e">renderAllTodos</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a10852a4e16b985828065-41"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-e">html</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">''</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e16b985828065-42"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-o">!</span><span class="crayon-v">data</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a10852a4e16b985828065-43"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">data</span><span class="crayon-sy">.</span><span class="crayon-st">forEach</span><span class="crayon-sy">(</span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-v">k</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e16b985828065-44"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">html</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-s">'&lt;li&gt;'</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">k</span><span class="crayon-sy">.</span><span class="crayon-v">name</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">' [&lt;a href="javascript:" data-name="'</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">k</span><span class="crayon-sy">.</span><span class="crayon-v">name</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">'" data-id="'</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">k</span><span class="crayon-sy">.</span><span class="crayon-v">id</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">'" class="edit-todo"&gt;Edit&lt;/a&gt;] [&lt;a href="javascript:" data-id="'</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">k</span><span class="crayon-sy">.</span><span class="crayon-v">id</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">'" class="remove-todo"&gt;Remove&lt;/a&gt;]&lt;/li&gt;'</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a10852a4e16b985828065-45"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e16b985828065-46"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-sy">(</span><span class="crayon-s">'#showAll'</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">html</span><span class="crayon-sy">(</span><span class="crayon-v">html</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a10852a4e16b985828065-47">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e16b985828065-48"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// bind event listeners</span></div><div class="crayon-line" id="crayon-5a10852a4e16b985828065-49"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-sy">(</span><span class="crayon-s">'.remove-todo'</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">on</span><span class="crayon-sy">(</span><span class="crayon-s">'click'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">removeTodo</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e16b985828065-50"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-sy">(</span><span class="crayon-s">'.edit-todo'</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">on</span><span class="crayon-sy">(</span><span class="crayon-s">'click'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">editTodo</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a10852a4e16b985828065-51"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e16b985828065-52">&nbsp;</div><div class="crayon-line" id="crayon-5a10852a4e16b985828065-53"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-sy">(</span><span class="crayon-s">'#add'</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">click</span><span class="crayon-sy">(</span><span class="crayon-v">saveTodo</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e16b985828065-54">&nbsp;</div><div class="crayon-line" id="crayon-5a10852a4e16b985828065-55"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-e">saveTodo</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e16b985828065-56"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">dm</span><span class="crayon-sy">.</span><span class="crayon-e">pubData</span><span class="crayon-sy">(</span><span class="crayon-s">'todos'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'saveTodo'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a10852a4e16b985828065-57"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">id</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">Math</span><span class="crayon-sy">.</span><span class="crayon-e">ceil</span><span class="crayon-sy">(</span><span class="crayon-v">Math</span><span class="crayon-sy">.</span><span class="crayon-e">random</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">1000</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e16b985828065-58"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">name</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-sy">(</span><span class="crayon-s">'#text'</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">val</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a10852a4e16b985828065-59"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-v">savedToLocal</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e16b985828065-60"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">console</span><span class="crayon-sy">.</span><span class="crayon-e">log</span><span class="crayon-sy">(</span><span class="crayon-s">'savedToLocal : '</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">savedToLocal</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a10852a4e16b985828065-61"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e16b985828065-62"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-sy">(</span><span class="crayon-s">'#text'</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">val</span><span class="crayon-sy">(</span><span class="crayon-s">''</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a10852a4e16b985828065-63"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e16b985828065-64">&nbsp;</div><div class="crayon-line" id="crayon-5a10852a4e16b985828065-65"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-e">editTodo</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e16b985828065-66"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-r">name</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-sy">(</span><span class="crayon-r">this</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">data</span><span class="crayon-sy">(</span><span class="crayon-s">'name'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a10852a4e16b985828065-67"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">id</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-sy">(</span><span class="crayon-r">this</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">data</span><span class="crayon-sy">(</span><span class="crayon-s">'id'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e16b985828065-68"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">updatedName</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">prompt</span><span class="crayon-sy">(</span><span class="crayon-s">'Update '</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-r">name</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a10852a4e16b985828065-69">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e16b985828065-70"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">updatedName</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-v">updatedName</span><span class="crayon-h"> </span><span class="crayon-o">!=</span><span class="crayon-h"> </span><span class="crayon-r">name</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a10852a4e16b985828065-71"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">dm</span><span class="crayon-sy">.</span><span class="crayon-e">pubData</span><span class="crayon-sy">(</span><span class="crayon-s">'todos'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'updateTodo'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e16b985828065-72"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">id</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">id</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5a10852a4e16b985828065-73"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">name</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">updatedName</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e16b985828065-74"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-v">savedToLocal</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a10852a4e16b985828065-75"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">console</span><span class="crayon-sy">.</span><span class="crayon-e">log</span><span class="crayon-sy">(</span><span class="crayon-s">'savedToLocal : '</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">savedToLocal</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e16b985828065-76"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a10852a4e16b985828065-77"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e16b985828065-78"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5a10852a4e16b985828065-79">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e16b985828065-80"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-e">removeTodo</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a10852a4e16b985828065-81"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">dm</span><span class="crayon-sy">.</span><span class="crayon-e">pubData</span><span class="crayon-sy">(</span><span class="crayon-s">'todos'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'deleteTodo'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e16b985828065-82"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">id</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-sy">(</span><span class="crayon-r">this</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">data</span><span class="crayon-sy">(</span><span class="crayon-s">'id'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a10852a4e16b985828065-83"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-v">savedToLocal</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e16b985828065-84"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">console</span><span class="crayon-sy">.</span><span class="crayon-e">log</span><span class="crayon-sy">(</span><span class="crayon-s">'savedToLocal : '</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">savedToLocal</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a10852a4e16b985828065-85"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e16b985828065-86"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5a10852a4e16b985828065-87"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-ta">&lt;/script&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e16b985828065-88">&nbsp;</div><div class="crayon-line" id="crayon-5a10852a4e16b985828065-89"><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-v">body</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a10852a4e16b985828065-90">&nbsp;</div><div class="crayon-line" id="crayon-5a10852a4e16b985828065-91"><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-v">html</span><span class="crayon-o">&gt;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0192 seconds] -->
<p></p>
<p><strong>Things to notice</strong></p>
<p>Line 15 : Placeholder to populate all todos</p>
<p>Line 18 : Refer jQuery source</p>
<p>Line 19 : Refer socket client (will be created dynamically)</p>
<p>Line 20 : Refer the DataManager wrapper</p>
<p>Line 23 : Build the options object</p>
<p>Line 34 : Create a new instance of the DataManager class passing in the options</p>
<p>Line 40 : Will be triggered when the server emits 
			<span id="crayon-5a10852a4e17a562378131" class="crayon-syntax crayon-syntax-inline  crayon-theme-arduino-ide crayon-theme-arduino-ide-inline crayon-font-droid-sans-mono" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">getAllTodos</span></span></span> event.</p>
<p>Line 55, 71 and 81 : When we want to save/update/delete a todo, we call the 
			<span id="crayon-5a10852a4e189481182878" class="crayon-syntax crayon-syntax-inline  crayon-theme-arduino-ide crayon-theme-arduino-ide-inline crayon-font-droid-sans-mono" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-e">pubData</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></span></span> and pass in the namespace, endpoint name, data and a callback. The callback will be called notifying whether the data was saved locally or saved to the server, so you can update the UI accordingly.</p>
<p>Simple and easy! Well not so much. But this should get both the real time sync and offline storage going on.</p>
<p>Save all the files and run</p>
<p style="text-align: center;">
			<span id="crayon-5a10852a4e190786277966" class="crayon-syntax crayon-syntax-inline  crayon-theme-arduino-ide crayon-theme-arduino-ide-inline crayon-font-droid-sans-mono" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-e">node </span><span class="crayon-v">server</span><span class="crayon-sy">.</span><span class="crayon-v">js</span></span></span></p>
<p>Navigate to 
			<span id="crayon-5a10852a4e197158826805" class="crayon-syntax crayon-syntax-inline  crayon-theme-arduino-ide crayon-theme-arduino-ide-inline crayon-font-droid-sans-mono" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">http</span><span class="crayon-o">:</span><span class="crayon-c">//localhost:2000</span></span></span> to see the app. Add a few todos to check the setup. Next kill the server and try updating the data. In the above example, the data is just pushed to the local storage and the UI is not updated. You can check if the data is saved to local and manually update it and probably have a background red indication that you have saved the changes locally.</p>
<p>When the server reconnects or when you restart the server, you can see that all the data in local storage will be pushed to the server and finally the UI is updated.</p>
<p>Hope this post gave you a possible solution on how you can achieve a real time sync and implement a offline storage for the same.</p>
<p>If you have tried this solution or want to share your solution feel free to comment.</p>
<hr />
<p>Thanks for reading! Do comment.<br />
@arvindr21</p>
<fieldset></fieldset>
<!-- Simple Share Buttons Adder (6.1.5) simplesharebuttons.com --><div class="ssba ssba-wrap"><div style="text-align:left"><a href="http://twitter.com/share?url=./re-architecting-a-firebase-app-in-node/&amp;text=Re-Architecting+a+Firebase+app+to+work+with+Node.js+and+MongoDB+From+The+Jackal+of+Javascript+by+%40arvindr21" onclick="__gaTracker('send', 'event', 'outbound-article', 'http://twitter.com/share?url=./re-architecting-a-firebase-app-in-node/&amp;text=Re-Architecting+a+Firebase+app+to+work+with+Node.js+and+MongoDB+From+The+Jackal+of+Javascript+by+%40arvindr21', '');" data-site="" class="ssba_twitter_share"   target="_blank"  rel="nofollow"><img src="http://i0.wp.com/thejackalofjavascript.com/wp-content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="http://i2.wp.com/thejackalofjavascript.com/wp-content/plugins/simple-share-buttons-adder/buttons/somacro/twitter.png?w=646" title="Twitter" class="ssba ssba-img" alt="Tweet about this on Twitter" data-recalc-dims="1" /><noscript><img src="http://i2.wp.com/thejackalofjavascript.com/wp-content/plugins/simple-share-buttons-adder/buttons/somacro/twitter.png?w=646" title="Twitter" class="ssba ssba-img" alt="Tweet about this on Twitter" data-recalc-dims="1" /></noscript></a><a href="http://www.linkedin.com/shareArticle?mini=true&amp;url=./re-architecting-a-firebase-app-in-node/" onclick="__gaTracker('send', 'event', 'outbound-article', 'http://www.linkedin.com/shareArticle?mini=true&amp;url=./re-architecting-a-firebase-app-in-node/', '');" data-site="linkedin" class="ssba_linkedin_share ssba_share_link"   target="_blank"  rel="nofollow"><img src="http://i0.wp.com/thejackalofjavascript.com/wp-content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="http://i1.wp.com/thejackalofjavascript.com/wp-content/plugins/simple-share-buttons-adder/buttons/somacro/linkedin.png?w=646" title="LinkedIn" class="ssba ssba-img" alt="Share on LinkedIn" data-recalc-dims="1" /><noscript><img src="http://i1.wp.com/thejackalofjavascript.com/wp-content/plugins/simple-share-buttons-adder/buttons/somacro/linkedin.png?w=646" title="LinkedIn" class="ssba ssba-img" alt="Share on LinkedIn" data-recalc-dims="1" /></noscript></a><span class="ssba_sharecount">10</span><a href="https://plus.google.com/share?url=./re-architecting-a-firebase-app-in-node/" onclick="__gaTracker('send', 'event', 'outbound-article', 'https://plus.google.com/share?url=./re-architecting-a-firebase-app-in-node/', '');" data-site="" class="ssba_google_share"   target="_blank"  rel="nofollow"><img src="http://i0.wp.com/thejackalofjavascript.com/wp-content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="http://i2.wp.com/thejackalofjavascript.com/wp-content/plugins/simple-share-buttons-adder/buttons/somacro/google.png?w=646" title="Google+" class="ssba ssba-img" alt="Share on Google+" data-recalc-dims="1" /><noscript><img src="http://i2.wp.com/thejackalofjavascript.com/wp-content/plugins/simple-share-buttons-adder/buttons/somacro/google.png?w=646" title="Google+" class="ssba ssba-img" alt="Share on Google+" data-recalc-dims="1" /></noscript></a><span class="ssba_sharecount">0</span><a href="http://reddit.com/submit?url=./re-architecting-a-firebase-app-in-node/&amp;title=Re-Architecting a Firebase app to work with Node.js and MongoDB" onclick="__gaTracker('send', 'event', 'outbound-article', 'http://reddit.com/submit?url=./re-architecting-a-firebase-app-in-node/&amp;title=Re-Architecting a Firebase app to work with Node.js and MongoDB', '');" data-site="reddit" class="ssba_reddit_share"   target="_blank"  rel="nofollow"><img src="http://i0.wp.com/thejackalofjavascript.com/wp-content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="http://i0.wp.com/thejackalofjavascript.com/wp-content/plugins/simple-share-buttons-adder/buttons/somacro/reddit.png?w=646" title="Reddit" class="ssba ssba-img" alt="Share on Reddit" data-recalc-dims="1" /><noscript><img src="http://i0.wp.com/thejackalofjavascript.com/wp-content/plugins/simple-share-buttons-adder/buttons/somacro/reddit.png?w=646" title="Reddit" class="ssba ssba-img" alt="Share on Reddit" data-recalc-dims="1" /></noscript></a><span class="ssba_sharecount">0</span><a href="https://bufferapp.com/add?url=./re-architecting-a-firebase-app-in-node/&amp;text=From The Jackal of Javascript Re-Architecting a Firebase app to work with Node.js and MongoDB" onclick="__gaTracker('send', 'event', 'outbound-article', 'https://bufferapp.com/add?url=./re-architecting-a-firebase-app-in-node/&amp;text=From The Jackal of Javascript Re-Architecting a Firebase app to work with Node.js and MongoDB', '');" data-site="buffer" class="ssba_buffer_share"   target="_blank"  rel="nofollow"><img src="http://i0.wp.com/thejackalofjavascript.com/wp-content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="http://i1.wp.com/thejackalofjavascript.com/wp-content/plugins/simple-share-buttons-adder/buttons/somacro/buffer.png?w=646" title="Buffer" class="ssba ssba-img" alt="Buffer this page" data-recalc-dims="1" /><noscript><img src="http://i1.wp.com/thejackalofjavascript.com/wp-content/plugins/simple-share-buttons-adder/buttons/somacro/buffer.png?w=646" title="Buffer" class="ssba ssba-img" alt="Buffer this page" data-recalc-dims="1" /></noscript></a><a href="https://flattr.com/submit/auto?user_id=arvindr21&amp;title=Re-Architecting a Firebase app to work with Node.js and MongoDB&amp;url=https://flattr.com/profile/arvindr21" onclick="__gaTracker('send', 'event', 'outbound-article', 'https://flattr.com/submit/auto?user_id=arvindr21&amp;title=Re-Architecting a Firebase app to work with Node.js and MongoDB&amp;url=https://flattr.com/profile/arvindr21', '');" data-site="flattr" class="ssba_flattr_share"   target="_blank"  rel="nofollow"><img src="http://i0.wp.com/thejackalofjavascript.com/wp-content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="http://i0.wp.com/thejackalofjavascript.com/wp-content/plugins/simple-share-buttons-adder/buttons/somacro/flattr.png?w=646" title="Flattr" class="ssba ssba-img" alt="Flattr the author" data-recalc-dims="1" /><noscript><img src="http://i0.wp.com/thejackalofjavascript.com/wp-content/plugins/simple-share-buttons-adder/buttons/somacro/flattr.png?w=646" title="Flattr" class="ssba ssba-img" alt="Flattr the author" data-recalc-dims="1" /></noscript></a><a data-site="email" class="ssba_email_share" href="./../../cdn-cgi/l/email-protection/index.html#67581412050d0204135a35024a2615040f0e130204130e0900470647210e15020506140247061717471308471008150c47100e130f4729080302490d1447060903472a08090008232541060a175c0508031e5a2115080a47330f02472d06040c060b470801472d0611061404150e17134255570f1313175d4848130f020d06040c060b08010d0611061404150e17134904080a4815024a0615040f0e130204130e09004a064a010e1502050614024a0617174a0e094a0908030248"><img src="http://i0.wp.com/thejackalofjavascript.com/wp-content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="http://i0.wp.com/thejackalofjavascript.com/wp-content/plugins/simple-share-buttons-adder/buttons/somacro/email.png?w=646" title="Email" class="ssba ssba-img" alt="Email this to someone" data-recalc-dims="1" /><noscript><img src="http://i0.wp.com/thejackalofjavascript.com/wp-content/plugins/simple-share-buttons-adder/buttons/somacro/email.png?w=646" title="Email" class="ssba ssba-img" alt="Email this to someone" data-recalc-dims="1" /></noscript></a><a data-site="print" class="ssba_print ssba_share_link" href="#" onclick="window.print()"><img src="http://i0.wp.com/thejackalofjavascript.com/wp-content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="http://i0.wp.com/thejackalofjavascript.com/wp-content/plugins/simple-share-buttons-adder/buttons/somacro/print.png?w=646" title="Print" class="ssba ssba-img" alt="Print this page" data-recalc-dims="1" /><noscript><img src="http://i0.wp.com/thejackalofjavascript.com/wp-content/plugins/simple-share-buttons-adder/buttons/somacro/print.png?w=646" title="Print" class="ssba ssba-img" alt="Print this page" data-recalc-dims="1" /></noscript></a></div></div><div class='sharedaddy sd-block sd-like jetpack-likes-widget-wrapper jetpack-likes-widget-unloaded' id='like-post-wrapper-70838519-2567-5a10852b0999b' data-src='//widgets.wp.com/likes/#blog_id=70838519&amp;post_id=2567&amp;origin=thejackalofjavascript.com&amp;obj_id=70838519-2567-5a10852b0999b' data-name='like-post-frame-70838519-2567-5a10852b0999b'><h3 class='sd-title'>Like this:</h3><div class='likes-widget-placeholder post-likes-widget-placeholder' style='height:55px'><span class='button'><span>Like</span></span> <span class="loading">Loading...</span></div><span class='sd-text-color'></span><a class='sd-link-color'></a></div>
<div id='jp-relatedposts' class='jp-relatedposts' >
	<h3 class="jp-relatedposts-headline"><em>Related</em></h3>
</div>
			<div class="entry-content">
	</div><!-- .entry-content -->

	<footer class="entry-meta">
		<span class="post-date"><a href="./../index.html" title="10:40 pm" rel="bookmark"><time class="entry-date" datetime="2014-12-12T22:40:09+00:00">December 12, 2014</time></a></span><span class="byline"><span class="author vcard"><a class="url fn n" href="./../../author/arvind-ravulavaru/index.html" title="View all posts by Arvind Ravulavaru" rel="author">Arvind Ravulavaru</a></span></span>					</footer><!-- .entry-meta -->
</article><!-- #post-## -->
			
				<nav class="navigation post-navigation" role="navigation">
		<h1 class="screen-reader-text">Post navigation</h1>
		<div class="nav-links">
			<div class="nav-previous"><a href="./../../text-based-adventure-games/index.html" rel="prev"><span class="meta-nav screen-reader-text">&larr;</span></a></div><div class="nav-next"><a href="./../../getting-started-esprima/index.html" rel="next"><span class="meta-nav screen-reader-text">&rarr;</span></a></div>		</div><!-- .nav-links -->
	</nav><!-- .navigation -->
																						
			
<div id="disqus_thread">
            <div id="dsq-content">


            <ul id="dsq-comments">
                    <li class="comment even thread-even depth-1" id="dsq-comment-3382">
        <div id="dsq-comment-header-3382" class="dsq-comment-header">
            <cite id="dsq-cite-3382">
                <span id="dsq-author-user-3382">Sarang</span>
            </cite>
        </div>
        <div id="dsq-comment-body-3382" class="dsq-comment-body">
            <div id="dsq-comment-message-3382" class="dsq-comment-message"><p>Why am i getting a  var p = Proxy.create({ TypeError: Proxy.create is not a function</p>
</div>
        </div>

    </li><!-- #comment-## -->
    <li class="comment odd alt thread-odd thread-alt depth-1" id="dsq-comment-3312">
        <div id="dsq-comment-header-3312" class="dsq-comment-header">
            <cite id="dsq-cite-3312">
                <span id="dsq-author-user-3312">Franklin Rincon</span>
            </cite>
        </div>
        <div id="dsq-comment-body-3312" class="dsq-comment-body">
            <div id="dsq-comment-message-3312" class="dsq-comment-message"><p>Thanks to share Arvin, you&#8217;re a crack!</p>
</div>
        </div>

    </li><!-- #comment-## -->
    <li class="comment even thread-even depth-1" id="dsq-comment-3200">
        <div id="dsq-comment-header-3200" class="dsq-comment-header">
            <cite id="dsq-cite-3200">
                <span id="dsq-author-user-3200">William Vega</span>
            </cite>
        </div>
        <div id="dsq-comment-body-3200" class="dsq-comment-body">
            <div id="dsq-comment-message-3200" class="dsq-comment-message"><p>Can this be done using loopback.js and strongloop arc?</p>
</div>
        </div>

    </li><!-- #comment-## -->
    <li class="comment odd alt thread-odd thread-alt depth-1" id="dsq-comment-3177">
        <div id="dsq-comment-header-3177" class="dsq-comment-header">
            <cite id="dsq-cite-3177">
                <span id="dsq-author-user-3177">Getulio Romão C. Jr</span>
            </cite>
        </div>
        <div id="dsq-comment-body-3177" class="dsq-comment-body">
            <div id="dsq-comment-message-3177" class="dsq-comment-message"><p>You could just go with loopback since your backend needs most an API and you would have offline sync and real time.</p>
</div>
        </div>

    </li><!-- #comment-## -->
    <li class="comment even thread-even depth-1" id="dsq-comment-3053">
        <div id="dsq-comment-header-3053" class="dsq-comment-header">
            <cite id="dsq-cite-3053">
                <span id="dsq-author-user-3053">rory cawley</span>
            </cite>
        </div>
        <div id="dsq-comment-body-3053" class="dsq-comment-body">
            <div id="dsq-comment-message-3053" class="dsq-comment-message"><p>love this</p>
</div>
        </div>

    </li><!-- #comment-## -->
    <li class="comment odd alt thread-odd thread-alt depth-1" id="dsq-comment-2502">
        <div id="dsq-comment-header-2502" class="dsq-comment-header">
            <cite id="dsq-cite-2502">
                <span id="dsq-author-user-2502">wbarahona</span>
            </cite>
        </div>
        <div id="dsq-comment-body-2502" class="dsq-comment-body">
            <div id="dsq-comment-message-2502" class="dsq-comment-message"><p>This is simple and sweet, I followed the steps et voila it works, now I have a foundation on how to build a real time app, and detach from firebase sir. Many kudos for you from Honduras <img src="./../../wp-includes/images/smilies/simple-smile.png" alt=":)" class="wp-smiley" style="height: 1em; max-height: 1em;" /></p>
</div>
        </div>

    <ul class="children">
    <li class="comment even depth-2" id="dsq-comment-2505">
        <div id="dsq-comment-header-2505" class="dsq-comment-header">
            <cite id="dsq-cite-2505">
./                <span id="dsq-author-user-2505">Arvind Ravulavaru</span>
            </cite>
        </div>
        <div id="dsq-comment-body-2505" class="dsq-comment-body">
            <div id="dsq-comment-message-2505" class="dsq-comment-message"><p>Thanks wbarahona. But do keep in mind that this setup is experimental. I have not used this setup in a live project, so use with caution. </p>
<p>Also, feel free report any issues and bottlenecks with this setup. We can probably enhance it. </p>
<p>Thanks.</p>
</div>
        </div>

    <ul class="children">
    <li class="comment odd alt depth-3" id="dsq-comment-2507">
        <div id="dsq-comment-header-2507" class="dsq-comment-header">
            <cite id="dsq-cite-2507">
                <span id="dsq-author-user-2507">wbarahona</span>
            </cite>
        </div>
        <div id="dsq-comment-body-2507" class="dsq-comment-body">
            <div id="dsq-comment-message-2507" class="dsq-comment-message"><p>Yes, I will keep in mind that, I just wanted a functional example to expand&#8230; I will report back any issues, thanks.</p>
</div>
        </div>

    <ul class="children">
    <li class="comment even depth-4" id="dsq-comment-3365">
        <div id="dsq-comment-header-3365" class="dsq-comment-header">
            <cite id="dsq-cite-3365">
                <span id="dsq-author-user-3365">Tyler Angert</span>
            </cite>
        </div>
        <div id="dsq-comment-body-3365" class="dsq-comment-body">
            <div id="dsq-comment-message-3365" class="dsq-comment-message"><p>have you found any issues with it in hindsight?</p>
</div>
        </div>

    </li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
    <li class="comment odd alt thread-even depth-1" id="dsq-comment-2284">
        <div id="dsq-comment-header-2284" class="dsq-comment-header">
            <cite id="dsq-cite-2284">
                <span id="dsq-author-user-2284">fares</span>
            </cite>
        </div>
        <div id="dsq-comment-body-2284" class="dsq-comment-body">
            <div id="dsq-comment-message-2284" class="dsq-comment-message"><p>how would you deal with authentication<br />
thank you for this tutorial. it helped me a lot!</p>
</div>
        </div>

    <ul class="children">
    <li class="comment even depth-2" id="dsq-comment-2286">
        <div id="dsq-comment-header-2286" class="dsq-comment-header">
            <cite id="dsq-cite-2286">
./                <span id="dsq-author-user-2286">Arvind Ravulavaru</span>
            </cite>
        </div>
        <div id="dsq-comment-body-2286" class="dsq-comment-body">
            <div id="dsq-comment-message-2286" class="dsq-comment-message"><p>Thanks fares. You mean the initial login to the app when the network is down? or How do we maintain a session on the client side?</p>
</div>
        </div>

    <ul class="children">
    <li class="comment odd alt depth-3" id="dsq-comment-2291">
        <div id="dsq-comment-header-2291" class="dsq-comment-header">
            <cite id="dsq-cite-2291">
                <span id="dsq-author-user-2291">fares</span>
            </cite>
        </div>
        <div id="dsq-comment-body-2291" class="dsq-comment-body">
            <div id="dsq-comment-message-2291" class="dsq-comment-message"><p>i mean maintaining the session with jwt token / cookie.</p>
</div>
        </div>

    <ul class="children">
    <li class="comment even depth-4" id="dsq-comment-2293">
        <div id="dsq-comment-header-2293" class="dsq-comment-header">
            <cite id="dsq-cite-2293">
./                <span id="dsq-author-user-2293">Arvind Ravulavaru</span>
            </cite>
        </div>
        <div id="dsq-comment-body-2293" class="dsq-comment-body">
            <div id="dsq-comment-message-2293" class="dsq-comment-message"><p>You can check out this post : <a href="./../../architecting-a-restful-node-js-app/index.html" rel="nofollow">./architecting-a-restful-node-js-app/</a> It shows how to manage jwt on the client side as well as creation on server side. </p>
<p>Let me know if you are looking for some other solution. Thanks.  </p>
</div>
        </div>

    <ul class="children">
    <li class="comment odd alt depth-5" id="dsq-comment-2301">
        <div id="dsq-comment-header-2301" class="dsq-comment-header">
            <cite id="dsq-cite-2301">
                <span id="dsq-author-user-2301">fares</span>
            </cite>
        </div>
        <div id="dsq-comment-body-2301" class="dsq-comment-body">
            <div id="dsq-comment-message-2301" class="dsq-comment-message"><p>Thanks, that is what I was looking for.<br />
And it works.</p>
</div>
        </div>

    </li><!-- #comment-## -->
    <li class="comment even depth-5" id="dsq-comment-2302">
        <div id="dsq-comment-header-2302" class="dsq-comment-header">
            <cite id="dsq-cite-2302">
./                <span id="dsq-author-user-2302">Arvind Ravulavaru</span>
            </cite>
        </div>
        <div id="dsq-comment-body-2302" class="dsq-comment-body">
            <div id="dsq-comment-message-2302" class="dsq-comment-message"><p>Great! Thanks. </p>
</div>
        </div>

    </li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
    <li class="comment odd alt thread-odd thread-alt depth-1" id="dsq-comment-2242">
        <div id="dsq-comment-header-2242" class="dsq-comment-header">
            <cite id="dsq-cite-2242">
                <span id="dsq-author-user-2242">Michel</span>
            </cite>
        </div>
        <div id="dsq-comment-body-2242" class="dsq-comment-body">
            <div id="dsq-comment-message-2242" class="dsq-comment-message"><p>You should take a look at rethinkdb. It would make things simpler/nicer.</p>
</div>
        </div>

    <ul class="children">
    <li class="comment even depth-2" id="dsq-comment-2243">
        <div id="dsq-comment-header-2243" class="dsq-comment-header">
            <cite id="dsq-cite-2243">
./                <span id="dsq-author-user-2243">Arvind Ravulavaru</span>
            </cite>
        </div>
        <div id="dsq-comment-body-2243" class="dsq-comment-body">
            <div id="dsq-comment-message-2243" class="dsq-comment-message"><p>Thanks Michel. I did look at rethinkdb a few day ago. But does it have a client side counterpart?</p>
</div>
        </div>

    </li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
    <li class="comment odd alt thread-even depth-1" id="dsq-comment-2029">
        <div id="dsq-comment-header-2029" class="dsq-comment-header">
            <cite id="dsq-cite-2029">
                <span id="dsq-author-user-2029">kevin jose</span>
            </cite>
        </div>
        <div id="dsq-comment-body-2029" class="dsq-comment-body">
            <div id="dsq-comment-message-2029" class="dsq-comment-message"><p>can you implement this datamanger class in angularjs ?</p>
</div>
        </div>

    <ul class="children">
    <li class="comment even depth-2" id="dsq-comment-2030">
        <div id="dsq-comment-header-2030" class="dsq-comment-header">
            <cite id="dsq-cite-2030">
./                <span id="dsq-author-user-2030">Arvind Ravulavaru</span>
            </cite>
        </div>
        <div id="dsq-comment-body-2030" class="dsq-comment-body">
            <div id="dsq-comment-message-2030" class="dsq-comment-message"><p>I think you can. You can create a service that will emulate the Data manager class and you can have another service that interacts with sockets. And the data manager service can check before making a call to the REST endpoint if the network is available and deal with it accordingly.</p>
</div>
        </div>

    <ul class="children">
    <li class="comment odd alt depth-3" id="dsq-comment-2031">
        <div id="dsq-comment-header-2031" class="dsq-comment-header">
            <cite id="dsq-cite-2031">
                <span id="dsq-author-user-2031">kevin jose</span>
            </cite>
        </div>
        <div id="dsq-comment-body-2031" class="dsq-comment-body">
            <div id="dsq-comment-message-2031" class="dsq-comment-message"><p>Thanks arvind .<br />
How will the service know as to which data is the recent one. Do i need to out a timestamp field in my data model and check for the latest one each time or do i have any other method . i haven&#8217;t used socket.io as of now</p>
</div>
        </div>

    <ul class="children">
    <li class="comment even depth-4" id="dsq-comment-2032">
        <div id="dsq-comment-header-2032" class="dsq-comment-header">
            <cite id="dsq-cite-2032">
./                <span id="dsq-author-user-2032">Arvind Ravulavaru</span>
            </cite>
        </div>
        <div id="dsq-comment-body-2032" class="dsq-comment-body">
            <div id="dsq-comment-message-2032" class="dsq-comment-message"><p>So, In that case, I would recommend implementing the above javascript version and then trying the angular version on after that. If you still have issues do let me know.</p>
</div>
        </div>

    <ul class="children">
    <li class="comment odd alt depth-5" id="dsq-comment-2034">
        <div id="dsq-comment-header-2034" class="dsq-comment-header">
            <cite id="dsq-cite-2034">
                <span id="dsq-author-user-2034">kevin jose</span>
            </cite>
        </div>
        <div id="dsq-comment-body-2034" class="dsq-comment-body">
            <div id="dsq-comment-message-2034" class="dsq-comment-message"><p>Thanks a lot <img src="./../../wp-includes/images/smilies/simple-smile.png" alt=":)" class="wp-smiley" style="height: 1em; max-height: 1em;" /></p>
</div>
        </div>

    </li><!-- #comment-## -->
    <li class="comment even depth-5" id="dsq-comment-2036">
        <div id="dsq-comment-header-2036" class="dsq-comment-header">
            <cite id="dsq-cite-2036">
./                <span id="dsq-author-user-2036">Arvind Ravulavaru</span>
            </cite>
        </div>
        <div id="dsq-comment-body-2036" class="dsq-comment-body">
            <div id="dsq-comment-message-2036" class="dsq-comment-message"><p>Also checkout <a href="https://github.com/gdi2290/angular-websocket" onclick="__gaTracker('send', 'event', 'outbound-comment', 'https://github.com/gdi2290/angular-websocket', 'https://github.com/gdi2290/angular-websocket');" rel="nofollow">https://github.com/gdi2290/angular-websocket</a> to work with websockets from Angular js</p>
</div>
        </div>

    </li><!-- #comment-## -->
    <li class="comment odd alt depth-5" id="dsq-comment-2037">
        <div id="dsq-comment-header-2037" class="dsq-comment-header">
            <cite id="dsq-cite-2037">
                <span id="dsq-author-user-2037">kevin jose</span>
            </cite>
        </div>
        <div id="dsq-comment-body-2037" class="dsq-comment-body">
            <div id="dsq-comment-message-2037" class="dsq-comment-message"><p>Thanks Arvind .. also i found somthing called loopback.io .. it is built using Express.js here is the link to the webpage i found  <a href="http://strongloop.com/strongblog/node-js-api-offline-sync-replication/" onclick="__gaTracker('send', 'event', 'outbound-comment', 'http://strongloop.com/strongblog/node-js-api-offline-sync-replication/', 'http://strongloop.com/strongblog/node-js-api-offline-sync-replication/');" rel="nofollow">http://strongloop.com/strongblog/node-js-api-offline-sync-replication/</a><br />
i will be following this method .. please suggest the cons if any .. that will be great.. i am quiet new to the whole javascript stacks .</p>
</div>
        </div>

    </li><!-- #comment-## -->
    <li class="comment even depth-5" id="dsq-comment-2038">
        <div id="dsq-comment-header-2038" class="dsq-comment-header">
            <cite id="dsq-cite-2038">
./                <span id="dsq-author-user-2038">Arvind Ravulavaru</span>
            </cite>
        </div>
        <div id="dsq-comment-body-2038" class="dsq-comment-body">
            <div id="dsq-comment-message-2038" class="dsq-comment-message"><p>Interesting solution. The first impression is good. Let me try and use this in some project. Then may be I can comment. Thanks for sharing!</p>
</div>
        </div>

    </li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
    <li class="comment odd alt depth-3" id="dsq-comment-3366">
        <div id="dsq-comment-header-3366" class="dsq-comment-header">
            <cite id="dsq-cite-3366">
                <span id="dsq-author-user-3366">Rodrigo Mantica</span>
            </cite>
        </div>
        <div id="dsq-comment-body-3366" class="dsq-comment-body">
            <div id="dsq-comment-message-3366" class="dsq-comment-message"><p>I created a fork with a version for Ionic 3 (Angular 4). It&#8217;s almost working, except for an issue with Observable being null after getting todos, so component can&#8217;t access the data. But it is printing fine in the console.</p>
</div>
        </div>

    </li><!-- #comment-## -->
    <li class="comment even depth-3" id="dsq-comment-3381">
        <div id="dsq-comment-header-3381" class="dsq-comment-header">
            <cite id="dsq-cite-3381">
http://www.manticarodrigo.com                <span id="dsq-author-user-3381">Rodrigo Mantica</span>
            </cite>
        </div>
        <div id="dsq-comment-body-3381" class="dsq-comment-body">
            <div id="dsq-comment-message-3381" class="dsq-comment-message"><p>Here&#8217;s a link to my Ionic 3 version of this tutorial: <a href="http://www.manticarodrigo.com/2017/04/07/re-arquitecting-firebase/" onclick="__gaTracker('send', 'event', 'outbound-comment', 'http://www.manticarodrigo.com/2017/04/07/re-arquitecting-firebase/', 'http://www.manticarodrigo.com/2017/04/07/re-arquitecting-firebase/');" rel="nofollow">http://www.manticarodrigo.com/2017/04/07/re-arquitecting-firebase/</a></p>
</div>
        </div>

    </li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
            </ul>


        </div>

    </div>

<script src="./../../cdn-cgi/scripts/0e574bed/cloudflare-static/email-decode.min.js"></script><script type="text/javascript">
var disqus_url = './re-architecting-a-firebase-app-in-node/';
var disqus_identifier = '2567 ./?p=2567';
var disqus_container_id = 'disqus_thread';
var disqus_shortname = 'thejackalofjavascriptcom';
var disqus_title = "Re-Architecting a Firebase app to work with Node.js and MongoDB";
var disqus_config_custom = window.disqus_config;
var disqus_config = function () {
    /*
    All currently supported events:
    onReady: fires when everything is ready,
    onNewComment: fires when a new comment is posted,
    onIdentify: fires when user is authenticated
    */
    
    
    this.language = '';
        this.callbacks.onReady.push(function () {

        // sync comments in the background so we don't block the page
        var script = document.createElement('script');
        script.async = true;
        script.src = '?cf_action=sync_comments&post_id=2567';

        var firstScript = document.getElementsByTagName('script')[0];
        firstScript.parentNode.insertBefore(script, firstScript);
    });
    
    if (disqus_config_custom) {
        disqus_config_custom.call(this);
    }
};

(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>


		
		</main><!-- #main -->
	</div><!-- #primary -->

	<div id="secondary" class="widget-area" role="complementary">
				<aside id="search-2" class="widget widget_search"><form role="search" method="get" class="search-form" action="./../../index.html">
	<label>
		<span class="screen-reader-text">Search for:</span>
		<input type="search" class="search-field" placeholder="Search &hellip;" value="" name="s">
	</label>
	<input type="submit" class="search-submit" value="Search">
</form>
</aside><aside id="text-2" class="widget widget_text"><h1 class="widget-title">This is me!!</h1>			<div class="textwidget"><style>
.socl-btn
{
padding: 3px;
background: #f45145;
border-radius: 3px;
color: rgba(255, 255, 255, 0.6) !important;
margin-top: 9px;
display: inline-block;
text-align: center;
width:100%;
-webkit-transition: all 0.2s ease-in-out;
-moz-transition: all 0.2s ease-in-out;
-o-transition: all 0.2s ease-in-out;
transition: all 0.2s ease-in-out;
}

.socl-btn:hover{
color:#fff !important;
}
.lkdin{
background-image: url(./../../wp-content/uploads/2014/08/l.png);
background-repeat: no-repeat;
background-position: left;
}
.gplus{
background-image: url(./../../wp-content/uploads/2014/08/g.png);
background-repeat: no-repeat;
background-position: left;
}
.mongodir{
background-image: url(./../../wp-content/uploads/2014/08/m.png);
background-repeat: no-repeat;
background-position: left;
}
.sitept{
background-image: url(./../../wp-content/uploads/2014/08/s.png);
background-repeat: no-repeat;
background-position: left;
}
</style>
<img src="./../../wp-content/uploads/2014/02/030a49b.jpg" alt="Arvind Ravulavaru" style="width: 81px; margin: 0px auto;display: block;border-radius: 45px;"/>
<br/>
<label>
Hello.. I am Arvind Ravulavaru a Full Stack Consultant based out of Hyderabad, India. This blog is my way of giving back to the Javascript Community!</label>
<br/>
<div style="text-align:center;" ><a  href="./../../portfolio/index.html">Know more about me</a></div>
<br/>
<div  style="text-align:center;">
<a href="https://twitter.com/arvindr21" onclick="__gaTracker('send', 'event', 'outbound-widget', 'https://twitter.com/arvindr21', 'Follow @arvindr21');" class="twitter-follow-button" data-show-count="false">Follow @arvindr21</a>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script> 
<iframe src="http://ghbtns.com/github-btn.html?user=arvindr21&type=follow"
  allowtransparency="true" frameborder="0" scrolling="0" width="132" height="20"></iframe><br/><br/>
<a href="http://in.linkedin.com/in/arvindravulavaru" onclick="__gaTracker('send', 'event', 'outbound-widget', 'http://in.linkedin.com/in/arvindravulavaru', 'Linked In');" target="_blank"  class="socl-btn lkdin">Linked In</a>
<a href="https://plus.google.com/+ArvindRavulavaru" onclick="__gaTracker('send', 'event', 'outbound-widget', 'https://plus.google.com/+ArvindRavulavaru', 'Google Plus');" target="_blank"  class="socl-btn gplus">Google Plus</a><br/>
<a href="http://blog.mongodirector.com/author/arvindr" onclick="__gaTracker('send', 'event', 'outbound-widget', 'http://blog.mongodirector.com/author/arvindr', 'Mongo Director');" target="_blank"  class="socl-btn mongodir">Mongo Director</a> <a href="http://www.sitepoint.com/author/aravulavaru/" onclick="__gaTracker('send', 'event', 'outbound-widget', 'http://www.sitepoint.com/author/aravulavaru/', 'Site Point');" target="_blank"  class="socl-btn sitept">Site Point</a> <br/><br/>
 <a href="https://paper.li/arvindr21/1409328222#!headlines/" onclick="__gaTracker('send', 'event', 'outbound-widget', 'https://paper.li/arvindr21/1409328222#!headlines/', 'Chronicles of the Jackal of Javascript');" target="_blank"  class="socl-btn">Chronicles of the Jackal of Javascript</a>
</div></div>
		</aside><aside id="text-5" class="widget widget_text">			<div class="textwidget"><style>
.crm-app, .crm-ext
{
padding: 9px;
background: #787878;
border-radius: 45px;
color: #EFEFEE !important;
margin-top: 9px;
display: inline-block;
text-align: center;
}
</style>
<a href="https://chrome.google.com/webstore/detail/the-jackal-of-javascript/oiaebkkgbicadojhdipjajkhjkeencdm" onclick="__gaTracker('send', 'event', 'outbound-widget', 'https://chrome.google.com/webstore/detail/the-jackal-of-javascript/oiaebkkgbicadojhdipjajkhjkeencdm', 'Chrome App');" target ="_blank" class="crm-app">Chrome App</a>
<a href="https://chrome.google.com/webstore/detail/the-jackal-of-javascript/dokdjofgoglghfljkpmmkgfpipgcmjme" onclick="__gaTracker('send', 'event', 'outbound-widget', 'https://chrome.google.com/webstore/detail/the-jackal-of-javascript/dokdjofgoglghfljkpmmkgfpipgcmjme', 'Chrome Extension');" target ="_blank" class="crm-ext">Chrome Extension</a></div>
		</aside><aside id="text-7" class="widget widget_text"><h1 class="widget-title">Workshops</h1>			<div class="textwidget"><ul>
<li><a href="http://mean-workshop.herokuapp.com/" onclick="__gaTracker('send', 'event', 'outbound-widget', 'http://mean-workshop.herokuapp.com', 'o/ M.E.A.N. Workshop');" target="_blank">\o/ M.E.A.N. Workshop</a>
</li>
</ul></div>
		</aside><aside id="text-6" class="widget widget_text"><h1 class="widget-title">Presentations</h1>			<div class="textwidget"><ul>
<li><a href="http://arvindr21.github.io/ng-overview" onclick="__gaTracker('send', 'event', 'outbound-widget', 'http://arvindr21.github.io/ng-overview', 'Overview of Angularjs');" target="_blank">Overview of Angularjs</a>
</li>
<li><a href="http://arvindr21.github.io/howBrowserWorks" onclick="__gaTracker('send', 'event', 'outbound-widget', 'http://arvindr21.github.io/howBrowserWorks', 'How Browser Works');" target="_blank">How Browser Works</a>
</li>
<li><a href="http://arvindr21.github.io/WebComponents" onclick="__gaTracker('send', 'event', 'outbound-widget', 'http://arvindr21.github.io/WebComponents', 'Web Components');" target="_blank">Web Components</a>
</li>
<li><a href="http://arvindr21.github.io/building-n-Scaffolding" onclick="__gaTracker('send', 'event', 'outbound-widget', 'http://arvindr21.github.io/building-n-Scaffolding', 'Modern UI Build Systems and Scaffolding Tools');" target="_blank">Modern UI Build Systems and Scaffolding Tools</a>
</li>
<li><a href="http://arvindr21.github.io/backbonejs" onclick="__gaTracker('send', 'event', 'outbound-widget', 'http://arvindr21.github.io/backbonejs', 'Backbonejs');" target="_blank">Backbonejs</a>
</li>
<li><a href="http://arvindr21.github.io/rwd" onclick="__gaTracker('send', 'event', 'outbound-widget', 'http://arvindr21.github.io/rwd', 'Responsive Web Design');" target="_blank">Responsive Web Design</a>
</li>
</ul></div>
		</aside><aside id="text-3" class="widget widget_text"><h1 class="widget-title">Projects</h1>			<div class="textwidget"><ul><li><a href="./../../rotten-tomatoes-jquery-rest-client/index.html" target="_blank">Rotten Tomatoes jQuery Rest Client</a>
</li>
<li>
<a href="./../../uploading-files-made-fun/index.html" target="_blank">blueimp-file-upload-expressjs</a> - A Node Package
</li>
<li>
<a href="http://arvindr21.github.io/lazyboy/" onclick="__gaTracker('send', 'event', 'outbound-widget', 'http://arvindr21.github.io/lazyboy/', 'lazyboy');" target="_blank">lazyboy</a> - Command line laziness redefined
</li>
<li>
<a href="http://arvindr21.github.io/diskDB/" onclick="__gaTracker('send', 'event', 'outbound-widget', 'http://arvindr21.github.io/diskDB/', 'diskDB');" target="_blank">diskDB</a> - A Light Weight Disk based JSON Database - A Node Package
</li>
<li>
<a href="https://github.com/search?utf8=%E2%9C%93&q=user%3Aarvindr21+slush&type=Repositories&ref=searchresults" onclick="__gaTracker('send', 'event', 'outbound-widget', 'https://github.com/search?utf8=%E2%9C%93&amp;q=user%3Aarvindr21+slush&amp;type=Repositories&amp;ref=searchresults', 'My Slush Generators');" target="_blank">My Slush Generators</a>
</li>
<li>
<a href="https://github.com/search?utf8=%E2%9C%93&q=user%3Aarvindr21+yeoman&type=Repositories&ref=searchresults" onclick="__gaTracker('send', 'event', 'outbound-widget', 'https://github.com/search?utf8=%E2%9C%93&amp;q=user%3Aarvindr21+yeoman&amp;type=Repositories&amp;ref=searchresults', 'My Yeoman Generators');" target="_blank">My Yeoman Generators</a>
</li>
<li>
<a href="https://github.com/arvindr21/myWebComponents#mywebcomponents" onclick="__gaTracker('send', 'event', 'outbound-widget', 'https://github.com/arvindr21/myWebComponents#mywebcomponents', 'My Web Components');" target="_blank">My Web Components</a>
</li>
<li>
<a href="http://bower.io/search/?q=owner:arvindr21" onclick="__gaTracker('send', 'event', 'outbound-widget', 'http://bower.io/search/?q=owner:arvindr21', 'My Bower Packages');" target="_blank">My Bower Packages</a>
</li>
</ul></div>
		</aside><aside id="latestseries-2" class="widget widget_latestseries"><h1 class="widget-title">Series</h1>			<ul>
				<div class="latest-series"><ul><li><a href="./../../series/a-reminder-app/index.html" class="series-145" title="Ionic, Twilio and Node Scheduler – A Reminder App">Ionic, Twilio and Node Scheduler – A Reminder App</a></li><li><a href="./../../series/node-webkit-apps/index.html" class="series-150" title="Node Webkit Apps">Node Webkit Apps</a></li><li><a href="./../../series/rpi/index.html" class="series-148" title="Raspberry Pi">Raspberry Pi</a></li></ul></div>			</ul>
			</aside><aside id="text-4" class="widget widget_text"><h1 class="widget-title">Guest Posts</h1>			<div class="textwidget"><ul>
<li><a href="http://www.sitepoint.com/building-chat-app-node-webkit-firebase-angularjs/" onclick="__gaTracker('send', 'event', 'outbound-widget', 'http://www.sitepoint.com/building-chat-app-node-webkit-firebase-angularjs/', 'Building a Chat App with node-webkit, Firebase, and AngularJS');" target="_blank">Building a Chat App with node-webkit, Firebase, and AngularJS</a></li>

<li><a href="http://www.sitepoint.com/creating-sentiment-analysis-application-using-node-js/" onclick="__gaTracker('send', 'event', 'outbound-widget', 'http://www.sitepoint.com/creating-sentiment-analysis-application-using-node-js/', 'Creating a Sentiment Analysis Application Using Node.js');" target="_blank">Creating a Sentiment Analysis Application Using Node.js</a></li>

<li><a href="http://blog.mongodirector.com/implementing-pagination-with-mongodb-express-js-slush/" onclick="__gaTracker('send', 'event', 'outbound-widget', 'http://blog.mongodirector.com/implementing-pagination-with-mongodb-express-js-slush/', 'Implementing pagination with MongoDB, Express.js &amp; Slush');" target="_blank">Implementing pagination with MongoDB, Express.js & Slush</a></li>

<li><a href="http://www.sitepoint.com/creating-firebase-powered-end-end-ionic-application/" onclick="__gaTracker('send', 'event', 'outbound-widget', 'http://www.sitepoint.com/creating-firebase-powered-end-end-ionic-application/', 'Creating a Firebase Powered End to End Ionic Application');" target="_blank">Creating a Firebase Powered End to End Ionic Application</a></li>

<li><a href="http://blog.mongodirector.com/getting-started-with-mongodb-and-mongoose/" onclick="__gaTracker('send', 'event', 'outbound-widget', 'http://blog.mongodirector.com/getting-started-with-mongodb-and-mongoose/', 'Getting started with MongoDB and Mongoose');" target="_blank">Getting started with MongoDB and Mongoose</a></li>

<li><a href="http://blog.mongodirector.com/yeoman-mongoose-and-mongodb/" onclick="__gaTracker('send', 'event', 'outbound-widget', 'http://blog.mongodirector.com/yeoman-mongoose-and-mongodb/', 'Yeoman, Mongoose and MongoDB');" target="_blank">Yeoman, Mongoose and MongoDB</a></li>

</ul></div>
		</aside><aside id="views-2" class="widget widget_views"><h1 class="widget-title">Top5 Posts</h1><ul>
<li><a href="./../../architecting-a-restful-node-js-app/index.html"  title="Architecting a Secure RESTful Node.js app">Architecting a Secure RESTful Node.js app</a> - 215,351 views</li><li><a href="./../../getting-started-with-angular-2-0/index.html"  title="Getting Started with Angular 2.0">Getting Started with Angular 2.0</a> - 177,584 views</li><li><a href="./../../developing-a-mean-app-with-angular-2-0/index.html"  title="Developing a MEAN app with Angular 2.0">Developing a MEAN app with Angular 2.0</a> - 149,722 views</li><li><a href="./../../getting-started-with-node-webkit-apps/index.html"  title="Node Webkit &ndash; Build Desktop Apps with Node and Web Technologies">Node Webkit &ndash; Build Desktop Apps with Node and Web Technologies</a> - 93,573 views</li><li><a href="./../../rpi-live-streaming/index.html"  title="Raspberry Pi, Camera and Node.js &ndash; Live Streaming with Websockets #IoT">Raspberry Pi, Camera and Node.js &ndash; Live Streaming with Websockets #IoT</a> - 91,999 views</li></ul>
</aside>		<aside id="recent-posts-2" class="widget widget_recent_entries">		<h1 class="widget-title">Recent Posts</h1>		<ul>
					<li>
				<a href="./../../learning-ionic/index.html">Learning Ionic</a>
						</li>
					<li>
				<a href="./../../electron-wordpress-angular-material-an-offline-viewer/index.html">Electron, WordPress &#038; Angular Material &#8211; An Offline Viewer</a>
						</li>
					<li>
				<a href="./../../developing-a-mean-app-with-angular-2-0/index.html">Developing a MEAN app with Angular 2.0</a>
						</li>
					<li>
				<a href="./../../pushbots-and-cordova/index.html">Pushbots and Cordova &#8211; Easy Push Notifications for your app</a>
						</li>
					<li>
				<a href="./../../getting-started-with-client-side-storage/index.html">Getting Started with Client Side Storage</a>
						</li>
				</ul>
		</aside><aside id="categories-2" class="widget widget_categories"><h1 class="widget-title">Categories</h1>		<ul>
	<li class="cat-item cat-item-141"><a href="./../../architecture/index.html" >Architecture</a> (8)
</li>
	<li class="cat-item cat-item-3"><a href="./../../css/index.html" >CSS</a> (9)
<ul class='children'>
	<li class="cat-item cat-item-5"><a href="./../../css/css3/index.html" >CSS3</a> (6)
</li>
	<li class="cat-item cat-item-26"><a href="./../../css/less/index.html" >LESS</a> (3)
</li>
	<li class="cat-item cat-item-55"><a href="./../../css/sass/index.html" >SASS</a> (1)
</li>
</ul>
</li>
	<li class="cat-item cat-item-117"><a href="./../../database/index.html" >Database</a> (17)
<ul class='children'>
	<li class="cat-item cat-item-136"><a href="./../../database/disk-db/index.html" >Disk DB</a> (6)
</li>
	<li class="cat-item cat-item-131"><a href="./../../database/firebase/index.html" >Firebase</a> (4)
</li>
	<li class="cat-item cat-item-118"><a href="./../../database/mongodb/index.html" >MongoDB</a> (8)
	<ul class='children'>
	<li class="cat-item cat-item-119"><a href="./../../database/mongodb/mongolab/index.html" >MongoLab</a> (3)
</li>
	<li class="cat-item cat-item-123"><a href="./../../database/mongodb/monk/index.html" >Monk</a> (1)
</li>
	</ul>
</li>
</ul>
</li>
	<li class="cat-item cat-item-125"><a href="./../../deployments/index.html" >Deployments</a> (4)
<ul class='children'>
	<li class="cat-item cat-item-126"><a href="./../../deployments/heroku/index.html" >Heroku</a> (2)
</li>
</ul>
</li>
	<li class="cat-item cat-item-135"><a href="./../../desktop-apps/index.html" >Desktop Apps</a> (8)
</li>
	<li class="cat-item cat-item-155"><a href="./../../dna-analysis/index.html" >DNA Analysis</a> (1)
</li>
	<li class="cat-item cat-item-112"><a href="./../../es6/index.html" >ECMAScript 6</a> (3)
</li>
	<li class="cat-item cat-item-162"><a href="./../../electron-atom-shell/index.html" >Electron (atom shell)</a> (1)
</li>
	<li class="cat-item cat-item-25"><a href="./../../frameworks/index.html" >Frameworks</a> (42)
<ul class='children'>
	<li class="cat-item cat-item-160"><a href="./../../frameworks/angular-2-0/index.html" >Angular 2.0</a> (2)
</li>
	<li class="cat-item cat-item-108"><a href="./../../frameworks/angularjs/index.html" >Angularjs</a> (21)
</li>
	<li class="cat-item cat-item-132"><a href="./../../frameworks/backbonejs/index.html" >Backbonejs</a> (1)
</li>
	<li class="cat-item cat-item-105"><a href="./../../frameworks/bootstrap/index.html" >Bootstrap</a> (9)
</li>
	<li class="cat-item cat-item-159"><a href="./../../frameworks/emberjs/index.html" >Emberjs</a> (1)
</li>
	<li class="cat-item cat-item-56"><a href="./../../frameworks/foundation/index.html" >Foundation</a> (3)
</li>
	<li class="cat-item cat-item-110"><a href="./../../frameworks/framework7/index.html" >Framework7</a> (1)
</li>
	<li class="cat-item cat-item-107"><a href="./../../frameworks/ionic/index.html" >Ionic</a> (11)
</li>
	<li class="cat-item cat-item-157"><a href="./../../frameworks/lumx/index.html" >Lumx</a> (1)
</li>
	<li class="cat-item cat-item-138"><a href="./../../frameworks/mean/index.html" >MEAN</a> (4)
</li>
	<li class="cat-item cat-item-116"><a href="./../../frameworks/meteorjs/index.html" >Meteorjs</a> (1)
</li>
	<li class="cat-item cat-item-122"><a href="./../../frameworks/onsen-ui/index.html" >Onsen UI</a> (2)
</li>
</ul>
</li>
	<li class="cat-item cat-item-101"><a href="./../../git/index.html" >Git</a> (12)
<ul class='children'>
	<li class="cat-item cat-item-102"><a href="./../../git/github/index.html" >GitHub</a> (10)
</li>
</ul>
</li>
	<li class="cat-item cat-item-2"><a href="./../../html/index.html" >HTML</a> (22)
<ul class='children'>
	<li class="cat-item cat-item-4"><a href="./../../html/html5/index.html" >HTML5</a> (21)
	<ul class='children'>
	<li class="cat-item cat-item-158"><a href="./../../html/html5/webrtc/index.html" >WebRTC</a> (1)
</li>
	<li class="cat-item cat-item-106"><a href="./../../html/html5/websockets/index.html" >WebSockets</a> (6)
</li>
	</ul>
</li>
</ul>
</li>
	<li class="cat-item cat-item-137"><a href="./../../intels-app-ui/index.html" >Intel&#039;s App UI</a> (1)
</li>
	<li class="cat-item cat-item-143"><a href="./../../iot/index.html" >IoT</a> (6)
</li>
	<li class="cat-item cat-item-1"><a href="./../../javascript/index.html" >Javascript</a> (75)
<ul class='children'>
	<li class="cat-item cat-item-6"><a href="./../../javascript/jquery/index.html" >jQuery</a> (14)
</li>
</ul>
</li>
	<li class="cat-item cat-item-151"><a href="./../../material-design/index.html" >Material Design</a> (3)
</li>
	<li class="cat-item cat-item-99"><a href="./../../mobile/index.html" >Mobile</a> (21)
<ul class='children'>
	<li class="cat-item cat-item-103"><a href="./../../mobile/android/index.html" >Android</a> (15)
</li>
	<li class="cat-item cat-item-113"><a href="./../../mobile/firefox-os/index.html" >Firefox OS</a> (2)
</li>
	<li class="cat-item cat-item-104"><a href="./../../mobile/ios/index.html" >iOS</a> (11)
</li>
	<li class="cat-item cat-item-100"><a href="./../../mobile/phonegap/index.html" >PhoneGap</a> (16)
</li>
</ul>
</li>
	<li class="cat-item cat-item-149"><a href="./../../mqtt/index.html" >MQTT</a> (1)
</li>
	<li class="cat-item cat-item-163"><a href="./../../my-books/index.html" >My Books</a> (1)
</li>
	<li class="cat-item cat-item-45"><a href="./../../node/index.html" >Node</a> (60)
<ul class='children'>
	<li class="cat-item cat-item-152"><a href="./../../node/cli/index.html" >CLI</a> (3)
</li>
	<li class="cat-item cat-item-121"><a href="./../../node/expressjs/index.html" >Expressjs</a> (18)
</li>
	<li class="cat-item cat-item-156"><a href="./../../node/genome/index.html" >Genome</a> (1)
</li>
	<li class="cat-item cat-item-62"><a href="./../../node/grunt/index.html" >Grunt</a> (8)
</li>
	<li class="cat-item cat-item-124"><a href="./../../node/koa/index.html" >Koa</a> (1)
</li>
	<li class="cat-item cat-item-134"><a href="./../../node/node-webkit/index.html" >Node Webkit</a> (7)
</li>
	<li class="cat-item cat-item-54"><a href="./../../node/npm/index.html" >NPM</a> (15)
</li>
	<li class="cat-item cat-item-120"><a href="./../../node/restify/index.html" >Restify</a> (3)
</li>
</ul>
</li>
	<li class="cat-item cat-item-161"><a href="./../../push-notifications/index.html" >Push Notifications</a> (1)
</li>
	<li class="cat-item cat-item-59"><a href="./../../quick-and-dirty/index.html" >Quick and Dirty</a> (42)
</li>
	<li class="cat-item cat-item-142"><a href="./../../raspberry-pi/index.html" >Raspberry Pi</a> (9)
</li>
	<li class="cat-item cat-item-60"><a href="./../../setup/index.html" >Setup</a> (60)
</li>
	<li class="cat-item cat-item-61"><a href="./../../testing/index.html" >Testing</a> (5)
<ul class='children'>
	<li class="cat-item cat-item-129"><a href="./../../testing/jasmine/index.html" >Jasmine</a> (1)
</li>
	<li class="cat-item cat-item-128"><a href="./../../testing/protractor/index.html" >Protractor</a> (1)
</li>
	<li class="cat-item cat-item-98"><a href="./../../testing/test-automation/index.html" >Test Automation</a> (1)
</li>
	<li class="cat-item cat-item-41"><a href="./../../testing/tdd/index.html" >Test Driven Developement</a> (2)
</li>
</ul>
</li>
	<li class="cat-item cat-item-139"><a href="./../../third-party-products/index.html" >Third Party Products</a> (4)
<ul class='children'>
	<li class="cat-item cat-item-140"><a href="./../../third-party-products/twilio/index.html" >Twilio</a> (4)
</li>
</ul>
</li>
	<li class="cat-item cat-item-58"><a href="./../../tutorial/index.html" >Tutorial</a> (79)
</li>
	<li class="cat-item cat-item-130"><a href="./../../performance-analysis/index.html" >UI Performance</a> (1)
</li>
	<li class="cat-item cat-item-109"><a href="./../../web-components/index.html" >Web Components</a> (3)
</li>
	<li class="cat-item cat-item-133"><a href="./../../google-web-starter-kit/index.html" >Web Starter Kit</a> (1)
</li>
		</ul>
</aside><aside id="archives-2" class="widget widget_archive"><h1 class="widget-title">Archives</h1>		<ul>
	<li><a href='./../../2015/07/index.html'>July 2015</a></li>
	<li><a href='./../../2015/05/index.html'>May 2015</a></li>
	<li><a href='./../../2015/04/index.html'>April 2015</a></li>
	<li><a href='./../../2015/03/index.html'>March 2015</a></li>
	<li><a href='./../../2015/02/index.html'>February 2015</a></li>
	<li><a href='./../../2015/01/index.html'>January 2015</a></li>
	<li><a href='./../../2014/12/index.html'>December 2014</a></li>
	<li><a href='./../../2014/11/index.html'>November 2014</a></li>
	<li><a href='./../../2014/10/index.html'>October 2014</a></li>
	<li><a href='./../../2014/09/index.html'>September 2014</a></li>
	<li><a href='./../../2014/08/index.html'>August 2014</a></li>
	<li><a href='./../../2014/07/index.html'>July 2014</a></li>
	<li><a href='./../../2014/06/index.html'>June 2014</a></li>
	<li><a href='./../../2014/05/index.html'>May 2014</a></li>
	<li><a href='./../../2014/04/index.html'>April 2014</a></li>
	<li><a href='./../../2014/03/index.html'>March 2014</a></li>
	<li><a href='./../../2014/02/index.html'>February 2014</a></li>
		</ul>
</aside><aside id="wysija-3" class="widget widget_wysija"><h1 class="widget-title">Inform me about new posts</h1><div class="widget_wysija_cont"><div id="msg-form-wysija-3" class="wysija-msg ajax"></div><form id="form-wysija-3" method="post" action="#wysija" class="widget_wysija">
<p class="wysija-paragraph">
    <label>Email <span class="wysija-required">*</span></label>
    
    	<input type="text" name="wysija[user][email]" class="wysija-input validate[required,custom[email]]" title="Email"  value="" />
    
    
    
    <span class="abs-req">
        <input type="text" name="wysija[user][abs][email]" class="wysija-input validated[abs][email]" value="" />
    </span>
    
</p>
<input class="wysija-submit wysija-submit-field" type="submit" value="Subscribe!" />

    <input type="hidden" name="form_id" value="1" />
    <input type="hidden" name="action" value="save" />
    <input type="hidden" name="controller" value="subscribers" />
    <input type="hidden" value="1" name="wysija-page" />

    
        <input type="hidden" name="wysija[user_list][list_ids]" value="3" />
    
 </form></div></aside>	</div><!-- #secondary -->
<!--WPFC_FOOTER_START-->	<script>
var _prum = [['id', '544090ababe53d0e3e76d6ce'],
             ['mark', 'firstbyte', (new Date()).getTime()]];
(function() {
    var s = document.getElementsByTagName('script')[0]
      , p = document.createElement('script');
    p.async = 'async';
    p.src = '//rum-static.pingdom.net/prum.min.js';
    s.parentNode.insertBefore(p, s);
})();
</script>
	</div><!-- #content -->
		<footer id="colophon" class="site-footer" role="contentinfo">
		<div class="site-info">
						All Rights Reserved
			<span class="sep"> | </span>
			The Jackal of Javascript
		</div><!-- .site-info -->
		<div class="rnd-circle" style="    background: black;    width: 10px;    height: 10px;    border-radius: 50%;"></div>
	</footer><!-- #colophon -->
</div><!-- #page -->

				<script type='text/javascript'><!--
			var seriesdropdown = document.getElementById("orgseries_dropdown");
			if (seriesdropdown) {
			 function onSeriesChange() {
					if ( seriesdropdown.options[seriesdropdown.selectedIndex].value != ( 0 || -1 ) ) {
						location.href = "./series/"+seriesdropdown.options[seriesdropdown.selectedIndex].value;
					}
				}
				seriesdropdown.onchange = onSeriesChange;
			}
			--></script>
			        <script type="text/javascript">
        // <![CDATA[
        var disqus_shortname = 'thejackalofjavascriptcom';
        (function () {
            var nodes = document.getElementsByTagName('span');
            for (var i = 0, url; i < nodes.length; i++) {
                if (nodes[i].className.indexOf('dsq-postid') != -1) {
                    nodes[i].parentNode.setAttribute('data-disqus-identifier', nodes[i].getAttribute('data-dsqidentifier'));
                    url = nodes[i].parentNode.href.split('#', 1);
                    if (url.length == 1) { url = url[0]; }
                    else { url = url[1]; }
                    nodes[i].parentNode.href = url + '#disqus_thread';
                }
            }
            var s = document.createElement('script'); 
            s.async = true;
            s.type = 'text/javascript';
            s.src = '//' + disqus_shortname + '.disqus.com/count.js';
            (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
        }());
        // ]]>
        </script>
        <div class="scroll-back-to-top-wrapper">
	<span class="scroll-back-to-top-inner">
					<i class="fa fa-2x fa-arrow-circle-up"></i>
			</span>
</div>
<style type="text/css">
    #wpfront-notification-bar 
    {
        background: #242d36;
        background: -moz-linear-gradient(top, #242d36 0%, #242d36 100%);
        background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,#242d36), color-stop(100%,#242d36));
        background: -webkit-linear-gradient(top, #242d36 0%,#242d36 100%);
        background: -o-linear-gradient(top, #242d36 0%,#242d36 100%);
        background: -ms-linear-gradient(top, #242d36 0%,#242d36 100%);
        background: linear-gradient(to bottom, #242d36 0%, #242d36 100%);
        filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#242d36', endColorstr='#242d36',GradientType=0 );
    }

    #wpfront-notification-bar div.wpfront-message
    {
        color: #ffffff;
    }

    #wpfront-notification-bar a.wpfront-button
    {
        background: #f45145;
        background: -moz-linear-gradient(top, #f45145 0%, #f45145 100%);
        background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,#f45145), color-stop(100%,#f45145));
        background: -webkit-linear-gradient(top, #f45145 0%,#f45145 100%);
        background: -o-linear-gradient(top, #f45145 0%,#f45145 100%);
        background: -ms-linear-gradient(top, #f45145 0%,#f45145 100%);
        background: linear-gradient(to bottom, #f45145 0%, #f45145 100%);
        filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#f45145', endColorstr='#f45145',GradientType=0 );

        color: #ffffff;
    }

    #wpfront-notification-bar-open-button
    {
        background-color: #00b7ea;
    }

    #wpfront-notification-bar  div.wpfront-close 
    {
        border: 1px solid #555555;
        background-color: #555555;
        color: #000000;
    }

    #wpfront-notification-bar  div.wpfront-close:hover 
    {
        border: 1px solid #aaaaaa;
        background-color: #aaaaaa;
    }
</style>


<div id="wpfront-notification-bar-spacer"  style="display: none;">
    <div id="wpfront-notification-bar-open-button" class="top wpfront-bottom-shadow"></div>
    <div id="wpfront-notification-bar" class="wpfront-fixed">
                    <div class="wpfront-close">X</div>
                <table border="0" cellspacing="0" cellpadding="0">
            <tr>
                <td>
                    <div class="wpfront-message">
                        Learn your way around Ionic framework. Check out Learning Ionic!                     </div>
                    <div>
                                                                                    <a class="wpfront-button" href="https://www.packtpub.com/application-development/learning-ionic/?utm_source=Jkthejackalofjavascript&utm_medium=referral&utm_campaign=1783552603"  target="_blank" >Buy</a>
                                                                                                    </div>
                </td>
            </tr>
        </table>
    </div>
</div>


<style type="text/css">
.wpfront-message{line-height:27px; vertical-align:baseline !important;}</style>
<script type="text/javascript">if(typeof wpfront_notification_bar == "function") wpfront_notification_bar({"position":1,"height":0,"fixed_position":"on","animate_delay":0.5,"close_button":true,"button_action_close_bar":false,"auto_close_after":0,"display_after":1,"is_admin_bar_showing":false,"display_open_button":false,"keep_closed":"on","keep_closed_for":1,"position_offset":0,"display_scroll":"on","display_scroll_offset":100});</script><script type='text/javascript' src='./../../wp-content/plugins/jetpack/modules/photon/photon.js'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var scrollBackToTop = {"scrollDuration":"500","fadeDuration":"0.5"};
/* ]]> */
</script>
<script type='text/javascript' src='./../../wp-content/plugins/scroll-back-to-top/assets/js/scroll-back-to-top.js'></script>
<script type='text/javascript' src='./../../wp-content/plugins/simple-share-buttons-adder/js/ssba.min.js'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var viewsCacheL10n = {"admin_ajax_url":".\/wp-admin\/admin-ajax.php","post_id":"2567"};
/* ]]> */
</script>
<script type='text/javascript' src='./../../wp-content/plugins/wp-postviews/postviews-cache.js'></script>
<script type='text/javascript' src='http://s0.wp.com/wp-content/js/devicepx-jetpack.js'></script>
<script type='text/javascript' src='./../../wp-content/themes/sorbet/js/menus.js'></script>
<script type='text/javascript' src='./../../wp-content/themes/sorbet/js/skip-link-focus-fix.js'></script>
<script type='text/javascript' src='./../../wp-includes/js/comment-reply.min.js'></script>
<script type='text/javascript' src='./../../wp-content/plugins/lazy-load/js/jquery.sonar.min.js'></script>
<script type='text/javascript' src='./../../wp-content/plugins/lazy-load/js/lazy-load.js'></script>
<script type='text/javascript' src='./../../wp-content/plugins/jetpack/_inc/postmessage.js'></script>
<script type='text/javascript' src='./../../wp-content/plugins/jetpack/_inc/jquery.jetpack-resize.js'></script>
<script type='text/javascript' src='./../../wp-content/plugins/jetpack/_inc/jquery.inview.js'></script>
<script type='text/javascript' src='./../../wp-content/plugins/jetpack/modules/likes/queuehandler.js'></script>
<script type='text/javascript' src='./../../wp-content/plugins/wysija-newsletters/js/validate/languages/jquery.validationEngine-en.js'></script>
<script type='text/javascript' src='./../../wp-content/plugins/wysija-newsletters/js/validate/jquery.validationEngine.js'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wysijaAJAX = {"action":"wysija_ajax","controller":"subscribers","ajaxurl":".\/wp-admin\/admin-ajax.php","loadingTrans":"Loading...","is_rtl":""};
var wysijaAJAX = {"action":"wysija_ajax","controller":"subscribers","ajaxurl":".\/wp-admin\/admin-ajax.php","loadingTrans":"Loading...","is_rtl":""};
/* ]]> */
</script>
<script type='text/javascript' src='./../../wp-content/plugins/wysija-newsletters/js/front-subscribers.js'></script>
		<iframe src='http://widgets.wp.com/likes/master.html?ver=20141028#ver=20141028' scrolling='no' id='likes-master' name='likes-master' style='display:none;'></iframe>
		<div id='likes-other-gravatars'><div class="likes-text"><span>%d</span> bloggers like this:</div><ul class="wpl-avatars sd-like-gravatars"></ul></div>
					<script type="text/javascript">
				jQuery.noConflict();
				(function( $ ) {
					$(function() {
						// More code using $ as alias to jQuery
						$("area[href*=#],a[href*=#]:not([href=#]):not([href^='#tab']):not([href^='#quicktab']):not([href^='#pane'])").click(function() {
							if (location.pathname.replace(/^\//,'') == this.pathname.replace(/^\//,'') && location.hostname == this.hostname) {
								var target = $(this.hash);
								target = target.length ? target : $('[name=' + this.hash.slice(1) +']');
								if (target.length) {
								$('html,body').animate({
								scrollTop: target.offset().top - 20  
								},900 ,'easeOutQuint');
								return false;
								}
							}
						});
					});
				})(jQuery);	
			</script>				
				<script type='text/javascript' src='http://stats.wp.com/e-201746.js' async defer></script>
<script type='text/javascript'>
	_stq = window._stq || [];
	_stq.push([ 'view', {v:'ext',j:'1:3.7',blog:'70838519',post:'2567',tz:'5.5',srv:'thejackalofjavascript.com'} ]);
	_stq.push([ 'clickTrackerInit', '70838519', '2567' ]);
</script>
<div id="upprev_box"><h6>Read previous post:</h6><div class="upprev_excerpt"><h5><a href="./../../text-based-adventure-games/index.html" rel="Re-Architecting a Firebase app to work with Node.js and MongoDB">Text Based Adventure Games with Node.js</a></h5><p>Coming from a fraternity of GTA and Age of Empires, text based games were a new twist to my gaming world. I...</p></div><a id="upprev_close" href="#" rel="close">Close</a></div><script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-47881846-1', 'auto');
  ga('send', 'pageview');

</script>

<a style="display:none;" href="http://www.alexa.com/siteinfo/./"><script type="text/javascript" src="http://xslt.alexa.com/site_stats/js/t/a?url=./"></script></a>
</body>
</html><script>if(document.getElementById('to-contents') == null){ } else {var a = document.getElementById('to-contents').getElementsByTagName('a'); for(var i=0; i< a.length;i++){var b = a[i].getAttribute('href').split('#');if(b.length >=2)a[i].setAttribute('href', '#'+b[1]);}}</script>
<script>if(typeof jQuery == 'function'){jQuery('.widgetGuts.shortcode h3').html('Inform Me About New Posts')}</script><!-- need to refresh to see cached version -->